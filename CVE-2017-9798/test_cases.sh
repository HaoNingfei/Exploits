#!/bin/sh

perl -e 'use 5.10.0; no warnings "experimental"; my @cases = ("GET POST OPTIONS", "GET,POST,OPTIONS",""," ,GET,,,POST,OPTIONS,HEAD,,","POST,OPTIONS,,HEAD,:09:44 GMT","GET,HEAD,OPTIONS,,HEAD,,HEAD,,HEAD,,HEAD,,HEAD,,HEAD,,HEAD,POST,,HEAD,, HEAD,!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\""); print "\n\n[TEST CASE] $case\n"; foreach my $case (@cases) { given($case) { when(/^[a-zA-Z\-]*\s?,\s?[a-zA-Z\-]+[\s,]*([,]*\s?[a-zA-Z\-]*\s?(?:,\s?[a-zA-Z\-]+[\s,]*)?)+$/) { print "[OK] [SEPARATOR] Commas => $case\n"; } when(/^([a-zA-Z\-]+\s?(?:\s[\s]*[a-zA-Z\-]+))+$/) { print "[OK] [SEPARATOR] Spaces => $case\n"; } default { if($case) { print "OptionsBleed Vulnerable => $case\n"; } else { print "Empty Header ...\n"; } } }  }'

