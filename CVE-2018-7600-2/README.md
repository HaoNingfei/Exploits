### Drupal < 8.3.9 / < 8.4.6 / < 8.5.1 - 'Drupalgeddon2' Remote Code Execution (Metasploit)


#### Cvss:
CVSS 7.5

#### Cwe:
CWE-20

#### Author:
José Ignacio Rojo

#### Sa-core:
2018-002-95

#### Date:
2018-04-17

#### Description:

Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x
before 8.5.1 allows remote attackers to execute arbitrary code because
of an issue affecting multiple subsystems with default or common module
configurations.


#### Exploitdb:
44482

#### Cve:
CVE-2018-7600

#### Affected Versions :
- 8.3.9
- 8.4.6
- 8.5.1
- 7.58


#### References :
- [https://www.exploit-db.com/search/?action=search&cve=2018-7600](https://www.exploit-db.com/search/?action=search&cve=2018-7600)
- [https://nvd.nist.gov/vuln/detail/CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)
- [https://www.cvedetails.com/cve/CVE-2018-7600/](https://www.cvedetails.com/cve/CVE-2018-7600/)
- [https://www.synology.com/support/security/Synology_SA_18_17](https://www.synology.com/support/security/Synology_SA_18_17)
- [http://www.securitytracker.com/id/1040598](http://www.securitytracker.com/id/1040598)
- [https://www.tenable.com/blog/critical-drupal-core-vulnerability-what-you-need-to-know](https://www.tenable.com/blog/critical-drupal-core-vulnerability-what-you-need-to-know)
- [https://greysec.net/showthread.php?tid=2912&amp;pid=10561](https://greysec.net/showthread.php?tid=2912&amp;pid=10561)
- [https://groups.drupal.org/security/faq-2018-002](https://groups.drupal.org/security/faq-2018-002)
- [https://lists.debian.org/debian-lts-announce/2018/03/msg00028.html](https://lists.debian.org/debian-lts-announce/2018/03/msg00028.html)
- [https://research.checkpoint.com/uncovering-drupalgeddon-2/](https://research.checkpoint.com/uncovering-drupalgeddon-2/)
- [https://www.exploit-db.com/exploits/44449/](https://www.exploit-db.com/exploits/44449/)
- [https://www.exploit-db.com/exploits/44482/](https://www.exploit-db.com/exploits/44482/)
- [https://github.com/g0rx/CVE-2018-7600-Drupal-RCE](https://github.com/g0rx/CVE-2018-7600-Drupal-RCE)
- [https://blog.appsecco.com/remote-code-execution-with-drupal-core-sa-core-2018-002-95e6ecc0c714](https://blog.appsecco.com/remote-code-execution-with-drupal-core-sa-core-2018-002-95e6ecc0c714)
- [https://www.drupal.org/sa-core-2018-002](https://www.drupal.org/sa-core-2018-002)
- [https://www.debian.org/security/2018/dsa-4156](https://www.debian.org/security/2018/dsa-4156)
- [http://www.securityfocus.com/bid/103534](http://www.securityfocus.com/bid/103534)
- [https://github.com/a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)
- [https://twitter.com/RicterZ/status/979567469726613504](https://twitter.com/RicterZ/status/979567469726613504)
- [https://twitter.com/RicterZ/status/984495201354854401](https://twitter.com/RicterZ/status/984495201354854401)
- [https://twitter.com/arancaytar/status/979090719003627521](https://twitter.com/arancaytar/status/979090719003627521)
- [https://www.exploit-db.com/exploits/44448/](https://www.exploit-db.com/exploits/44448/)
- [https://badpackets.net/over-100000-drupal-websites-vulnerable-to-drupalgeddon-2-cve-2018-7600/](https://badpackets.net/over-100000-drupal-websites-vulnerable-to-drupalgeddon-2-cve-2018-7600/)
- [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7600](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7600)
- [http://cve.scap.org.cn/CVE-2018-7600.html](http://cve.scap.org.cn/CVE-2018-7600.html)
- [https://exploit-db.com/exploits/44448/](https://exploit-db.com/exploits/44448/)
- [https://exploit-db.com/raw/44448/](https://exploit-db.com/raw/44448/)
- [https://exploit-db.com/exploits/44449/](https://exploit-db.com/exploits/44449/)
- [https://exploit-db.com/raw/44449/](https://exploit-db.com/raw/44449/)
- [https://exploit-db.com/exploits/44482/](https://exploit-db.com/exploits/44482/)
- [https://exploit-db.com/raw/44482/](https://exploit-db.com/raw/44482/)


### PoC/Reproducer Script

  #### Arguments

    - **user-agent**
      User-Agent To Send To Server


    - **debug**
      Debug Mode


    - **auth**
      Credentials To Use For HTTP Login [Format: username:password]


    - **proxy**
      Proxy Server To Use [Format: scheme://host:port]


    - **url**
      The Target URL [Format: scheme://host]


    - **command**
      The command to execute .


    - **verbose**
      Be More Verbose


    - **help**
      Display The Help Menu


    - **timeout**
      Max Timeout For The HTTP Requests


    - **cookie**
      Cookie String To Use


  #### Arguments Resume

  ```

            --url [VALUE]	: The Target URL [Format: scheme://host]
            --user-agent [VALUE]	: User-Agent To Send To Server
            --cookie [VALUE]	: Cookie String To Use
            --proxy [VALUE]	: Proxy Server To Use [Format: scheme://host:port]
            --timeout [VALUE]	: Max Timeout For The HTTP Requests
            --auth [VALUE]	: Credentials To Use For HTTP Login [Format: username:password]
            --help               : Display The Help Menu
            --verbose               : Be More Verbose
            --debug               : Debug Mode
            --command [VALUE]	: The command to execute .
    ```
