{
   "msf_module" : "uptime_file_upload_2",
   "references" : [
      "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2015-5254.php"
   ],
   "the usertitle to authenticate as" : "sample",
   "name" : "UptimeFileUpload_2",
   "paths" : [
      ":\\\\windows\\\\system32\\\\cmd.exe"
   ],
   "label_[184]" : "Script Name",
   "requests" : {
      "EXPLOIT1" : {
         "PATH" : "index.php",
         "METHOD" : "POST",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "username=__USERNAME__&password=__PASSWORD__",
         "TEXT" : "Sending Exploit #1 Request : [POST] /index.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "title_[output]" : 187,
   "description" : "\n\n        This module exploits a vulnerability found in Uptime version 7.4.0 and 7.5.0.\n\n\n\n        The vulnerability began as a classic arbitrary file upload vulnerability in post2file.php,\n\n        which can be exploited by exploits/multi/http/uptime_file_upload_1.rb, but it was mitigated\n\n        by the vendor.\n\n\n\n        Although the mitigation in place will prevent uptime_file_upload_1.rb from working, it\n\n        can still be bypassed and gain privilege escalation, and allows the attacker to upload file\n\n        again, and execute arbitrary commands.\n\n      ",
   "disableeditofusertitlerolegroup" : "false",
   "platform" : "MULTI",
   "title" : "Exploit",
   "variables" : {
      "UPTIMEWINDOWSDIRECTORY" : {
         "DESCRIPTION" : "Uptime installation path for Windows",
         "VALUE" : "C:\\\\Program Files\\\\uptime software\\\\"
      },
      "PASSWORD" : {
         "DESCRIPTION" : "The password to authenticate with",
         "VALUE" : "sample"
      },
      "UPTIMELINUXDIRECTORY" : {
         "VALUE" : "/usr/local/uptime/",
         "DESCRIPTION" : "Uptime installation path for Linux"
      },
      "PATH" : {
         "VALUE" : "c:\\\\windows\\\\system32\\\\cmd.exe",
         "DESCRIPTION" : "Path to cmd.exe"
      }
   },
   "informations" : {
      "REFERENCES" : [
         "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2015-5254.php"
      ],
      "LABEL_[184]" : "Script Name",
      "TYPE" : "MSF",
      "THE USERTITLE TO AUTHENTICATE AS" : "sample",
      "VARIABLES" : {
         "UPTIMELINUXDIRECTORY" : {
            "VALUE" : "/usr/local/uptime/",
            "DESCRIPTION" : "Uptime installation path for Linux"
         },
         "PASSWORD" : {
            "DESCRIPTION" : "The password to authenticate with",
            "VALUE" : "sample"
         },
         "PATH" : {
            "VALUE" : "c:\\\\windows\\\\system32\\\\cmd.exe",
            "DESCRIPTION" : "Path to cmd.exe"
         },
         "UPTIMEWINDOWSDIRECTORY" : {
            "DESCRIPTION" : "Uptime installation path for Windows",
            "VALUE" : "C:\\\\Program Files\\\\uptime software\\\\"
         }
      },
      "TITLE_[PROCESS]" : 184,
      "DESCRIPTION" : "\n\n        This module exploits a vulnerability found in Uptime version 7.4.0 and 7.5.0.\n\n\n\n        The vulnerability began as a classic arbitrary file upload vulnerability in post2file.php,\n\n        which can be exploited by exploits/multi/http/uptime_file_upload_1.rb, but it was mitigated\n\n        by the vendor.\n\n\n\n        Although the mitigation in place will prevent uptime_file_upload_1.rb from working, it\n\n        can still be bypassed and gain privilege escalation, and allows the attacker to upload file\n\n        again, and execute arbitrary commands.\n\n      ",
      "ERDCTITLE" : "Exploit",
      "TITLE_[OUTPUT]" : 187,
      "PATHS" : [
         ":\\\\windows\\\\system32\\\\cmd.exe"
      ],
      "TITLE_[ARGS]" : 185,
      "PLATFORM" : "MULTI",
      "TITLE_[TIMER]" : 189,
      "DISABLEEDITOFUSERTITLEROLEGROUP" : "false",
      "MSF_MODULE" : "uptime_file_upload_2",
      "TITLE" : "Exploit",
      "name" : "UptimeFileUpload_2",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "index.php",
            "METHOD" : "POST",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "username=__USERNAME__&password=__PASSWORD__",
            "TEXT" : "Sending Exploit #1 Request : [POST] /index.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      }
   },
   "detection" : {},
   "title_[timer]" : 189,
   "title_[args]" : 185,
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "erdctitle" : "Exploit",
   "type" : "MSF",
   "title_[process]" : 184
}
