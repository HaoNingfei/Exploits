{
   "platform" : "ALL",
   "method" : "POST",
   "type" : "MSF",
   "description" : "\n\n        A vulnerability existed in the PowerShellEmpire server prior to commit\n\n        f030cf62 which would allow an arbitrary file to be written to an\n\n        attacker controlled location with the permissions of the Empire server.\n\n\n\n        This exploit will write the payload to /tmp/ directory followed by a\n\n        cron.d file to execute the payload.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "variables" : {
      "PROFILE" : {
         "DESCRIPTION" : "Empire agent traffic profile URI.",
         "VALUE" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "Base URI path",
         "VALUE" : "/"
      },
      "STAGE1_URI" : {
         "DESCRIPTION" : "The resource used by the RSA key post, default is index.jsp",
         "VALUE" : "index.jsp"
      },
      "SESSION_ID" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "STAGE0_URI" : {
         "VALUE" : "index.asp",
         "DESCRIPTION" : "The resource requested by the initial launcher, default is index.asp"
      }
   },
   "title" : "PowerShellEmpire Arbitrary File Upload (Skywalker)",
   "name" : "EmpireSkywalker",
   "references" : [
      "http://www.harmj0y.net/blog/empire/empire-fails/"
   ],
   "msf_module" : "empire_skywalker",
   "requests" : {
      "EXPLOIT1" : {
         "PATH" : "",
         "METHOD" : "GET",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "detection" : {},
   "informations" : {
      "METHOD" : "POST",
      "PLATFORM" : "ALL",
      "TYPE" : "MSF",
      "PATHS" : [
         ""
      ],
      "REFERENCES" : [
         "http://www.harmj0y.net/blog/empire/empire-fails/"
      ],
      "MSF_MODULE" : "empire_skywalker",
      "VARIABLES" : {
         "STAGE0_URI" : {
            "VALUE" : "index.asp",
            "DESCRIPTION" : "The resource requested by the initial launcher, default is index.asp"
         },
         "SESSION_ID" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "STAGE1_URI" : {
            "DESCRIPTION" : "The resource used by the RSA key post, default is index.jsp",
            "VALUE" : "index.jsp"
         },
         "PROFILE" : {
            "DESCRIPTION" : "Empire agent traffic profile URI.",
            "VALUE" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "Base URI path",
            "VALUE" : "/"
         }
      },
      "DESCRIPTION" : "\n\n        A vulnerability existed in the PowerShellEmpire server prior to commit\n\n        f030cf62 which would allow an arbitrary file to be written to an\n\n        attacker controlled location with the permissions of the Empire server.\n\n\n\n        This exploit will write the payload to /tmp/ directory followed by a\n\n        cron.d file to execute the payload.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "",
            "METHOD" : "GET",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "name" : "EmpireSkywalker",
      "TITLE" : "PowerShellEmpire Arbitrary File Upload (Skywalker)"
   },
   "paths" : [
      ""
   ]
}
