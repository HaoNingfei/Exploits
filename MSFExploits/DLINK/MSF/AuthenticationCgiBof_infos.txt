my $EXPLOIT = {
  DESCRIPTION => "

        This module exploits a remote buffer overflow vulnerability on several D-Link routers.

        The vulnerability exists in the handling of HTTP queries to the authentication.cgi with

        long password values. The vulnerability can be exploitable without authentication. This

        module has been tested successfully on D-Link firmware DIR645A1_FW103B11. Other firmwares

        such as the DIR865LA1_FW101b06 and DIR845LA1_FW100b20 are also vulnerable.

      ",
  METHOD      => "POST",
  MSF_MODULE  => "dlink_authentication_cgi_bof",
  OSVDB       => 95951,
  PATH        => "authentication.cgi?",
  PATHS       => ["authentication.cgi", "authentication.cgi"],
  PAYLOAD     => "uid=__UID__&password=__PASSWORD__&",
  REFERENCES  => [
                   "http://securityadvisories.dlink.com/security/publication.aspx?name=SAP10008",
                   "http://www.dlink.com/us/en/home-solutions/connect/routers/dir-645-wireless-n-home-router-1000",
                   "http://roberto.greyhats.it/advisories/20130801-dlink-dir645.txt",
                 ],
  TITLE       => "D-Link authentication.cgi Buffer Overflow",
  VARIABLES => {
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'UID' =>       { DESCRIPTION => "", VALUE => "" },
  },
