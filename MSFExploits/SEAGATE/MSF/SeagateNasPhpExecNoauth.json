{
   "requests" : {
      "EXPLOIT7" : {
         "TEXT" : "Sending Exploit #7 Request : [GET] ",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "",
         "METHOD" : "GET"
      }
   },
   "paths" : [
      ""
   ],
   "name" : "SeagateNasPhpExecNoauth",
   "cve" : "CVE-2014-8687",
   "references" : [
      "http://www.seagate.com/au/en/support/external-hard-drives/network-storage/business-storage-2-bay-nas/",
      "https://beyondbinary.io/advisory/seagate-nas-rce/"
   ],
   "msf_module" : "seagate_nas_php_exec_noauth",
   "variables" : {
      "PATH" : {
         "DESCRIPTION" : "Path to the application root",
         "VALUE" : "/"
      },
      "COOKIEID" : {
         "DESCRIPTION" : "ID of the CodeIgniter session cookie",
         "VALUE" : "ci_session"
      },
      "XORKEY" : {
         "DESCRIPTION" : "XOR Key used for the CodeIgniter session",
         "VALUE" : "0f0a000d02011f0248000d290d0b0b0e03010e07"
      }
   },
   "title" : "Seagate Business NAS Unauthenticated Remote Command Execution",
   "method" : "GET",
   "platform" : "ALL",
   "description" : "\n\n        Some Seagate Business NAS devices are vulnerable to command execution via a local\n\n        file include vulnerability hidden in the language parameter of the CodeIgniter\n\n        session cookie. The vulnerability manifests in the way the language files are\n\n        included in the code on the login page, and hence is open to attack from users\n\n        without the need for authentication. The cookie can be easily decrypted using a\n\n        known static encryption key and re-encrypted once the PHP object string has been\n\n        modified.\n\n\n\n        This module has been tested on the STBN300 device.\n\n      ",
   "informations" : {
      "VARIABLES" : {
         "PATH" : {
            "DESCRIPTION" : "Path to the application root",
            "VALUE" : "/"
         },
         "XORKEY" : {
            "DESCRIPTION" : "XOR Key used for the CodeIgniter session",
            "VALUE" : "0f0a000d02011f0248000d290d0b0b0e03010e07"
         },
         "COOKIEID" : {
            "DESCRIPTION" : "ID of the CodeIgniter session cookie",
            "VALUE" : "ci_session"
         }
      },
      "TITLE OF THE NAS ADMIN ACCOUNT" : "admin",
      "MSF_MODULE" : "seagate_nas_php_exec_noauth",
      "CVE" : "CVE-2014-8687",
      "TITLE" : "Seagate Business NAS Unauthenticated Remote Command Execution",
      "DESCRIPTION" : "\n\n        Some Seagate Business NAS devices are vulnerable to command execution via a local\n\n        file include vulnerability hidden in the language parameter of the CodeIgniter\n\n        session cookie. The vulnerability manifests in the way the language files are\n\n        included in the code on the login page, and hence is open to attack from users\n\n        without the need for authentication. The cookie can be easily decrypted using a\n\n        known static encryption key and re-encrypted once the PHP object string has been\n\n        modified.\n\n\n\n        This module has been tested on the STBN300 device.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT7" : {
            "TEXT" : "Sending Exploit #7 Request : [GET] ",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "",
            "METHOD" : "GET"
         }
      },
      "name" : "SeagateNasPhpExecNoauth",
      "METHOD" : "GET",
      "PATHS" : [
         ""
      ],
      "REFERENCES" : [
         "http://www.seagate.com/au/en/support/external-hard-drives/network-storage/business-storage-2-bay-nas/",
         "https://beyondbinary.io/advisory/seagate-nas-rce/"
      ],
      "PLATFORM" : "ALL",
      "TYPE" : "MSF"
   },
   "detection" : {},
   "type" : "MSF",
   "title of the nas admin account" : "admin",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/"
}
