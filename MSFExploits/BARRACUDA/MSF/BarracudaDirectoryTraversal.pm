package BARRACUDA::MSF::BarracudaDirectoryTraversal;
use lib qw(../../); use parent qw(Exploit);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use File::Slurp qw(read_file);

# # 
# # 
# # 

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   

   my $name = "BarracudaDirectoryTraversal";

   my $DETECTION = {

   };

my $EXPLOIT = {
  DESCRIPTION => "

          This module exploits a directory traversal vulnerability present in

        several Barracuda products, including the Barracuda Spam and Virus Firewall,

        Barracuda SSL VPN, and the Barracuda Web Application Firewall. By default,

        this module will attempt to download the Barracuda configuration file.

      ",
  MSF_MODULE => "barracuda_directory_traversal",
  OSVDB => 68301,
  PATHS => ["cgi-mod/view_help.cgi"],
  REFERENCES => ["http://secunia.com/advisories/41609/"],
  TITLE => "Barracuda Multiple Product \"locale\" Directory Traversal",
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "Barracuda vulnerable URI path",
  VALUE => "/cgi-mod/view_help.cgi",
},
  },

  TYPE => 'MSF',
  PLATFORM => 'SCANNER',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'GET',
      PATH   => '',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #1 Request : [GET] ',
      HEADERS      => {
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($name, $DETECTION, $EXPLOIT, @_);
}

return 1;
