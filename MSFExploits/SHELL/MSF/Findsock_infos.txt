my $EXPLOIT = {
  DESCRIPTION => "

        Spawn a shell on the established connection to

        the webserver.  Unfortunately, this payload

        can leave conspicuous evil-looking entries in the

        apache error logs, so it is probably a good idea

        to use a bind or reverse shell unless firewalls

        prevent them from working.  The issue this

        payload takes advantage of (CLOEXEC flag not set

        on sockets) appears to have been patched on the

        Ubuntu version of Apache and may not work on

        other Debian-based distributions.  Only tested on

        Apache but it might work on other web servers

        that leak file descriptors to child processes.

        ",
  MSF_MODULE => "shell_findsock",
  TITLE => "PHP Command Shell, Find Sock",

