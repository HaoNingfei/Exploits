my $EXPLOIT = {
  CVE => "CVE-2017-6326",
  DESCRIPTION => "

        This module exploits the command injection vulnerability of Symantec Messaging Gateway product. An authenticated user can execute a

        terminal command under the context of the web server user which is root.



        backupNow.do endpoint takes several user inputs and then pass them to the internal service which is responsible for executing

        operating system command. One of the user input is being passed to the service without proper validation. That cause a command

        injection vulnerability. But given parameters, such a SSH ip address, port and credentials are validated before executing terminal

        command. Thus, you need to configure your own SSH service and set the required parameter during module usage.



        This module was tested against Symantec Messaging Gateway 10.6.2-7.

      ",
  METHOD => "GET",
  MSF_MODULE => "symantec_messaging_gateway_exec",
  PATH => "",
  PATHS => [
    "brightmail/login.do",
    "brightmail/admin/backup/backupNow.do",
    "",
  ],
  PAYLOAD => "?",
  REFERENCES => [
    "https://pentest.blog/unexpected-journey-5-from-weak-password-to-rce-on-symantec-messaging-gateway/",
  ],
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "The base path to Symantec Messaging Gateway",
  VALUE => "/",
},
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'SID' =>       { DESCRIPTION => "", VALUE => "" },
    'PEER' =>       { DESCRIPTION => "", VALUE => "" },
    'COOKIE' =>       { DESCRIPTION => "", VALUE => "" },
    'LASTLOGIN' =>       { DESCRIPTION => "", VALUE => "" },
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
  },
