{
   "name" : "SonicwallScrutinizerMethoddetailSqli",
   "cve" : "CVE-2014-4977",
   "references" : [
      "http://seclists.org/fulldisclosure/2014/Jul/44",
      "https://gist.github.com/brandonprry/76741d9a0d4f518fe297"
   ],
   "msf_module" : "sonicwall_scrutinizer_methoddetail_sqli",
   "the usertitle to authenticate as" : "admin",
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "HEADERS" : {
            "Cookie" : "cookiesenabled=1;sessionid=;userid=",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "",
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "METHOD" : "GET",
         "PATH" : ""
      }
   },
   "paths" : [
      "cgi-bin/login.cgi",
      "d4d/exporters.php"
   ],
   "method" : "POST",
   "platform" : "MULTI",
   "description" : "\n\n        This module exploits a vulnerability found in Dell SonicWALL Scrutinizer. The methodDetail\n\n        parameter in exporters.php allows an attacker to write arbitrary files to the file system\n\n        with an SQL Injection attack, and gain remote code execution under the context of SYSTEM\n\n        for Windows, or as Apache for Linux.\n\n\n\n        Authentication is required to exploit this vulnerability, but this module uses\n\n        the default admin:admin credential.\n\n      ",
   "payload" : "?",
   "variables" : {
      "UID" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PASSWORD" : {
         "VALUE" : "admin",
         "DESCRIPTION" : "The password to authenticate with"
      },
      "USERNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PWD" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "NAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "BACKDOOR_FNAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "SID" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "METHODDETAIL" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "detection" : {},
   "informations" : {
      "PATH" : "methodDetail=__METHODDETAIL__&",
      "METHOD" : "POST",
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "REFERENCES" : [
         "http://seclists.org/fulldisclosure/2014/Jul/44",
         "https://gist.github.com/brandonprry/76741d9a0d4f518fe297"
      ],
      "PATHS" : [
         "cgi-bin/login.cgi",
         "d4d/exporters.php"
      ],
      "MSF_MODULE" : "sonicwall_scrutinizer_methoddetail_sqli",
      "VARIABLES" : {
         "USERNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PASSWORD" : {
            "VALUE" : "admin",
            "DESCRIPTION" : "The password to authenticate with"
         },
         "UID" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "SID" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "METHODDETAIL" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "BACKDOOR_FNAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "NAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PWD" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "THE USERTITLE TO AUTHENTICATE AS" : "admin",
      "name" : "SonicwallScrutinizerMethoddetailSqli",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "HEADERS" : {
               "Cookie" : "cookiesenabled=1;sessionid=;userid=",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "",
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "METHOD" : "GET",
            "PATH" : ""
         }
      },
      "PAYLOAD" : "?",
      "DESCRIPTION" : "\n\n        This module exploits a vulnerability found in Dell SonicWALL Scrutinizer. The methodDetail\n\n        parameter in exporters.php allows an attacker to write arbitrary files to the file system\n\n        with an SQL Injection attack, and gain remote code execution under the context of SYSTEM\n\n        for Windows, or as Apache for Linux.\n\n\n\n        Authentication is required to exploit this vulnerability, but this module uses\n\n        the default admin:admin credential.\n\n      ",
      "CVE" : "CVE-2014-4977"
   },
   "type" : "MSF",
   "path" : "methodDetail=__METHODDETAIL__&",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/"
}
