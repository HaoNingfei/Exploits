package HTTP::MSF::HttpPut;
use lib qw(../../); use parent qw(Exploit);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use File::Slurp qw(read_file);

# # 
# # 
# # 

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   

   my $name = "HttpPut";

   my $DETECTION = {

   };

my $EXPLOIT = {
  DESCRIPTION => "

        This module can abuse misconfigured web servers to upload and delete web content

        via PUT and DELETE HTTP requests. Set ACTION to either PUT or DELETE.



        PUT is the default.  If filename isn't specified, the module will generate a

        random string for you as a .txt file. If DELETE is used, a filename is required.

      ",
  MSF_MODULE => "http_put",
  OSVDB => 397,
  TITLE => "HTTP Writable Path PUT/DELETE File Access",


  TYPE => 'MSF',
  PLATFORM => 'SCANNER',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'PUT',
      PATH   => '__FILENAME__WDXyl.txt',
      PAYLOAD      => 'msf test file',
      TEXT   => 'Sending Exploit #1 Request : [PUT] /__FILENAME__WDXyl.txt',
      HEADERS      => {
        'Content-Type' => 'text/plain',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($name, $DETECTION, $EXPLOIT, @_);
}

return 1;
