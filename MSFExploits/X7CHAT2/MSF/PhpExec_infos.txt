my $EXPLOIT = {
  DESCRIPTION => "

        This module exploits a post-auth vulnerability found in X7 Chat versions

        2.0.0 up to 2.0.5.1. The vulnerable code exists on lib/message.php, which

        uses preg_replace() function with the /e modifier. This allows a remote

        authenticated attacker to execute arbitrary PHP code in the remote machine.

      ",
  METHOD      => "GET",
  MSF_MODULE  => "x7chat2_php_exec",
  PATH        => "act=__ACT__&cp_page=msgcenter&delete=__DELETE__&=____&",
  PATHS       => ["index.php", "index.php", "index.php", "index.php", "x7chat2"],
  PAYLOAD     => "?",
  REFERENCES  => ["https://github.com/rapid7/metasploit-framework/pull/4076"],
  TITLE       => "X7 Chat 2.0.5 lib/message.php preg_replace() PHP Code Execution",
  VARIABLES => {
    ' RAND_TEXT ' =>       { DESCRIPTION => "", VALUE => "" },
    'SUBJECT' =>       { DESCRIPTION => "", VALUE => "" },
    'READ' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       { DESCRIPTION => "Base x7 Chat directory path", VALUE => "/x7chat2" },
    '' =>       { DESCRIPTION => "", VALUE => "" },
    'DELETE' =>       { DESCRIPTION => "", VALUE => "" },
    'PASSWORD' =>       { DESCRIPTION => "Pasword to authenticate as", VALUE => "" },
    'ACT' =>       { DESCRIPTION => "", VALUE => "" },
    ' COOKIE_X7C2U ' =>       { DESCRIPTION => "", VALUE => "" },
    ' COOKIE_X7C2P ' =>       { DESCRIPTION => "", VALUE => "" },
    'TO' =>       { DESCRIPTION => "", VALUE => "" },
  },
