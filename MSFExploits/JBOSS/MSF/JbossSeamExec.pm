package JBOSS::MSF::JbossSeamExec;
use lib qw(../../); use parent qw(Exploit);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use File::Slurp qw(read_file);

# # 
# # 
# # 

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   

   my $name = "JbossSeamExec";

   my $DETECTION = {

   };

my $EXPLOIT = {
  CVE => "CVE-2010-1871",
  DESCRIPTION => "

          JBoss Seam 2 (jboss-seam2), as used in JBoss Enterprise Application Platform

        4.3.0 for Red Hat Linux, does not properly sanitize inputs for JBoss Expression

        Language (EL) expressions, which allows remote attackers to execute arbitrary code

        via a crafted URL. This modules also has been tested successfully against IBM

        WebSphere 6.1 running on iSeries.



        NOTE: this is only a vulnerability when the Java Security Manager is not properly

        configured.

      ",
  MSF_MODULE => "jboss_seam_exec",
  OSVDB => 66881,
  PATHS => ["seam-booking/home.seam"],
  TITLE => "JBoss Seam 2 Remote Command Execution",
  VARIABLES => {
    'PATH' =>       { DESCRIPTION => "Target URI", VALUE => "/seam-booking/home.seam" },
  },

  TYPE => 'MSF',
  PLATFORM => 'ALL',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'GET',
      PATH   => '',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #1 Request : [GET] ',
      HEADERS      => {
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($name, $DETECTION, $EXPLOIT, @_);
}

return 1;
