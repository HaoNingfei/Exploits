my $EXPLOIT = {
  CVE => "CVE-2015-6922",
  DESCRIPTION => "

        This module exploits an arbitrary file upload vulnerability found in Kaseya VSA versions

        between 7 and 9.1. A malicious unauthenticated user can upload an ASP file to an arbitrary

        directory leading to arbitrary code execution with IUSR privileges. This module has been

        tested with Kaseya v7.0.0.17, v8.0.0.10 and v9.0.0.3.

      ",
  METHOD => "GET",
  MSF_MODULE => "kaseya_uploader",
  PATH => "PathData=__PATHDATA__&qqfile=__QQFILE__&",
  REFERENCES => [
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/kaseya-vsa-vuln-2.txt",
    "http://seclists.org/bugtraq/2015/Sep/132",
  ],
  TITLE => "Kaseya VSA uploader.aspx Arbitrary File Upload",
  VARIABLES => {
    'QQFILE' =>       { DESCRIPTION => "", VALUE => "" },
    'PATHDATA' =>       { DESCRIPTION => "", VALUE => "" },
  },
      },  VALIDATION => {
    'TREGEX' =>       (
  "mainLogon\\.asp\\?logout=\\([0-9]*\\)",
  "mainLogon\\.asp\\?logout=\\([0-9]*\\)",
),
    'TCODE' =>       (302, 302),
