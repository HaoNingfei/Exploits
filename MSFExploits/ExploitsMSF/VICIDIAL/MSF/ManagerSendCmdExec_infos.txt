my $EXPLOIT = {
  "CVE"                => "CVE-2013-4468",
  "DESCRIPTION"        => "

          The file agc/manager_send.php in the VICIdial web application uses

        unsanitized user input as part of a command that is executed using the PHP

        passthru() function. A valid username, password and session are needed to access

        the injection point. Fortunately, VICIdial has two built-in accounts with default

        passwords and the manager_send.php file has a SQL injection vulnerability that can

        be used to bypass the session check as long as at least one session has been

        created at some point in time. In case there isn't any valid session, the user can

        provide astGUIcient credentials in order to create one. The results of the injected

        commands are returned as part of the response from the web server. Affected versions

        include 2.7RC1, 2.7, and 2.8-403a. Other versions are likely affected as well. The

        default credentials used by Vicidial are VDCL/donotedit and VDAD/donotedit.

      ",
  "METHOD"             => "POST",
  "MSF_MODULE"         => "vicidial_manager_send_cmd_exec",
  "OSVDB"              => 98902,
  "PATH"               => "agc/astguiclient.php?",
  "PATHS"              => ["agc/astguiclient.php"],
  "PAYLOAD"            => "user=__USER__&pass=__PASS__&phone_login=__PHONE_LOGIN__&phone_pass=__PHONE_PASS__&",
  "REFERENCES"         => [
                            "http://www.openwall.com/lists/oss-security/2013/10/23/10",
                            "http://adamcaudill.com/2013/10/23/vicidial-multiple-vulnerabilities/",
                          ],
  "TITLE"              => "VICIdial Manager Send OS Command Injection",
  "VICIDIAL USERTITLE" => "VDCL",
  VARIABLES => {
    'PHONE_PASS' =>       { DESCRIPTION => "", VALUE => "" },
    'PASS_ASTGUI' =>       { DESCRIPTION => "astGUIcient User Password", VALUE => 1234 },
    'PASSWORD' =>       { DESCRIPTION => "VICIdial Password", VALUE => "donotedit" },
    'USER' =>       { DESCRIPTION => "", VALUE => "" },
    'PHONE_USER_ASTGUI' =>       { DESCRIPTION => "astGUIcient Phone Login", VALUE => 6666 },
    'PASS' =>       { DESCRIPTION => "", VALUE => "" },
    'PHONE_LOGIN' =>       { DESCRIPTION => "", VALUE => "" },
    'PHONE_PASSWORD_ASTGUI' =>       { DESCRIPTION => "astGUIcient Phone Password", VALUE => 1234 },
    'USER_ASTGUI' =>       { DESCRIPTION => "astGUIcient User Login", VALUE => 6666 },
  },
