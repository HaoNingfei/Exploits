my $EXPLOIT = {
  "#{USERTITLE}" => "#{pwd_hash",
  "DESCRIPTION"  => "

        This module exploits two separate vulnerabilities found in the Watchguard XCS virtual

        appliance to gain command execution. By exploiting an unauthenticated SQL injection, a

        remote attacker may insert a valid web user into the appliance database, and get access

        to the web interface. On the other hand, a vulnerability in the web interface allows the

        attacker to inject operating system commands as the 'nobody' user.

      ",
  "METHOD"       => "GET",
  "MSF_MODULE"   => "watchguard_cmd_exec",
  "PATH"         => "",
  "PATHS"        => [
                      "borderpost/imp/compose.php3",
                      "borderpost/imp/compose.php3",
                      "",
                    ],
  "PAYLOAD"      => "?",
  "REFERENCES"   => [
                      "http://security-assessment.com/files/documents/advisory/Watchguard-XCS-final.pdf",
                    ],
  "TITLE"        => "Watchguard XCS Remote Command Execution",
  VARIABLES => {
    'WATCHGUARD_USER' =>       {
  DESCRIPTION => "Web interface user account to add",
  VALUE => "backdoor",
},
    'WATCHGUARD_PASSWORD' =>       { DESCRIPTION => "Web interface user password", VALUE => "backdoor" },
    'USER_ID' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'PATH' =>       { DESCRIPTION => "The target URI", VALUE => "/" },
    'PWD_HASH' =>       { DESCRIPTION => "", VALUE => "" },
  },
