my $EXPLOIT = {
  "DESCRIPTION" => "

        TrueOnline is a major ISP in Thailand, and it distributes a customized version of

        the ZyXEL P660HN-T v2 router. This customized version has an authenticated command injection

        vulnerability in the remote log forwarding page. This can be exploited using the \"supervisor\"

        account that comes with a default password on the device.

        This module was tested in an emulated environment, as the author doesn't have access to the

        Thai router any more. Any feedback should be sent directly to the module's author, as well as

        to the Metasploit project. Note that the inline payloads work best.

        There are Turkish and other language strings in the firmware, so it is likely that this

        firmware is not only distributed in Thailand. Other P660HN-T v2 in other countries might be

        vulnerable too.

      ",
  "METHOD" => "POST",
  "MSF_MODULE" => "trueonline_p660hn_v2_rce",
  "PATH" => "cgi-bin/pages/maintenance/logSetting/logSet.asp?",
  "PATHS" => [
    "cgi-bin/pages/maintenance/logSetting/logSet.asp",
    "cgi-bin/index.asp",
  ],
  "PAYLOAD" => "Loginuser=supervisor&Prestige_Login=Login&",
  "REFERENCES" => [
    "http://seclists.org/fulldisclosure/2017/Jan/40",
    "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/zyxel_trueonline.txt",
    "https://blogs.securiteam.com/index.php/archives/2910",
  ],
  "TITLE" => "TrueOnline / ZyXEL P660HN-T v2 Router Authenticated Command Injection",
  "USERTITLE FOR THE WEB INTERFACE (USING DEFAULT CREDENTIALS)" => "supervisor",
  VARIABLES => {
    'SERVERPORT' =>       { DESCRIPTION => "", VALUE => "" },
    'PASSWORD' =>       {
  DESCRIPTION => "Password for the web interface (using default credentials)",
  VALUE => "zyad1234",
},
    'CMD' =>       { DESCRIPTION => "", VALUE => "" },
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
  },
