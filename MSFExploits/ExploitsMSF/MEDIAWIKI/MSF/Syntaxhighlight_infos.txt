my $EXPLOIT = {
  CVE => "CVE-2017-0372",
  DESCRIPTION => "

        This module exploits an option injection vulnerability in the SyntaxHighlight

        extension of MediaWiki. It tries to create & execute a PHP file in the document root.

        The USERNAME & PASSWORD options are only needed if the Wiki is configured as private.



        This vulnerability affects any MediaWiki installation with SyntaxHighlight version 2.0

        installed & enabled. This extension ships with the AIO package of MediaWiki version

        1.27.x & 1.28.x. A fix for this issue is included in MediaWiki version 1.28.2 and

        version 1.27.3.

      ",
  METHOD => "POST",
  MSF_MODULE => "mediawiki_syntaxhighlight",
  PATH => "api.php?",
  PATHS => ["api.php", "api.php", "api.php", "api.php"],
  PAYLOAD => "action=parse&format=json&contentmodel=wikitext&text=<syntaxhighlightlang=javastart=0&",
  REFERENCES => [
    "https://lists.wikimedia.org/pipermail/mediawiki-announce/2017-April/000207.html",
    "https://phabricator.wikimedia.org/T158689",
    "https://securify.nl/advisory/SFY20170201/syntaxhighlight_mediawiki_extension_allows_injection_of_arbitrary_pygments_options.html",
  ],
  TITLE => "MediaWiki SyntaxHighlight extension option injection vulnerability",
  VARIABLES => {
    'USERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'CSSFILE' =>       { DESCRIPTION => "", VALUE => "" },
    'LGTOKEN' =>       { DESCRIPTION => "", VALUE => "" },
    'LGNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'LGPASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'PASSWORD' =>       { DESCRIPTION => "", VALUE => "" },
    'CLEANUP' =>       { DESCRIPTION => "", VALUE => "" },
  },
