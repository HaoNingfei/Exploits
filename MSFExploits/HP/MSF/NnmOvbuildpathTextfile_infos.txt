my $EXPLOIT = {
  CVE => "CVE-2011-3167",
  DESCRIPTION => "

          This module exploits a stack buffer overflow in HP OpenView Network Node

        Manager 7.53 prior to NNM_01213 without the SSRT100649 hotfix. By specifying a long

        'textFile' argument when calling the 'webappmon.exe' CGI program, an attacker can

        cause a stack-based buffer overflow and execute arbitrary code.



        The vulnerable code is within the \"_OVBuildPath\" function within \"ov.dll\". There

        are no stack cookies, so exploitation is achieved by overwriting the saved return

        address.



        The vulnerability is due to the use of the function \"_OVConcatPath\" which finally

        uses \"strcat\" in an insecure way. User controlled data is concatenated to a string

        which contains the OpenView installation path.



        To achieve reliable exploitation a directory traversal in OpenView5.exe

        (OSVDB 44359) is being used to retrieve OpenView logs and disclose the installation

        path. If the installation path cannot be guessed the default installation path

        is used.

      ",
  METHOD => "GET",
  MSF_MODULE => "hp_nnm_ovbuildpath_textfile",
  OSVDB => 76775,
  PATH => "Target=Main&Scope=Snmp&Action=__ACTION__&",
  REFERENCES => [
    "https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03054052",
  ],
  TITLE => "HP OpenView Network Node Manager ov.dll _OVBuildPath Buffer Overflow",
  VARIABLES => {
    'ACTION' =>       { DESCRIPTION => "", VALUE => "" },
  },
