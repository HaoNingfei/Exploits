my $EXPLOIT = {
  CVE => "CVE-2003-1200",
  DESCRIPTION => "\n\n      This module exploits a stack buffer overflow in Alt-N MDaemon SMTP server for\n\n      versions 6.8.5 and earlier. When WorldClient HTTP server is installed (default),\n\n      a CGI script is provided to accept html FORM based emails and deliver via MDaemon.exe,\n\n      by writing the CGI output to the Raw Queue. When X-FromCheck is enabled (also default),\n\n      the temporary form2raw.cgi data is copied by MDaemon.exe and a stack based\n\n      overflow occurs when an excessively long From field is specified.\n\n      The RawQueue is processed every 1 minute by default, to a maximum of 60 minutes.\n\n      Keep this in mind when choosing payloads or setting WfsDelay... You'll need to wait.\n\n\n\n      Furthermore, this exploit uses a direct memory jump into a nopsled (which isn't very\n\n      reliable). Once the payload is written into the Raw Queue by Form2Raw, MDaemon will\n\n      continue to crash/execute the payload until the CGI output is manually deleted\n\n      from the queue in C:\\MDaemon\\RawFiles\\*.raw.\n\n      ",
  MSF_MODULE => "mdaemon_worldclient_form2raw",
  OSVDB => 3255,
  TITLE => "MDaemon WorldClient form2raw.cgi Stack Buffer Overflow",
