my $EXPLOIT = {
  DESCRIPTION => "\n\n          This module can be used to execute a payload on Umbraco CMS 4.7.0.378.\n\n        The payload is uploaded as an ASPX script by sending a specially crafted\n\n        SOAP request to codeEditorSave.asmx, which permits unauthorized file upload\n\n        via the SaveDLRScript operation. SaveDLRScript is also subject to a path\n\n        traversal vulnerability, allowing code to be placed into the web-accessible\n\n        /umbraco/ directory.\n\n\n\n        The module writes, executes and then overwrites an ASPX script; note that\n\n        though the script content is removed, the file remains on the target. Automatic\n\n        cleanup of the file is intended if a meterpreter payload is used.\n\n\n\n        This module has been tested successfully on Umbraco CMS 4.7.0.378 on a Windows\n\n        7 32-bit SP1. In this scenario, the \"IIS APPPOOL\\ASP.NET v4.0\" user must have\n\n        write permissions on the Windows Temp folder.\n\n      ",
  MSF_MODULE => "umbraco_upload_aspx",
  OSVDB => 83765,
  PATHS => ["umbraco/"],
  REFERENCES => [
    "http://blog.gdssecurity.com/labs/2012/7/3/find-bugs-faster-with-a-webmatrix-local-reference-instance.html",
    "http://umbraco.codeplex.com/workitem/18192",
  ],
  TITLE => "Umbraco CMS Remote Command Execution",
}
VARIABLES = {
	PATH = {
  DESCRIPTION => "The URI path of the Umbraco login page",
  VALUE => "/umbraco/",
},
